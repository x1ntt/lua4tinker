<html imt-state="dual"><head><meta charset="UTF-8">
<title>Lua: reference manual 4.0</title>
<style data-id="immersive-translate-default-injected-css">:root {
  --immersive-translate-theme-underline-borderColor: #72ece9;
  --immersive-translate-theme-nativeUnderline-borderColor: #72ece9;
  --immersive-translate-theme-nativeDashed-borderColor: #72ece9;
  --immersive-translate-theme-nativeDotted-borderColor: #72ece9;
  --immersive-translate-theme-highlight-backgroundColor: #ffff00;
  --immersive-translate-theme-dashed-borderColor: #59c1bd;
  --immersive-translate-theme-blockquote-borderColor: #cc3355;
  --immersive-translate-theme-thinDashed-borderColor: #ff374f;
  --immersive-translate-theme-dashedBorder-borderColor: #94a3b8;
  --immersive-translate-theme-dashedBorder-borderRadius: 0;
  --immersive-translate-theme-solidBorder-borderColor: #94a3b8;
  --immersive-translate-theme-solidBorder-borderRadius: 0;
  --immersive-translate-theme-dotted-borderColor: #94a3b8;
  --immersive-translate-theme-wavy-borderColor: #72ece9;
  --immersive-translate-theme-dividingLine-borderColor: #94a3b8;
  --immersive-translate-theme-grey-textColor: #2f4f4f;
  --immersive-translate-theme-marker-backgroundColor: #fbda41;
  --immersive-translate-theme-marker-backgroundColor-rgb: 251, 218, 65;
  --immersive-translate-theme-marker2-backgroundColor: #ffff00;
  --immersive-translate-theme-opacity-opacity: 10;
}

[imt-state="dual"] .immersive-translate-target-translation-pre-whitespace {
  white-space: pre-wrap !important;
}

[imt-state="dual"] .immersive-translate-pdf-target-container {
  position: absolute;
  background-color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
    sans-serif;
  top: 0;
  width: 600px;
  height: 100%;
  z-index: 2;
  line-height: 1.3;
  font-size: 16px;
}
[imt-state="dual"] .immersive-translate-target-wrapper[dir="rtl"] {
  text-align: right;
}

[imt-state="dual"]
  .immersive-translate-pdf-target-container
  .immersive-translate-target-wrapper {
  color: rgb(0, 0, 0);
  white-space: normal;
  position: absolute;
}

[imt-state="dual"]
  .immersive-translate-pdf-target-container
  .immersive-translate-target-wrapper
  font {
  color: inherit;
  white-space: inherit;
  position: unset;
}

[imt-state="translation"] .immersive-translate-target-wrapper > br {
  display: none;
}

[imt-state="translation"]
  .immersive-translate-target-translation-block-wrapper {
  margin: 0 !important;
}

[imt-state="dual"] .immersive-translate-target-translation-block-wrapper {
  margin: 8px 0 !important;
  display: inline-block;
}

[imt-trans-position="before"]
  .immersive-translate-target-translation-block-wrapper {
  display: block;
}

[imt-trans-position="before"]
  .immersive-translate-target-translation-block-wrapper {
  margin-top: 0 !important;
}

[imt-state="dual"] .immersive-translate-target-translation-pdf-block-wrapper {
  margin: 0 !important;
  display: block;
}

[imt-state="dual"] .immersive-translate-target-translation-theme-grey-inner {
  color: var(--immersive-translate-theme-grey-textColor);
}

[imt-state="dual"]
  .immersive-translate-target-translation-theme-underline-inner {
  border-bottom: 1px solid
    var(--immersive-translate-theme-underline-borderColor) !important;
}

[imt-state="dual"]
  .immersive-translate-target-translation-theme-nativeUnderline-inner {
  text-decoration: underline !important;
  text-decoration-color: var(
    --immersive-translate-theme-nativeUnderline-borderColor
  ) !important;
}

[imt-state="dual"]
  .immersive-translate-target-translation-block-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(
    --immersive-translate-theme-dashedBorder-borderRadius
  ) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

[imt-state="dual"]
  .immersive-translate-target-translation-inline-wrapper-theme-dashedBorder {
  border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
  border-radius: var(
    --immersive-translate-theme-dashedBorder-borderRadius
  ) !important;
  padding: 2px;
}

[imt-state="dual"]
  .immersive-translate-target-translation-block-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(
    --immersive-translate-theme-solidBorder-borderRadius
  ) !important;
  padding: 6px;
  margin-top: 2px;
  display: block;
}

[imt-state="dual"]
  .immersive-translate-target-translation-inline-wrapper-theme-solidBorder {
  border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
  border-radius: var(
    --immersive-translate-theme-solidBorder-borderRadius
  ) !important;
  padding: 2px;
}

[imt-state="dual"]
  .immersive-translate-target-translation-theme-nativeDashed-inner {
  text-decoration: underline !important;
  text-decoration-color: var(
    --immersive-translate-theme-nativeDashed-borderColor
  ) !important;
  text-decoration-style: dashed !important;
}

[imt-state="dual"]
  .immersive-translate-target-translation-theme-thinDashed-inner {
  border-bottom: 1px dashed
    var(--immersive-translate-theme-thinDashed-borderColor) !important;
}

[imt-state="dual"] .immersive-translate-target-translation-theme-dotted-inner {
  background-image: linear-gradient(
    to right,
    var(--immersive-translate-theme-dotted-borderColor) 30%,
    rgba(255, 255, 255, 0) 0%
  );
  background-position: bottom;
  background-size: 5px 1px;
  background-repeat: repeat-x;
  padding-bottom: 3px;
}

[imt-state="dual"]
  .immersive-translate-target-translation-theme-nativeDotted-inner {
  text-decoration: underline !important;
  text-decoration-color: var(
    --immersive-translate-theme-nativeDotted-borderColor
  ) !important;
  text-decoration-style: dotted !important;
}

[imt-state="dual"] .immersive-translate-target-translation-theme-wavy-inner {
  text-decoration: underline !important;
  text-decoration-color: var(
    --immersive-translate-theme-wavy-borderColor
  ) !important;
  text-decoration-style: wavy !important;
}

[imt-state="dual"] .immersive-translate-target-translation-theme-dashed-inner {
  background: linear-gradient(
      to right,
      var(--immersive-translate-theme-dashed-borderColor) 0%,
      var(--immersive-translate-theme-dashed-borderColor) 50%,
      transparent 50%,
      transparent 100%
    )
    repeat-x left bottom;
  background-size: 8px 2px;
  padding-bottom: 2px;
}

[imt-state="dual"]
  .immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
  content: "";
  display: block;
  max-width: 80px;
  width: 10%;
  border-top: 1px dashed
    var(--immersive-translate-theme-dividingLine-borderColor);
  padding-top: 8px;
}

[imt-state="dual"]
  .immersive-translate-target-translation-inline-wrapper-theme-dividingLine::before {
  content: "";
  border-left: 1px dashed
    var(--immersive-translate-theme-dividingLine-borderColor);
  max-height: 16px;
  height: 16px;
  padding-left: 8px;
}

[imt-state="dual"]
  .immersive-translate-target-translation-theme-highlight-inner {
  background: var(--immersive-translate-theme-highlight-backgroundColor);
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

[imt-state="dual"]
  .immersive-translate-target-translation-block-wrapper-theme-marker {
  line-height: 1.5em;
}

[imt-state="dual"] .immersive-translate-target-translation-theme-marker2-inner {
  font-weight: bold;
  text-shadow: 10px 0px 3px
      var(--immersive-translate-theme-marker2-backgroundColor),
    16px 3px 9px var(--immersive-translate-theme-marker2-backgroundColor),
    2px 0px 6px var(--immersive-translate-theme-marker2-backgroundColor),
    -12px 0px 12px var(--immersive-translate-theme-marker2-backgroundColor) !important;
}

[imt-state="dual"] .immersive-translate-target-translation-theme-marker-inner {
  /* TODO: add more texture */
  background: linear-gradient(
    to right,
    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.1),
    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 3%,
    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 35%,
    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 70%,
    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.8) 95%,
    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.3)
  );
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

[imt-state="dual"] .immersive-translate-target-translation-theme-weakening {
  opacity: 0.618 !important;
}

[imt-state="dual"] .immersive-translate-target-translation-theme-italic {
  font-style: italic !important;
}

[imt-state="dual"] .immersive-translate-target-translation-theme-bold {
  font-weight: bold !important;
}

[imt-state="dual"]
  .immersive-translate-target-translation-block-wrapper-theme-paper {
  margin: 8px 0;
  box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
  padding: 16px 32px;
  display: block;
}

[imt-state="dual"]
  .immersive-translate-target-translation-block-wrapper-theme-blockquote {
  border-left: 4px solid var(--immersive-translate-theme-blockquote-borderColor) !important;
  padding-left: 12px !important;
  margin-top: 4px;
  margin-bottom: 4px;
  padding-top: 4px;
  padding-bottom: 4px;
  display: block;
}

[imt-state="dual"] .immersive-translate-target-translation-theme-mask-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"]
  .immersive-translate-target-translation-theme-mask-inner {
  filter: none !important;
}

[data-immersive-translate-root-translation-theme="mask"]
  .immersive-translate-target-inner {
  filter: blur(5px) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

/* opacity theme start */

[imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner {
  filter: opacity(
    calc(var(--immersive-translate-theme-opacity-opacity) * 1%)
  ) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[data-immersive-translate-root-translation-theme="none"]
  .immersive-translate-target-translation-theme-opacity-inner {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"]
  .immersive-translate-target-inner,
[imt-state="dual"]
  .immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: opacity(
    calc(var(--immersive-translate-theme-opacity-opacity) * 1%)
  ) !important;
  transition: filter 0.3s ease !important;
  border-radius: 10px;
  display: inline-block;
}

[imt-state="dual"]
  .immersive-translate-target-translation-theme-opacity-inner:hover {
  filter: none !important;
}

[imt-state="dual"]
  .immersive-translate-target-translation-theme-mask-inner:hover {
  filter: none !important;
}
[data-immersive-translate-root-translation-theme="opacity"]
  .immersive-translate-target-inner:hover {
  filter: none !important;
}

[data-immersive-translate-root-translation-theme="mask"]
  .immersive-translate-target-inner:hover {
  filter: none !important;
}

/* opacity theme end */

/* vertical css , please remain it in the last one. */
.immersive-translate-target-translation-vertical-block-wrapper {
  margin: 0px 8px !important;
}

.immersive-translate-text {
  font-size: 15px !important;
}

.immersive-translate-error-toast {
  position: fixed;
  top: 5%;
  z-index: 99999999;
  left: 0;
  right: 0;
  margin: auto;
  max-width: 300px;
  padding: 16px;
  border-radius: 12px;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}

@media all and (min-width: 750px) {
  .immersive-translate-error-toast {
    max-width: 400px;
  }
}

.immersive-translate-clickable-button {
  cursor: pointer;
}

.immersive-translate-help-button {
  cursor: pointer;
}

.immersive-translate-loading-text:before {
  content: "...";
}

/* dark mode for loading */

@media only screen and (prefers-color-scheme: dark) {
  .immersive-translate-loading {
    border: 2px rgba(255, 255, 255, 0.25) solid !important;
    border-top: 2px rgba(255, 255, 255, 1) solid !important;
  }
}

.immersive-translate-error-wrapper {
  position: relative;
  display: inline-flex;
  padding: 6px;
  margin: 0 12px;
  white-space: nowrap;
  font-size: 0.9em;
}
[lang="zh-CN"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}
[lang="zh-TW"] .immersive-translate-error-wrapper {
  font-size: 0.75em;
}

.immersive-translate-tooltip {
  position: relative;
  display: inline-flex;
  /* little indicater to indicate it's hoverable */
}

.immersive-translate-tooltip-content {
  /* here's the magic */
  position: absolute;
  z-index: 100000000000;

  left: 50%;
  bottom: 0;
  transform: translate(-50%, 110%);
  line-height: 1;
  /* and add a small left margin */

  /* basic styles */
  width: max-content;
  max-width: 250px;
  word-wrap: break-word;
  white-space: pre-line;
  padding: 10px;
  border-radius: 10px;
  background: #000c;
  color: #fff;
  text-align: center;
  font-size: 14px;
  display: none;
  /* hide by default */
}

.immersive-translate-tooltip:hover .immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip:hover + .immersive-translate-tooltip-content {
  display: block;
}

.immersive-translate-tooltip-content-table {
  left: unset !important;
  bottom: unset !important;
  transform: translate(-10%, 50%) !important;
}

.immersive-translate-tooltip:hover:before {
  display: block;
}

.immersive-translate-loading-spinner {
  vertical-align: middle !important;
  width: 10px !important;
  height: 10px !important;
  display: inline-block !important;
  margin: 0 4px !important;
  border: 2px rgba(221, 244, 255, 0.6) solid !important;
  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-radius: 50% !important;
  padding: 0 !important;
  -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
  animation: immersive-translate-loading-animation 0.6s infinite linear !important;
}

@-webkit-keyframes immersive-translate-loading-animation {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(359deg);
  }
}

@keyframes immersive-translate-loading-animation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}
</style><style data-id="immersive-translate-user-custom-style">:root {

.immersive-translate-target-inner { font-family: inherit; }
}
</style><style data-id="immersive-translate-dynamic-injected-css">.immersive-translate-target-wrapper[dir='rtl'] {text-align: right;}
.immersive-translate-target-wrapper[dir='rtl'] [data-immersive-translate-class-bak*='block-wrapper'] {display:block;}
.immersive-translate-target-wrapper {word-break: break-word;}
[imt-state="translation"] .immersive-translate-target-wrapper[dir='rtl'] {display:inline-block;}
</style></head><body data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">

<hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<h1 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<img src="logo.gif" alt="Lua" align="bottom" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
Reference Manual of the Programming Language
<a href="http://www.tecgraf.puc-rio.br/lua/" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Lua</a>
4.0
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <img data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" align="bottom" alt="Lua" src="logo.gif"> 编程语言 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="http://www.tecgraf.puc-rio.br/lua/">Lua</a> 4.0 参考手册</font></font></font></h1>

<!--  $Id: manual.tex,v 1.45 2000/10/31 18:20:01 roberto Exp roberto $ -->
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<!-- ====================================================================== -->
</p><hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="1." data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<h1 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">1 - Introduction<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">1 - 简介</font></font></font></h1>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua is an extension programming language designed to support
general procedural programming with data description
facilities.
Lua is intended to be used as a powerful, light-weight
configuration language for any program that needs one.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 是一种扩展编程语言，旨在支持具有数据描述工具的通用过程编程。Lua 旨在用作任何需要 Lua 的程序的强大、轻量级的配置语言。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua is implemented as a library, written in C.
Being an extension language, Lua has no notion of a ``main'' program:
it only works <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">embedded</em> in a host client,
called the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">embedding</em> program.
This host program can invoke functions to execute a piece of
code in Lua, can write and read Lua variables,
and can register C&nbsp;functions to be called by Lua code.
Through the use of C&nbsp;functions, Lua can be augmented to cope with
a wide range of different domains,
thus creating customized programming languages sharing a syntactical framework.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 是作为用 C 语言编写的库实现的。作为一种扩展语言，Lua 没有 “main” 程序的概念：它只在<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">嵌入</em>到主机客户端（称为<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">嵌入</em>程序）中工作。这个主机程序可以调用函数来执行 Lua 中的一段代码，可以写入和读取 Lua 变量，并且可以注册 C 函数以供 Lua 代码调用。通过使用 C 函数，Lua 可以扩展以应对各种不同的领域，从而创建共享语法框架的定制编程语言。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua is free-distribution software,
and is provided as usual with no guarantees,
as stated in its copyright notice.
The implementation described in this manual is available
at the following URL's:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 是免费分发软件，如其版权声明中所述，它照常提供，不提供任何保证。本手册中描述的实现可在以下 URL 中找到：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       <a href="http://www.tecgraf.puc-rio.br/lua/" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">http://www.tecgraf.puc-rio.br/lua/</a>
       <a href="ftp://ftp.tecgraf.puc-rio.br/pub/lua/" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ftp://ftp.tecgraf.puc-rio.br/pub/lua/</a>
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="http://www.tecgraf.puc-rio.br/lua/">http://www.tecgraf.puc-rio.br/lua/</a>
<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="ftp://ftp.tecgraf.puc-rio.br/pub/lua/">ftp://ftp.tecgraf.puc-rio.br/pub/lua/</a></font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Like any other reference manual,
this document is dry in places.
For a discussion of the decisions behind the design of Lua,
see the papers below,
which are available at the web site above.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">与任何其他参考手册一样，本文档在某些地方是枯燥的。有关 Lua 设计背后的决策的讨论，请参阅下面的论文，这些论文可在上面的网站上获得。</font></font></font></p><ul data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
R.&nbsp;Ierusalimschy, L.&nbsp;H.&nbsp;de Figueiredo, and W.&nbsp;Celes.
Lua-an extensible extension language.
<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Software: Practice &amp; Experience</em> <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">26</b> #6 (1996) 635--652.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">R. Ierusalimschy、LH de Figueiredo 和 W. Celes。Lua-一种可扩展的扩展语言。<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">软件：实践与经验</em><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">26</b> #6 （1996） 635--652.</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
L.&nbsp;H.&nbsp;de Figueiredo, R.&nbsp;Ierusalimschy, and W.&nbsp;Celes.
The design and implementation of a language for extending applications.
<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Proceedings of XXI Brazilian Seminar on Software and Hardware</em> (1994) 273--283.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">LH de Figueiredo、R. Ierusalimschy 和 W. Celes。用于扩展应用程序的语言的设计和实现。<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">第二十一届巴西软件和硬件研讨会论文集</em> （1994） 273--283.</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
L.&nbsp;H.&nbsp;de Figueiredo, R.&nbsp;Ierusalimschy, and W.&nbsp;Celes.
Lua: an extensible embedded language.
<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Dr. Dobb's Journal</em> <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">21</b> #12 (Dec 1996) 26--33.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">LH de Figueiredo、R. Ierusalimschy 和 W. Celes。Lua：一种可扩展的嵌入式语言。<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Dobb 博士的日记</em><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">21</b> #12（1996 年 12 月），26--33。</font></font></font></li></ul>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<!-- ====================================================================== -->
</p><hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="2." data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<h1 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">2 - Environment and Chunks<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">2 - 环境和数据块</font></font></font></h1>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
All statements in Lua are executed in a <a name="global environment" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">global environment</em></a>.
This environment is initialized with a call from the embedding program to
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_open</code> and
persists until a call to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_close</code>,
or the end of the embedding program.
If necessary,
the host programmer can create multiple independent global
environments, and freely switch between them (see Section&nbsp;<a href="#mangstate" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">5.1</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 中的所有语句都在<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="global environment"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">全局环境中</em></a>执行。此环境通过嵌入程序对 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_open</code> 的调用进行初始化，并一直持续到调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_close</code> 或嵌入程序结束。如有必要，主机程序员可以创建多个独立的全局环境，并在它们之间自由切换（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#mangstate">5.1</a>）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The global environment can be manipulated by Lua code or
by the embedding program,
which can read and write global variables
using API functions from the library that implements Lua.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">全局环境可以通过 Lua 代码或嵌入程序进行操作，嵌入程序可以使用实现 Lua 的库中的 API 函数读取和写入全局变量。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<a name="Global variables" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Global variables</a> in Lua do not need to be declared.
Any variable is assumed to be global unless explicitly declared local
(see Section&nbsp;<a href="#localvar" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.4.6</a>).
Before the first assignment, the value of a global variable is <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 
(this default can be changed; see Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>).
A table is used to keep all global names and values
(tables are explained in Section&nbsp;<a href="#TypesSec" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">3</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 中的<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="Global variables">全局变量</a>不需要声明。除非明确声明为 local，否则任何变量都假定为全局变量（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#localvar">4.4.6</a>）。在第一次赋值之前，全局变量的值为 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> （此默认值可以更改;请参阅 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a>）。一个表用于保存所有全局名称和值（表 在 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#TypesSec">3</a> 中解释）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The unit of execution of Lua is called a <a name="chunk" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">chunk</em></a>.
A chunk is simply a sequence of statements,
which are executed sequentially.
Each statement can be optionally followed by a semicolon:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 的执行单元称为<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="chunk"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">块</em></a>。块只是一系列语句，这些语句按顺序执行。每个语句都可以选择后跟一个分号：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       chunk ::= {stat [`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">;</b>']}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">块 ：：= {stat ['<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">;</b>']}</font></font></font></pre>
Statements are described in Section&nbsp;<a href="#stats" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.4</a>.
(The notation above is the usual extended BNF,
in which
{<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</em>} means 0 or more <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</em>'s,
[<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</em>] means an optional <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</em>, and
(<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</em>)+ means one or more <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</em>'s.
The complete syntax of Lua is given in <a href="BNF" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">BNF</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">第 4.4 节 中描述了这些语句。
（上面的符号是通常的扩展 BNF，
其中
{a} 表示 0 个或多个 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</em>，
[<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</em>] 表示可选的 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</em>，而
（<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</em>）+ 指一个或多个 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</em>。
Lua 的完整语法在 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="BNF">BNF</a> 中给出）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
A chunk may be stored in a file or in a string inside the host program.
When a chunk is executed, first it is pre-compiled into bytecodes for
a virtual machine, and then the statements are executed in sequential order,
by simulating the virtual machine.
All modifications a chunk effects on the global environment persist
after the chunk ends.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">块可以存储在 host 程序内的文件或字符串中。执行块时，首先将其预编译为虚拟机的字节码，然后通过模拟虚拟机按顺序执行语句。数据块对全局环境的所有修改在数据块结束后仍然存在。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Chunks may also be pre-compiled into binary form and stored in files;
see program <a name="luac" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></tt></a><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><a href="luac.html">luac</a></tt> for details.
Text files with chunks and their binary pre-compiled forms
are interchangeable.
Lua automatically detects the file type and acts accordingly.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">块也可以预编译为二进制形式并存储在文件中;有关详细信息，请参阅程序<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="luac"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></tt> </a> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><a href="luac.html">luac</a></tt> 。具有块的文本文件及其二进制预编译形式是可互换的。Lua 会自动检测文件类型并采取相应措施。</font></font></font><a name="pre-compilation" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="TypesSec" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<!-- ====================================================================== -->
</p><hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="3." data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<h1 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">3 - Types and Tags<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">3 - 类型和标签</font></font></font></h1> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua is a <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">dynamically typed language</em>.
This means that
variables do not have types; only values do.
Therefore, there are no type definitions in the language.
All values carry their own type.
Besides a type, all values also have a <a name="tag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag</em></a>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 是一种<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">动态类型语言</em>。这意味着变量没有类型;只有值才会这样做。因此，该语言中没有类型定义。所有值都带有自己的类型。除了类型之外，所有值都有一个 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="tag"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag</em></a>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
There are six <a name="basic types" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">basic types</a> in Lua: <a name="nil" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</em></a>, <a name="number" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">number</em></a>,
<a name="string" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">string</em></a>, <a name="function" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</em></a>, <a name="userdata" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">userdata</em></a>, and <a name="table" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</em></a>.
<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Nil</em> is the type of the value <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>,
whose main property is to be different from any other value.
<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Number</em> represents real (double-precision floating-point) numbers,
while <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">string</em> has the usual meaning.
<a name="eight-bit clean" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Lua is 8-bit clean,
and so strings may contain any 8-bit character,
including embedded zeros (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">'\0'</code>) (see Section&nbsp;<a href="#lexical" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.1</a>).
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">type</code> function returns a string describing the type
of a given value (see Section&nbsp;<a href="#pdf-type" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 中有六种<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="basic types">基本类型</a>：<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="nil"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</em></a>、<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="number"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">number</em></a>、<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="string"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">string</em></a>、<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="function"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</em></a>、<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="userdata"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">userdata</em></a> 和 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="table"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</em></a>。<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Nil</em> 是值 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 的类型，其主要属性要不同于任何其他值。<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Number</em> 表示实数（双精度浮点）数字，而 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">string</em> 具有通常的含义。 Lua 是 8 位干净的，因此字符串可以包含任何 8 位字符，包括嵌入的零 （<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">'\0'</code>）（参见第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#lexical">4.1</a> 节）。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">type</code> 函数返回一个描述给定值类型的字符串（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#pdf-type">6.1</a>）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Functions are considered <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">first-class values</em> in Lua.
This means that functions can be stored in variables,
passed as arguments to other functions, and returned as results.
Lua can call (and manipulate) functions written in Lua and
functions written in C.
The two kinds of functions can be distinguished by their tags:
all Lua functions have the same tag,
and all C&nbsp;functions have the same tag,
which is different from the tag of Lua functions.
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag</code> function returns the tag
of a given value (see Section&nbsp;<a href="#pdf-tag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数在 Lua 中被视为<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">一等值</em>。这意味着函数可以存储在变量中，作为参数传递给其他函数，并作为结果返回。Lua 可以调用（和操作）用 Lua 编写的函数和用 C 编写的函数。两种函数可以通过它们的标签来区分：所有 Lua 函数都有相同的标签，所有 C 函数都有相同的标签，这与 Lua 函数的标签不同。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag</code> 函数返回给定值的 tag （参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#pdf-tag">6.1</a> ）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The type <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">userdata</em> is provided to allow
arbitrary <a name="C pointers" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">C&nbsp;pointers</a> to be stored in Lua variables.
This type corresponds to a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">void*</code>
and has no pre-defined operations in Lua,
except assignment and equality test.
However, by using <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag methods</em>,
the programmer can define operations for <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">userdata</em> values
(see Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">提供 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">userdata</em> 类型以允许将任意 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="C pointers">C&nbsp;指针</a>存储在 Lua 变量中。此类型对应于 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">void*</code>，并且在 Lua 中没有预定义的操作，除了赋值和相等性测试。但是，通过使用 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag 方法</em>，程序员可以为 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">userdata</em> 值定义操作（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a>）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The type <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</em> implements <a name="associative arrays" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">associative arrays</a>,
that is, <a name="arrays" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arrays</a> that can be indexed not only with numbers,
but with any value (except <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>).
Therefore, this type may be used not only to represent ordinary arrays,
but also symbol tables, sets, records, graphs, trees, etc.
Tables are the main data structuring mechanism in Lua.
To represent <a name="records" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">records</a>, Lua uses the field name as an index.
The language supports this representation by
providing <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a.name</code> as syntactic sugar for <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a["name"]</code>.
Tables may also carry <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">methods</em>:
Because functions are first class values,
table fields may contain functions.
The form <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t:f(x)</code> is syntactic sugar for <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t.f(t,x)</code>,
which calls the method <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f</code> from the table <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t</code> passing
the table itself as the first parameter (see Section&nbsp;<a href="#func-def" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.5.9</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">类型<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">表</em>实现<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="associative arrays">关联数组</a>，即不仅可以使用数字索引的<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="arrays">数组</a>，还可以使用任何值（<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 除外）进行索引。因此，这种类型不仅可以用于表示普通数组，还可以用于符号表、集合、记录、图形、树等。表格是 Lua 中的主要数据结构化机制。为了表示<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="records">记录</a>，Lua 使用字段名称作为索引。该语言通过提供 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a.name</code> 作为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a[“name”]</code> 的语法糖来支持这种表示形式。表也可以携带<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">方法</em>：因为函数是第一类值，所以表字段可以包含函数。形式 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t：f（x）</code> 是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t.f（t，x）</code> 的语法糖，它从表 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t</code> 中调用方法 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f</code>，将表本身作为第一个参数传递（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#func-def">4.5.9</a>）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Note that tables are <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">objects</em>, and not values.
Variables do not contain tables, only <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">references</em> to them.
Assignment, parameter passing, and returns always manipulate references
to tables, and do not imply any kind of copy.
Moreover, tables must be explicitly created before used
(see Section&nbsp;<a href="#tableconstructor" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.5.7</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">请注意，表是<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">对象</em>，而不是值。变量不包含表，仅包含对表的<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">引用</em>。赋值、参数传递和返回始终操作对 table 的引用，并且不意味着任何类型的复制。此外，在使用之前必须显式创建 table（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tableconstructor">4.5.7</a>）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Each of the types <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</em>, <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">number</em>, and <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">string</em> has a different tag.
All values of each of these types have the same pre-defined tag.
As explained above,
values of type <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</em> can have two different tags,
depending on whether they are Lua functions or C&nbsp;functions.
Finally,
values of type <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">userdata</em> and <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</em> can have variable tags,
assigned by the programmer (see Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>).
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag</code> function returns the tag of a given value.
User tags are created with the function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">newtag</code>.
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settag</code> function
is used to change the tag of a table (see Section&nbsp;<a href="#pdf-newtag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>).
The tag of userdata values can only be set from&nbsp;C (see Section&nbsp;<a href="#C-tags" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">5.7</a>).
Tags are mainly used to select <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag methods</em> when
some events occur.
Tag methods are the main mechanism for extending the
semantics of Lua (see Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">每种类型 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</em>、<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">number</em> 和 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">string</em> 都有不同的标签。每种类型的所有值都具有相同的预定义标签。如上所述，<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</em> 类型的值可以有两个不同的标签，具体取决于它们是 Lua 函数还是 C 函数。最后，<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">userdata</em> 和 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</em> 类型的值可以具有由程序员分配的变量标签（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a>）。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag</code> 函数返回给定值的 tag。用户标签是使用函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">newtag</code> 创建的。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settag</code> 函数用于更改表的标签（请参阅第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#pdf-newtag">6.1</a> 节）。userdata 值的标签只能从 C 设置（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#C-tags">5.7</a>）。标签主要用于在一些事件发生时选择<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">标签方法</em>。标记方法是扩展 Lua 语义的主要机制（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a>）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<!-- ====================================================================== -->
</p><hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="4." data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<h1 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4 - The Language<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4 - 语言</font></font></font></h1>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
This section describes the lexis, the syntax, and the semantics of Lua.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">本节介绍 Lua 的词法、语法和语义。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="lexical" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="4.1" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.1 - Lexical Conventions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.1 - 词汇约定</font></font></font></h2> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<a name="Identifiers" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Identifiers</em></a> in Lua can be any string of letters,
digits, and underscores,
not beginning with a digit.
This coincides with the definition of identifiers in most languages,
except that
the definition of letter depends on the current locale:
Any character considered alphabetic by the current locale
can be used in an identifier.
The following words are <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">reserved</em>, and cannot be used as identifiers:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="Identifiers"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Lua 中的标识符</em></a>可以是任何字母、数字和下划线字符串，不能以数字开头。这与大多数语言中标识符的定义一致，不同之处在于字母的定义取决于当前区域设置：当前区域设置认为是字母的任何字符都可以在标识符中使用。以下单词<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">是保留</em>的，不能用作标识符：</font></font></font><a name="reserved words" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       and       break     do        else      elseif
       end       for       function  if        in
       local     nil       not       or        repeat
       return    then      until     while
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">并打破 do else elseif
end 函数 （如果为 ）
本地 nil not 或 repeat
return then until while</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua is a case-sensitive language:
<tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">and</tt> is a reserved word, but <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">And</tt> and <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">�nd</tt>
(if the locale permits) are two different, valid identifiers.
As a convention, identifiers starting with underscore followed by
uppercase letters (such as <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code>)
are reserved for internal variables.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 是一种区分大小写的语言： <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">and</tt> 是一个保留字，但 <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">And</tt> 和 <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">�nd</tt> （如果区域设置允许） 是两个不同的有效标识符。按照惯例，以下划线开头后跟大写字母（如 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code>）的标识符保留用于内部变量。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The following strings denote other <a name="tokens" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tokens</a>:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">以下字符串表示其他<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="tokens">标记</a>：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       ~=    &lt;=    &gt;=    &lt;     &gt;     ==    =     +     -     *     /     
       (     )     {     }     [     ]     ;     ,     .     ..    ...
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">~= &lt;= &gt;= &lt; &gt; == = + - * /
(     )     {     }     [     ]     ;    ,     .    ..   ...</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<a name="Literal strings" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Literal strings</em></a>
can be delimited by matching single or double quotes,
and can contain the C-like escape sequences
`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\a</code>' (bell),
`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\b</code>' (backspace),
`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\f</code>' (form feed),
`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\n</code>' (newline),
`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\r</code>' (carriage return),
`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\t</code>' (horizontal tab),
`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\v</code>' (vertical tab),
`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\\</code>' (backslash),
`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\"</code>' (double quote),
`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\'</code>' (single quote),
and `<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\</code><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">newline</em>' (that is, a backslash followed by a real newline,
which  results in a newline in the string).
A character in a string may also be specified by its numerical value,
through the escape sequence `<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\</code><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ddd</em>',
where <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ddd</em> is a sequence of up to three <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">decimal</em> digits.
Strings in Lua may contain any 8-bit value, including embedded zeros,
which can be specified as `<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\000</code>'.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="Literal strings"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">文字字符串</em></a>可以通过匹配的单引号或双引号来分隔，并且可以包含类似 C 语言的转义序列 '<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\a</code>' （铃铛）、'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\b</code>' （退格）、'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\f</code>' （换页）、'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\n</code>' （换行符）、'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\r</code>' （回车）、'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\t</code>' （水平制表符）、'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\v</code>' （垂直制表符）、'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\\</code>' （反斜杠）、'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\“</code>' （双引号）、'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\'</code>' （单引号）和 '<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\</code><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">换行符</em>' （即，反斜杠后跟真正的换行符，这会导致字符串中出现换行符）。字符串中的字符也可以通过转义序列 '<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\</code><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ddd</em>' 由其数值指定，其中 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ddd</em> 是最多三个<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">十进制</em>数字的序列。Lua 中的字符串可以包含任何 8 位值，包括嵌入的零，可以指定为 '<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\000</code>'。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Literal strings can also be delimited by matching <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[[</code> ... <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">]]</code>.
Literals in this bracketed form may run for several lines,
may contain nested <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[[</code> ... <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">]]</code> pairs,
and do not interpret escape sequences.
This form is specially convenient for
writing strings that contain program pieces or
other quoted strings.
As an example, in a system using ASCII,
the following three literals are equivalent:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文本字符串也可以通过匹配 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[[</code> ...<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">]]。</code>此括号形式的文本可以运行多行，可能包含嵌套的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[[</code> ...<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">]]</code> 对，并且不解释转义序列。此格式特别适用于编写包含程序片段或其他带引号的字符串的字符串。例如，在使用 ASCII 的系统中，以下三个 Literals 是等效的：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       1)   "alo\n123\""
       2)   '\97lo\10\04923"'
       3)   [[alo
            123"]]
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">1） “alo\n123\””
2） '\97lo\10\04923“'
3） [[alo
123"]]</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<a name="Comments" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Comments</em></a> start anywhere outside a string with a
double hyphen (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">--</code>) and run until the end of the line.
Moreover,
the first line of a chunk is skipped if it starts with <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">#</code>.
This facility allows the use of Lua as a script interpreter
in Unix systems (see Section&nbsp;<a href="#lua-sa" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">8</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="Comments"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">注释</em></a>从字符串外部的任意位置开始，带有双连字符 （<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">--</code>），一直持续到行尾。此外，如果块以 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">#</code> 开头，则会跳过块的第一行。该工具允许在 Unix 系统中使用 Lua 作为脚本解释器（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#lua-sa">8</a>）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<a name="Numerical constants" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Numerical constants</em></a> may be written with an optional decimal part
and an optional decimal exponent.
Examples of valid numerical constants are
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="Numerical constants"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">数字常量</em></a>可以使用可选的小数部分和可选的十进制指数来编写。有效数值常量的示例包括</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       3     3.0     3.1416  314.16e-2   0.31416E1
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">3 3.0 3.1416 314.16E-2 0.31416E1</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="coercion" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="4.2" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.2 - Coercion<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.2 - 胁迫</font></font></font></h2> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua provides some automatic conversions between values at run time.
Any arithmetic operation applied to a string tries to convert
that string to a number, following the usual rules.
Conversely, whenever a number is used when a string is expected,
that number is converted to a string, in a reasonable format.
The format is chosen so that
a conversion from number to string then back to number
reproduces the original number <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exactly</em>.
Thus,
the conversion does not necessarily produces nice-looking text for some numbers.
For complete control of how numbers are converted to strings,
use the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">format</code> function (see Section&nbsp;<a href="#format" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.2</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 在运行时提供了一些值之间的自动转换。应用于字符串的任何算术运算都会尝试按照通常的规则将该字符串转换为数字。相反，每当在需要字符串时使用数字时，该数字都会以合理的格式转换为字符串。选择格式是为了让从 number 到 string 然后再转换回 number 可以<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">精确地</em>再现原始 number。因此，转换不一定会为某些数字生成漂亮的文本。要完全控制数字如何转换为字符串，请使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">format</code> 函数（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#format">6.2</a>）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="adjust" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="4.3" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.3 - Adjustment<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.3 - 调整</font></font></font></h2> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Functions in Lua can return many values.
Because there are no type declarations,
when a function is called
the system does not know how many values the function will return,
or how many parameters it needs.
Therefore, sometimes, a list of values must be <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">adjusted</em>, at run time,
to a given length.
If there are more values than are needed,
then the excess values are thrown away.
If there are less values than are needed,
then the list is extended with as many  <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>'s as needed.
This adjustment occurs in multiple assignments (see Section&nbsp;<a href="#assignment" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.4.2</a>)
and in function calls (see Section&nbsp;<a href="#functioncall" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.5.8</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 中的函数可以返回许多值。因为没有类型声明，所以当调用函数时，系统不知道函数将返回多少个值，或者它需要多少个参数。因此，有时必须在运行时将值列表<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">调整</em>为给定的长度。如果值多于所需值，则丢弃多余的值。如果值少于所需值，则根据需要使用任意数量的 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 扩展列表。此调整发生在多个赋值（请参阅 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#assignment">4.4.2</a>）和函数调用（请参阅 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#functioncall">4.5.8</a>）中。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="stats" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="4.4" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.4 - Statements<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.4 - 声明</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua supports an almost conventional set of <a name="statements" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">statements</a>,
similar to those in Pascal or C.
The conventional commands include
assignment, control structures, and procedure calls.
Non-conventional commands include table constructors
(see Section&nbsp;<a href="#tableconstructor" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.5.7</a>)
and local variable declarations (see Section&nbsp;<a href="#localvar" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.4.6</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 支持一组几乎约定俗成的语句，类似于 Pascal 或 C 中的<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="statements">语句</a>。常规命令包括赋值、控制结构和过程调用。非常规命令包括 table 构造函数（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tableconstructor">4.5.7</a>）和局部变量声明（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#localvar">4.4.6</a>）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.4.1 - Blocks<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.4.1 - 块</font></font></font></h3>
A <a name="block" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">block</a> is a list of statements;
syntactically, a block is equal to a chunk:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="block">块</a>是语句列表;
从语法上讲，一个块等于一个块：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       block ::= chunk
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">块 ：：= 块</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
A block may be explicitly delimited:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">块可以显式分隔：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       stat ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b>
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">stat ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b></font></font></font></pre>
Explicit blocks are useful
to control the scope of local variables (see Section&nbsp;<a href="#localvar" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.4.6</a>).
Explicit blocks are also sometimes used to
add a <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> or <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> statement in the middle
of another block (see Section&nbsp;<a href="#control" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.4.3</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">显式块很有用
来控制局部变量的范围（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#localvar">4.4.6</a>）。
显式块有时也用于
在中间添加 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> 或 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> 语句
另一个块（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#control">4.4.3</a>）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="assignment" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.4.2 - <a name="Assignment</H3>" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Assignment</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.4.2 - </font></font></font></h3> 
Lua allows <a name="multiple assignment" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">multiple assignment</a>.
Therefore, the syntax for assignment
defines a list of variables on the left side
and a list of expressions on the right side.
The elements in both lists are separated by commas:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 允许<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="multiple assignment">多重赋值</a>。
因此，赋值的语法
在左侧定义变量列表
和右侧的表达式列表。
两个列表中的元素都用逗号分隔：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       stat ::= varlist1 `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' explist1
       varlist1 ::= var {`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' var}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">stat ：：= varlist1 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' explist1
varlist1 ：：= var {'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' var}</font></font></font></pre>
This statement first evaluates all values on the right side
and eventual indices on the left side,
and then makes the assignments.
So, the code
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此语句首先计算右侧的所有值
和左侧的最终索引，
然后进行分配。
所以，代码</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       i = 3
       i, a[i] = 4, 20
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">i = 3
我，一个[i] = 4,20</font></font></font></pre>
sets <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a[3]</code> to 20, but does not affect <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a[4]</code>
because the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</code> in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a[i]</code> is evaluated
before it is assigned <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">A[3]</code> 设置为 20，但不影响 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">A[4]</code>
因为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a[i]</code> 中的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</code> 是求值的
在分配 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4</code> 之前。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Multiple assignment can be used to exchange two values, as in
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">多重赋值可用于交换两个值，如</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       x, y = y, x
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">x， y = y， x</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The two lists in a multiple assignment may have different lengths.
Before the assignment, the list of values is adjusted to
the length of the list of variables (see Section&nbsp;<a href="#adjust" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.3</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">多个作业中的两个列表可能具有不同的长度。在赋值之前，将值列表调整为变量列表的长度（请参阅 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#adjust">4.3</a> ）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
A single name can denote a global variable, a local variable,
or a formal parameter:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">单个名称可以表示全局变量、局部变量或形式参数：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       var ::= name
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">var ：：= 名称</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Square brackets are used to index a table:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">方括号用于索引表：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       var ::= varorfunc `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[</b>' exp1 `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">]</b>'
       varorfunc ::= var | functioncall
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">var ：：= varorfunc '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[</b>' exp1 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">]</b>'
varorfunc ：：= var |function调用</font></font></font></pre>
The <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">varorfunc</em> should result in a table value,
from where the field indexed by the expression <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exp1</em>
value gets the assigned value.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">varorfunc</em> 应生成一个 table 值
from，其中由表达式 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exp1</em> 索引的字段
value 获取分配的值。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The syntax <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">var.NAME</code> is just syntactic sugar for
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">var["NAME"]</code>:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">语法 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">var.NAME</code> 只是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">var[“NAME”]</code> 的语法糖：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       var ::= varorfunc `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">.</b>' name
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">var ：：= varorfunc '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">.</b>' 名称</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The meaning of assignments and evaluations of global variables and
indexed variables can be changed by tag methods (see Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>).
Actually,
an assignment <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x = val</code>, where <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</code> is a global variable,
is equivalent to a call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setglobal("x", val)</code> and
an assignment <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t[i] = val</code> is equivalent to
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settable_event(t,i,val)</code>.
See Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a> for a complete description of these functions
(<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setglobal</code> is in the basic library;
<tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settable_event</tt> is used for explanatory purposes only).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">全局变量和索引变量的赋值和计算的含义可以通过标签方法更改（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a>）。实际上，赋值 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x = val</code>（其中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</code> 是全局变量）等效于调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setglobal（“x”， val），</code>赋值 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t[i] = val</code> 等效于 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settable_event（t，i，val）。</code>有关这些函数的完整描述，请参见Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a>（<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setglobal</code>在basic库中; <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settable_event</tt> 仅用于解释目的）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="control" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.4.3 - Control Structures<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.4.3 - 控制结构</font></font></font></h3>
The control structures
<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">if</b>, <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">while</b>, and <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repeat</b> have the usual meaning and
familiar syntax
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">控制结构
<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">if</b>、<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">while</b> 和 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repeat</b> 具有通常的含义，并且
熟悉的语法</font></font></font><a name="while-do statement" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="repeat-until statement" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="if-then-else statement" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       stat ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">while</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b>
       stat ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repeat</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">until</b> exp1
       stat ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">if</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">then</b> block {<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">elseif</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">then</b> block} [<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">else</b> block] <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b>
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">stat ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">而</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">阻止</b><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">结束</b>
stat ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">重复</b>区块<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">直到</b> exp1
stat ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">如果</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">then</b> block {<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">elseif</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">then</b> block} [<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">else</b> block] <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b></font></font></font></pre>
The <a name="condition expression" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">condition expression</a> <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exp1</em> of a control structure may return any value.
All values different from <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> are considered true;
only <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> is considered false.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">控制结构的条件<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="condition expression">表达式</a><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exp1</em> 可以返回任何值。
所有不同于 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 的值都被视为 true;
只有 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 被视为 false。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> statement is used to return values
from a function or from a chunk.
<a name="return" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>

<a name="return statement" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Because functions or chunks may return more than one value,
the syntax for the <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> statement is
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> 语句用于从函数或块返回值。 由于函数或块可能返回多个值，因此 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> 语句的语法为</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       stat ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> [explist1]
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">stat ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">返回</b> [explist1]</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> statement can be used to terminate the execution of a loop,
skipping to the next statement after the loop:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> 语句可用于终止循环的执行，跳到循环之后的下一条语句：</font></font></font><a name="break statement" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       stat ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b>
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">stat ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b></font></font></font></pre>
A <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> ends the innermost enclosing loop
(<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">while</b>, <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repeat</b>, or <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> 结束最内层的封闭循环
（<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">while</b>、<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repeat</b> 或 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b>）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
For syntactic reasons, <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> and <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b>
statements can only be written as the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">last</em> statements of a block.
If it is really necessary to <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> or <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> in the
middle of a block,
an explicit inner block can used,
as in the idiom `<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do return end</code>',
because now <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> is last statement in the inner block.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">出于语法原因，<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> 和 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> 语句只能写为块的<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">最后一个</em>语句。如果确实需要在块的中间<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">返回或</b><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">中断</b>，可以使用显式的内部块，如成语 '<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do return end</code>'，因为现在 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> 是内部块中的最后一条语句。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="for" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.4.4 - For Statement<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.4.4 - For 语句</font></font></font></h3> <a name="for statement" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> statement has two forms,
one for numbers and one for tables.
The numerical <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> loop has the following syntax:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> 语句有两种形式，一种用于数字，一种用于表格。数字 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> 循环的语法如下：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       stat ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> name `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' exp1 `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' exp1 [`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' exp1] <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b>
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">stat ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> name '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' exp1 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' exp1 ['<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' exp1] <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b></font></font></font></pre>
A <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> statement like
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">A <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> 语句，如</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       for var = e1 ,e2, e3 do block end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">对于 var = e1 ，e2， e3 do block end</font></font></font></pre>
is equivalent to the code:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">等价于代码：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       do
         local var, _limit, _step = tonumber(e1), tonumber(e2), tonumber(e3)
         if not (var and _limit and _step) then error() end
         while (_step&gt;0 and var&lt;=_limit) or (_step&lt;=0 and var&gt;=_limit) do
           block
           var = var+_step
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">做
本地 var， _limit， _step = toNumber（E1）， ToNumber（E2）， ToNumber（E3）
如果不是 （var and _limit and _step） 则 error（） 结束
而 （_step&gt;0 和 var&lt;=_limit） 或 （_step&lt;=0 和 var&gt;=_limit） 则
块
var = var + _step
结束
结束</font></font></font></pre>
Note the following:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">请注意以下事项：</font></font></font><ul data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">sep=0pt
</li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_limit</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_step</code> are invisible variables.
The names are here for explanatory purposes only.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_limit</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_step</code> 是不可见的变量。这些名称仅用于说明目的。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">The behavior is <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">undefined</em> if you assign to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">var</code> inside
the block.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果在块内分配给 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">var</code>，则行为未<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">定义</em>。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">If the third expression (the step) is absent, then a step of&nbsp;1 is used.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果第三个表达式 （步骤） 不存在，则使用步骤 1。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Both the limit and the step are evaluated only once,
before the loop starts.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在循环开始之前，limit 和 step 都只评估一次。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">The variable <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">var</code> is local to the statement;
you cannot use its value after the <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> ends.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">变量 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">var</code> 是语句的局部变量;您不能在 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> 结束后使用其值。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">You can use <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> to exit a <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b>.
If you need the value of the index,
assign it to another variable before breaking.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">您可以使用 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> 退出 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b>.如果需要索引的值，请在中断之前将其分配给另一个变量。</font></font></font></li></ul>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The table <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> statement traverses all pairs
(index,value) of a given table.
It has the following syntax:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">table <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> 语句遍历给定表的所有对 （index，value）。它具有以下语法：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       stat ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> name `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' name <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">in</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b>
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">stat ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> name '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' name <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">in</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b></font></font></font></pre>
A <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> statement like
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">A <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> 语句，如</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       for index, value in exp do block end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">对于 index，exp 中的值执行块结束</font></font></font></pre>
is equivalent to the code:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">等价于代码：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       do
         local _t = exp
         local index, value = next(t, nil)
         while index do
           block
           index, value = next(t, index)
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">做
本地 _t = exp
local index，值 = next（t， nil）
而 index 执行
块
索引，值 = next（t， index）
结束
结束</font></font></font></pre>
Note the following:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">请注意以下事项：</font></font></font><ul data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">sep=0pt
</li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_t</code> is an invisible variable.
The name is here for explanatory purposes only.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_t</code> 是一个不可见的变量。此处的名称仅用于说明目的。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">The behavior is <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">undefined</em> if you assign to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> inside
the block.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果赋值给块内的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code>，则行为<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">未定义</em>。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">The behavior is <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">undefined</em> if you change
the table <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_t</code> during the traversal.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果您在遍历期间更改表<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_t</code>，则行为<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">未定义</em>。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">The variables <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">value</code> are local to the statement;
you cannot use their values after the <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> ends.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">变量 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">value</code> 是语句的本地变量;您不能在 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> 结束后使用它们的值。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">You can use <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> to exit a <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b>.
If you need the value of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">value</code>,
assign them to other variables before breaking.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">您可以使用 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> 退出 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b>.如果需要 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">value</code> 的值，请在断开之前将它们分配给其他变量。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">The order that table elements are traversed is undefined,
<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">even for numerical indices</em>.
If you want to traverse indices in numerical order,
use a numerical <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">遍历表元素的顺序是不确定的，<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">即使对于数字索引也是如此</em>。如果要按数字顺序遍历索引，请使用数字 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b>。</font></font></font></li></ul>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="funcstat" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.4.5 - Function Calls as Statements<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.4.5 - 作为语句的函数调用</font></font></font></h3> 
Because of possible side-effects,
function calls can be executed as statements:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">由于可能的副作用，
函数调用可以作为语句执行：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       stat ::= functioncall
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">stat ：：= 函数调用</font></font></font></pre>
In this case, all returned values are thrown away.
Function calls are explained in Section&nbsp;<a href="#functioncall" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.5.8</a>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在这种情况下，所有返回的值都将被丢弃。
函数调用在 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#functioncall">4.5.8</a> 中解释。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="localvar" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.4.6 - Local Declarations<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.4.6 - 本地声明</font></font></font></h3> 
<a name="Local variables" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Local variables</a> may be declared anywhere inside a block.
The declaration may include an initial assignment:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="Local variables">局部变量</a>可以在块内的任意位置声明。
声明可以包括初始分配：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       stat ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">local</b> declist [init]
       declist ::= name {`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' name}
       init ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' explist1
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">stat ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">本地</b> declist [init]
declist ：：= 名称 {'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' 名称}
初始化 ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' explist1</font></font></font></pre>
If present, an initial assignment has the same semantics
of a multiple assignment.
Otherwise, all variables are initialized with <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果存在，则初始赋值具有相同的语义
的多个分配。
否则，所有变量都使用 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 初始化。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
A chunk is also a block,
and so local variables can be declared outside any explicit block.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">块也是一个块，因此可以在任何显式块之外声明局部变量。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The scope of local variables begins <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">after</em>
the declaration and lasts until the end of the block.
Thus, the code
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">local print=print</code>
creates a local variable called <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">print</code> whose
initial value is that of the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">global</em> variable of the same name.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">局部变量的范围从声明<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">之后</em>开始，一直持续到块的末尾。因此，代码<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">局部 print=print</code> 会创建一个名为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">print</code> 的局部变量，其初始值是同名<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">全局</em>变量的初始值。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="4.5" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.5 - Expressions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.5 - 表达式</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.5.1 - <a name="Basic Expressions</H3>" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Basic Expressions</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.5.1 - </font></font></font></h3>
The basic expressions in Lua are
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 中的基本表达式是</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       exp ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">(</b>' exp `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">)</b>'
       exp ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>
       exp ::= number
       exp ::= literal
       exp ::= var
       exp ::= upvalue
       exp ::= function
       exp ::= functioncall
       exp ::= tableconstructor
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">exp ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">（</b>' exp '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">）</b>'
exp ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">无</b>
exp ：：= 数字
exp ：：= 文本
exp ：：= var
exp ：：= up值
exp ：：= 函数
exp ：：= 函数调用
exp ：：= tableconstructor</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Numbers (numerical constants) and
literal strings are explained in Section&nbsp;<a href="#lexical" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.1</a>;
variables are explained in Section&nbsp;<a href="#assignment" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.4.2</a>;
upvalues are explained in Section&nbsp;<a href="#upvalue" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.6</a>;
function definitions are explained in Section&nbsp;<a href="#func-def" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.5.9</a>;
function calls are explained in Section&nbsp;<a href="#functioncall" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.5.8</a>.
Table constructors are explained in Section&nbsp;<a href="#tableconstructor" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.5.7</a>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">数字（数字常量）和文字字符串在 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#lexical">4.1</a> 中解释;变量在 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#assignment">4.4.2</a> 中解释;upvalues 在 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#upvalue">4.6</a> 中解释;函数定义在 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#func-def">4.5.9</a> 中解释;函数调用在 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#functioncall">4.5.8</a> 中解释。Table 构造函数在 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tableconstructor">4.5.7</a> 中解释。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
An access to a global variable <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</code> is equivalent to a
call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getglobal("x")</code> and
an access to an indexed variable <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t[i]</code> is equivalent to
a call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gettable_event(t,i)</code>.
See Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a> for a description of these functions
(<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getglobal</code> is in the basic library;
<tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gettable_event</tt> is used for explanatory purposes only).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">对全局变量 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</code> 的访问等效于调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getglobal（“x”），</code>对索引变量 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t[i]</code> 的访问等效于调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gettable_event（t，i）。</code>有关这些函数的描述，请参见Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a>（<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getglobal</code>在basic库中; <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gettable_event</tt> 仅用于解释目的）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The non-terminal <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exp1</em> is used to indicate that the values
returned by an expression must be adjusted to one single value:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">非终端 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exp1</em> 用于指示表达式返回的值必须调整为一个值：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       exp1 ::= exp
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">exp1 ：：= exp</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.5.2 - Arithmetic Operators<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.5.2 - 算术运算符</font></font></font></h3>
Lua supports the usual <a name="arithmetic operators" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arithmetic operators</a>:
the binary <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">+</code> (addition),
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code> (subtraction), <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</code> (multiplication),
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">/</code> (division), and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^</code> (exponentiation);
and unary <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code> (negation).
If the operands are numbers, or strings that can be converted to
numbers (according to the rules given in Section&nbsp;<a href="#coercion" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.2</a>),
then all operations except exponentiation have the usual meaning.
Otherwise, an appropriate tag method is called (see Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>).
An exponentiation always calls a tag method.
The standard mathematical library redefines this method for numbers,
giving the expected meaning to <a name="exponentiation" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exponentiation</a>
(see Section&nbsp;<a href="#mathlib" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.3</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 支持常用的<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="arithmetic operators">算术运算符</a>：
二进制 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">+</code>（加法）、
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code> （减法）、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</code>（乘法）、
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">/</code> （除法） 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^</code> （幂）;
和 1 元 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code> （否定）。
如果操作数是数字或可以转换为
数字（根据第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#coercion">4.2</a> 节中给出的规则），
那么除 exponentiation 之外的所有运算都具有通常的含义。
否则，将调用适当的 tag 方法（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a> ）。
幂运算始终调用 tag 方法。
标准数学库重新定义了数字的此方法，
赋予 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="exponentiation">exponentiation</a> 预期的含义
（参见第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#mathlib">6.3</a> 节）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.5.3 - Relational Operators<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.5.3 - 关系运算符</font></font></font></h3>
The <a name="relational operators" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">relational operators</a> in Lua are
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 中的<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="relational operators">关系运算符</a>是</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       ==    ~=    &lt;     &gt;     &lt;=    &gt;=
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">== ~= &lt; &gt; &lt;= &gt;=</font></font></font></pre>
These operators return <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> as false and a value different from <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> as true.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这些运算符返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 为 false，并且返回与 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 不同的值为 true。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Equality (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">==</code>) first compares the tags of its operands.
If they are different, then the result is <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
Otherwise, their values are compared.
Numbers and strings are compared in the usual way.
Tables, userdata, and functions are compared by reference,
that is, two tables are considered equal only if they are the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">same</em> table.
The operator <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">~=</code> is exactly the negation of equality (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">==</code>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">相等 （<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">==</code>） 首先比较其操作数的标记。如果它们不同，则结果为 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。否则，将比较它们的值。数字和字符串以通常的方式进行比较。表、userdata 和函数通过引用进行比较，也就是说，只有当两个表是<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">同一个</em>表时，它们才被视为相等。运算符 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">~=</code> 正是相等 （<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">==</code>） 的否定。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The conversion rules of Section&nbsp;<a href="#coercion" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.2</a>
<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do not</em> apply to equality comparisons.
Thus, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"0"==0</code> evaluates to <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">false</em>,
and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t[0]</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t["0"]</code> denote different
entries in a table.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#coercion">4.2</a> 的转换规则<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">不适用于</em>相等比较。因此，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“0”==0</code> 的计算结果为 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">false</em>，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">而 t[0]</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t[“0”]</code> 表示表中的不同条目。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The order operators work as follows.
If both arguments are numbers, then they are compared as such.
Otherwise, if both arguments are strings,
then their values are compared using lexicographical order.
Otherwise, the ``lt'' tag method is called (see Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">order 运算符的工作原理如下。如果两个参数都是数字，则按此方式比较它们。否则，如果两个参数都是字符串，则使用字典顺序比较它们的值。否则，调用 ''lt'' 标签方法（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a>）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.5.4 - Logical Operators<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.5.4 - 逻辑运算符</font></font></font></h3>
The <a name="logical operators" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">logical operators</a> in Lua are
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 中的<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="logical operators">逻辑运算符</a>是</font></font></font><a name="and" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="or" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="not" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       and   or    not
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">并且或不</font></font></font></pre>
Like the control structures, all logical operators
consider <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> as false and anything else as true.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">与控制结构一样，所有逻辑运算符
将 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 视为 false，将其他任何内容视为 true。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The conjunction operator <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">and</code> returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> if its first argument is <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>;
otherwise, it returns its second argument.
The disjunction operator <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">or</code> returns its first argument
if it is different from <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>;
otherwise, it returns its second argument.
Both <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">and</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">or</code> use <a name="short-cut evaluation" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">short-cut evaluation</a>,
that is,
the second operand is evaluated only if necessary.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">连词运算符<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</code>如果其第一个参数为 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>，则返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>;否则，它将返回其第二个参数。析取运算符 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">or</code> 如果它不同于 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>，则返回其第一个参数;否则，它将返回其第二个参数。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">and</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">or</code> 都使用<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="short-cut evaluation">快捷方式计算</a>，即仅在必要时计算第二个操作数。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
There are two useful Lua idioms that use logical operators.
The first idiom is
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">有两个使用逻辑运算符的有用 Lua 惯用语。第一个成语是</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       x = x or v
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">x = x 或 v</font></font></font></pre>
which is equivalent to
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">相当于</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       if x == nil then x = v end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果 x == nil 则 x = v 结束</font></font></font></pre>
This idiom sets <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</code> to a default value <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">v</code> when <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</code> is not set.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</code> 未设置时，此惯用语将 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</code> 设置为默认值 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">v</code>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The second idiom is
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">第二个成语是</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       x = a and b or c
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">x = a 和 b 或 c</font></font></font></pre>
which should be read as <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x = (a and b) or c</code>.
This idiom is equivalent to
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">应读作 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x = （a and b） 或 c</code>。
这个成语相当于</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       if a then x = b else x = c end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果 a 则 x = b 否则 x = c 结束</font></font></font></pre>
provided that <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">b</code> is not <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">前提是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">B</code> 不是 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="concat" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.5.5 - Concatenation<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.5.5 - 串联</font></font></font></h3> 
The string <a name="concatenation" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">concatenation</a> operator in Lua is
denoted by two dots (`<a name=".." data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">..</tt></a>').
If both operands are strings or numbers, then they are converted to
strings according to the rules in Section&nbsp;<a href="#coercion" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.2</a>.
Otherwise, the ``concat'' tag method is called (see Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 中的字符串<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="concatenation">连接</a>运算符是
由两个点 （'<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name=".."> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">..</tt> </a>'） 表示。
如果两个操作数都是字符串或数字，则它们将转换为
字符串。<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#coercion"></a>
否则，将调用 ''concat'' 标签方法（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a>）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.5.6 - Precedence<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.5.6 - 优先级</font></font></font></h3>
<a name="Operator precedence" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Operator precedence</a> in Lua follows the table below,
from the lower to the higher priority:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 中的<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="Operator precedence">运算符优先级</a>如下表所示，
从较低优先级到较高优先级：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       and   or
       &lt;     &gt;     &lt;=    &gt;=    ~=    ==
       ..
       +     -
       *     /
       not   - (unary)
       ^
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">及 或
&lt; &gt; &lt;= &gt;= ~= ==
..
+     -
*     /
非 -（一元）
^</font></font></font></pre>
All binary operators are left associative,
except for <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^</code> (exponentiation),
which is right associative.
The pre-compiler may rearrange the order of evaluation of
associative operators (such as&nbsp;<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">..</code> or&nbsp;<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">+</code>),
as long as these optimizations do not change normal results.
However, these optimizations may change some results
if you define non-associative
tag methods for these operators.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">所有二元运算符都是左结合的，
除了 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^</code>（幂）、
这是正确的联想。
预编译器可能会重新排列
关联运算符（例如 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">..</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">+</code>）、
只要这些优化不会改变正常结果。
但是，这些优化可能会更改某些结果
如果定义 non-Associative
标记方法。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="tableconstructor" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.5.7 - Table Constructors<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.5.7 - 表构造函数</font></font></font></h3> 
Table <a name="constructors" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">constructors</a> are expressions that create tables;
every time a constructor is evaluated, a new table is created.
Constructors can be used to create empty tables,
or to create a table and initialize some of its fields.
The general syntax for constructors is
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">表<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="constructors">构造函数</a>是创建表的表达式;
每次计算构造函数时，都会创建一个新表。
构造函数可用于创建空表，
或者创建表并初始化其某些字段。
构造函数的一般语法是</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       tableconstructor ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">{</b>' fieldlist `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">}</b>'
       fieldlist ::= lfieldlist | ffieldlist | lfieldlist `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">;</b>' ffieldlist | ffieldlist `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">;</b>' lfieldlist
       lfieldlist ::= [lfieldlist1]
       ffieldlist ::= [ffieldlist1]
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">tableconstructor ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">{</b>' 字段列表 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">}</b>'
字段列表 ：：= lfieldlist |ffieldlist |lfieldlist '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">;</b>' ffieldlist |ffieldlist '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">;</b>' lfieldlist
lfieldlist ：：= [lfieldlist1]
ffieldlist ：：= [ffieldlist1]</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The form <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lfieldlist1</em> is used to initialize lists:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">形式 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lfieldlist1</em> 用于初始化列表：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       lfieldlist1 ::= exp {`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' exp} [`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>']
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">lfieldlist1 ：：= exp {'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' exp} ['<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>']</font></font></font></pre>
The expressions in the list are assigned to consecutive numerical indices,
starting with&nbsp;1.
For example,
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">列表中的表达式被分配给连续的数字索引
从 1 开始。
例如</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       a = {"v1", "v2", 34}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">a = {“v1”， “v2”， 34}</font></font></font></pre>
is equivalent to
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">等效于</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       do
         local temp = {}
         temp[1] = "v1"
         temp[2] = "v2"
         temp[3] = 34
         a = temp
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">做
本地温度 = {}
temp[1] = “v1”
temp[2] = “v2”
温度[3] = 34
a = 温度
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The form <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ffieldlist1</em> initializes other fields in a table:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ffieldlist1</em> 形式初始化表中的其他字段：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       ffieldlist1 ::= ffield {`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' ffield} [`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>']
       ffield ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[</b>' exp `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">]</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' exp | name `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' exp
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">ffieldlist1 ：：= ffield {'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' ffield} ['<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>']
ffield ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[</b>' exp '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">]</b>' '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' exp |名称 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' exp</font></font></font></pre>
For example,
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">例如</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       a = {[f(k)] = g(y), x = 1, y = 3, [0] = b+c}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">a = {[f（k）] = g（y）， x = 1， y = 3， [0] = b+c}</font></font></font></pre>
is equivalent to
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">等效于</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       do
         local temp = {}
         temp[f(k)] = g(y)
         temp.x = 1    -- or temp["x"] = 1
         temp.y = 3    -- or temp["y"] = 3
         temp[0] = b+c
         a = temp
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">做
本地温度 = {}
温度[f（k）] = g（y）
temp.x = 1 -- 或 temp[“x”] = 1
temp.y = 3 -- 或 temp[“y”] = 3
温度 [0] = b+c
a = 温度
结束</font></font></font></pre>
An expression like <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">{x = 1, y = 4}</code> is
in fact syntactic sugar for <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">{["x"] = 1, ["y"] = 4}</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">类似于 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">{x = 1， y = 4}</code> 的表达式是
实际上，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">{[“x”] = 1， [“y”] = 4}</code> 的语法糖。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Both forms may have an optional trailing comma,
and can be used in the same constructor separated by
a semi-colon.
For example, all forms below are correct.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这两种形式都可以有一个可选的尾随逗号，并且可以在用分号分隔的同一个构造函数中使用。例如，下面的所有形式都是正确的。</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       x = {;}
       x = {"a", "b",}
       x = {type="list"; "a", "b"}
       x = {f(0), f(1), f(2),; n=3,}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">x = {;
x = {“a”， “b”，}
x = {type=“list”;“a”， “b”}
x = {f（0）， f（1）， f（2），;n=3，}</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="functioncall" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.5.8 - Function Calls<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.5.8 - 函数调用</font></font></font></h3>  
A <a name="function call" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function call</a> in Lua has the following syntax:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 中的<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="function call">函数调用</a>具有以下语法：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       functioncall ::= varorfunc args
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">functioncall ：：= varorfunc args</font></font></font></pre>
First, <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">varorfunc</em> is evaluated.
If its value has type <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</em>,
then this function is called,
with the given arguments.
Otherwise, the ``function'' tag method is called,
having as first parameter the value of <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">varorfunc</em>,
and then the original call arguments
(see Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">首先，评估 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">varorfunc</em>。
如果其值具有 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</em> 类型，则
然后调用此函数，
替换为给定的参数。
否则，将调用 ''function'' 标签方法，
将 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">varorfunc</em> 的值作为第一个参数，
然后是原始调用参数
（参见第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a> 节）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The form
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">表单</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       functioncall ::= varorfunc `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">:</b>' name args
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">functioncall ：：= varorfunc '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">：</b>' name args</font></font></font></pre>
can be used to call ``methods''.
A call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">v:name(...)</code>
is syntactic sugar for <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">v.name(v, ...)</code>,
except that <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">v</code> is evaluated only once.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">可以用来调用 ''methods'' 。
调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">v：name（...）</code>
是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">v.name（v， ...）</code>，
只不过 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">v</code> 只计算一次。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Arguments have the following syntax:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">参数具有以下语法：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       args ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">(</b>' [explist1] `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">)</b>'
       args ::= tableconstructor
       args ::= literal
       explist1 ::= {exp1 `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>'} exp
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">参数 ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">（</b>' [explist1] '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">）</b>'
args ：：= tableconstructor
args ：：= 字面量
explist1 ：：= {exp1 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>'} exp</font></font></font></pre>
All argument expressions are evaluated before the call.
A call of the form <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f{...}</code> is syntactic sugar for
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f({...})</code>, that is,
the argument list is a single new table.
A call of the form <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f'...'</code>
(or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f"..."</code> or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f[[...]]</code>) is syntactic sugar for
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f('...')</code>, that is,
the argument list is a single literal string.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">所有参数表达式在调用之前进行计算。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f{...}</code> 形式的调用是
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f（{...}） 的 f（{...}），</code>即
Argument List 是一个新表。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f'...'</code> 形式的调用
（或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f“...”</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f[[...]]）</code>是语法糖
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f（'...'） 的 f（'...'）</code> 中，即
参数列表是单个文本字符串。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Because a function can return any number of results
(see Section&nbsp;<a href="#return" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.4.3</a>),
the number of results must be adjusted before they are used (see Section&nbsp;<a href="#adjust" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.3</a>).
If the function is called as a statement (see Section&nbsp;<a href="#funcstat" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.4.5</a>),
then its return list is adjusted to&nbsp;0,
thus discarding all returned values.
If the function is called in a place that needs a single value
(syntactically denoted by the non-terminal <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exp1</em>),
then its return list is adjusted to&nbsp;1,
thus discarding all returned values but the first one.
If the function is called in a place that can hold many values
(syntactically denoted by the non-terminal <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exp</em>),
then no adjustment is made.
The only places that can hold many values
is the last (or the only) expression in an assignment,
in an argument list, or in the <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> statement.
Here are some examples:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">因为一个函数可以返回任意数量的结果（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#return">4.4.3</a>），所以在使用结果之前必须调整结果的数量（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#adjust">4.3</a>）。如果该函数作为语句调用（请参阅 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#funcstat">4.4.5</a> ），则其返回列表将调整为 0，从而丢弃所有返回值。如果在需要单个值的地方调用该函数（在语法上由非终端 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exp1</em> 表示），则其返回列表将调整为 1，从而丢弃除第一个值之外的所有返回值。如果在可以保存许多值（语法上由非终端 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exp</em> 表示）的位置调用函数，则不会进行任何调整。唯一可以保存许多值的位置是赋值、参数列表或 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> 语句中的最后一个（或唯一）表达式。以下是一些示例：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       f()                -- adjusted to 0 results
       g(f(), x)          -- f() is adjusted to 1 result
       g(x, f())          -- g gets x plus all values returned by f()
       a,b,c = f(), x     -- f() is adjusted to 1 result (and c gets nil)
       a,b,c = x, f()     -- f() is adjusted to 2
       a,b,c = f()        -- f() is adjusted to 3
       return f()         -- returns all values returned by f()
       return x,y,f()     -- returns a, b, and all values returned by f()
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">f（） -- 调整为 0 个结果
g（f（）， x） -- f（） 调整为 1 个结果
g（x， f（）） -- g 得到 x 加上 f（） 返回的所有值
a，b，c = f（）， x -- f（） 调整为 1 个结果（c 得到 nil）
a，b，c = x， f（） -- f（） 调整为 2
a，b，c = f（） -- f（） 调整为 3
return f（） -- 返回 f（） 返回的所有值
return x，y，f（） -- 返回 a、b 和 f（） 返回的所有值</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="func-def" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.5.9 - <a name="Function Definitions</H3>" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Function Definitions</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.5.9 - </font></font></font></h3> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The syntax for function definition is
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数定义的语法是</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</b> `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">(</b>' [parlist1] `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">)</b>' block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b>
       stat ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</b> funcname `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">(</b>' [parlist1] `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">)</b>' block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b>
       funcname ::= name | name `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">.</b>' name | name `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">:</b>' name
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">function ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</b> '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">（</b>' [parlist1] '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">）</b>' 块<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">结束</b>
stat ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</b> funcname '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">（</b>' [parlist1] '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">）</b>' 块<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">结束</b>
funcname ：：= 名称 |名称 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">.</b>' 名称 |名称 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">：</b>' 名称</font></font></font></pre>
The statement
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">声明</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function f () ... end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 f （） ...结束</font></font></font></pre>
is just syntactic sugar for
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">只是语法 sugar for</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       f = function () ... end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">f = 函数 （） ...结束</font></font></font></pre>
and the statement
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">和语句</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function v.f () ... end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 v.f （） ...结束</font></font></font></pre>
is syntactic sugar for
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">是语法糖</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       v.f = function () ... end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">v.f = 函数 （） ...结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
A function definition is an executable expression,
whose value has type <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</em>.
When Lua pre-compiles a chunk,
all its function bodies are pre-compiled too.
Then, whenever Lua executes the function definition,
its upvalues are fixed (see Section&nbsp;<a href="#upvalue" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.6</a>),
and the function is <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">instantiated</em> (or <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">closed</em>).
This function instance (or <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">closure</em>)
is the final value of the expression.
Different instances of the same function
may have different upvalues.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数定义是一个可执行表达式，其值具有 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</em> 类型。当 Lua 预编译一个 chunk 时，它的所有函数体也会被预编译。然后，每当 Lua 执行函数定义时，它的上行值是固定的（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#upvalue">4.6</a>），并且函数被<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">实例化</em>（或<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">关闭</em>）。此函数实例（或<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">闭包</em>）是表达式的最终值。同一函数的不同实例可能具有不同的 upvalue。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Parameters act as local variables,
initialized with the argument values:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">参数充当局部变量，使用参数值初始化：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       parlist1 ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">...</b>'
       parlist1 ::= name {`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' name} [`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">...</b>']
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">parlist1 ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">...</b>'
parlist1 ：：= name {'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' name} ['<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">'...</b>']</font></font></font></pre>
<a name="vararg" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>

When a function is called,
the list of <a name="arguments" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arguments</a> is adjusted to
the length of the list of parameters (see Section&nbsp;<a href="#adjust" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.3</a>),
unless the function is a <a name="vararg function" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">vararg function</em></a>,
which is
indicated by three dots (`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">...</code>') at the end of its parameter list.
A vararg function does not adjust its argument list;
instead, it collects all extra arguments into an implicit parameter,
called <a name="arg" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arg</tt></a>.
The value of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arg</code> is a table,
with a field&nbsp;<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> whose value is the number of extra arguments,
and the extra arguments at positions 1,&nbsp;2,&nbsp;...,&nbsp;<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">调用函数时，
<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="arguments">参数</a>列表调整为
参数列表的长度（参见 第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#adjust">4.3</a> 节），
除非该函数是 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="vararg function"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">vararg 函数</em></a>，否则
哪个是
由其参数列表末尾的三个点 （'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">...</code>'） 表示。
vararg 函数不会调整其参数列表;
相反，它将所有额外的参数收集到一个隐式参数
称为 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="arg"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arg</tt> </a>。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arg</code> 的值是一个表，
其中字段 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 的值是额外参数的数量，
以及位置 1、2、...、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 的额外参数。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
As an example, consider the following definitions:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">例如，请考虑以下定义：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function f(a, b) end
       function g(a, b, ...) end
       function r() return 1,2,3 end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 f（a， b） end
函数 g（a， b， ...） end
函数 r（） return 1,2,3 end</font></font></font></pre>
Then, we have the following mapping from arguments to parameters:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">然后，我们有以下从 arguments 到 parameters 的映射：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       CALL            PARAMETERS
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">调用参数</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       f(3)             a=3, b=nil
       f(3, 4)          a=3, b=4
       f(3, 4, 5)       a=3, b=4
       f(r(), 10)       a=1, b=10
       f(r())           a=1, b=2
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">f（3） a=3， b=nil f（3， 4） a=3， b=4 f（3， 4， 5） a=3， b=4 f（r（）， 10） a=1， b=10 f（r（）） a=1， b=2</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       g(3)             a=3, b=nil, arg={n=0}
       g(3, 4)          a=3, b=4, arg={n=0}
       g(3, 4, 5, 8)    a=3, b=4, arg={5, 8; n=2}
       g(5, r())        a=5, b=1, arg={2, 3; n=2}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">g（3） a=3， b=nil， arg={n=0} g（3， 4） a=3， b=4， arg={n=0} g（3， 4， 5， 8） a=3， b=4， arg={5， 8; n=2} g（5， r（）） a=5， b=1， arg={2， 3; n=2}</font></font></font></p></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Results are returned using the <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> statement (see Section&nbsp;<a href="#return" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.4.3</a>).
If control reaches the end of a function
without encountering a <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> statement,
then the function returns with no results.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> 语句返回结果（请参阅 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#return">4.4.3</a>）。如果 control 到达函数的末尾而没有遇到 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> 语句，则函数将返回，没有结果。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The syntax
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">语法</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       funcname ::= name `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">:</b>' name
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">funcname ：：= 名称 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">：</b>' 名称</font></font></font></pre>
is used for defining <a name="methods" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">methods</em></a>,
that is, functions that have an implicit extra parameter <a name="self" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">self</tt></a>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">用于定义<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="methods"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">方法</em></a>，
也就是说，具有隐式 extra parameter <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="self"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">self</tt> </a>的函数 。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The statement
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">声明</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function v:f (...) ... end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 v：f （...） ...结束</font></font></font></pre>
is just syntactic sugar for
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">只是语法 sugar for</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       v.f = function (self, ...) ... end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">v.f = 函数 （自我， ...） ...结束</font></font></font></pre>
Note that the function gets an extra formal parameter called <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">self</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">请注意，该函数会获得一个名为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">self</code> 的额外形式参数。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="upvalue" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="4.6" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.6 - Visibility and Upvalues<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.6 - 可见性和升值</font></font></font></h2> 
<a name="visibility" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="upvalues" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
A function body may refer to its own local variables
(which include its parameters) and to global variables,
as long as they are not <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">shadowed</em> by local
variables with the same name from enclosing functions.
A function <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">cannot</em> access a local
variable from an enclosing function,
since such variables may no longer exist when the function is called.
However, a function may access the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">value</em> of a local variable
from an enclosing function, using <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">upvalues</em>,
whose syntax is
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数体可以引用自己的局部变量（包括其参数）和全局变量，只要它们不被封闭函数中的同名局部变量<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">所遮蔽</em>。函数<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">无法</em>从封闭函数访问局部变量，因为在调用函数时，此类变量可能不再存在。但是，函数可以使用 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">upvalues</em> 从封闭函数访问局部变量<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">的值</em>，其语法为</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       upvalue ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%</b>' name
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">upvalue ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%</b>' 名称</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
An upvalue is somewhat similar to a variable expression,
but whose value is <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">frozen</em> when the function wherein it
appears is instantiated.
The name used in an upvalue may be the name of any variable visible
at the point where the function is defined,
that is,
global variables and local variables
from the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">immediately enclosing</em> function.
Note that when the upvalue is a table,
only the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">reference</em> to that table
(which is the value of the upvalue) is frozen;
the table contents can be changed at will.
Using table values as upvalues is a technique for having
writable but private state attached to functions.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">upvalue 有点类似于变量表达式，但在实例化它出现的函数时，其值被<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">冻结</em>。upvalue 中使用的名称可以是在定义函数的位置可见的任何变量的名称，即来自<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">立即封闭</em>函数的全局变量和局部变量。请注意，当 upvalue 是一个 table 时，只有对该 table 的<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">引用</em>（即 upvalue 的值）会被冻结;表格内容可以随意更改。使用表值作为 upvalues 是一种将可写但私有状态附加到函数的技术。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Here are some examples:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">以下是一些示例：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       a,b,c = 1,2,3   -- global variables
       local d
       function f (x)
         local b = {}  -- x and b are local to f; b shadows the global b
         local g = function (a)
           local y     -- a and y are local to g
           p = a       -- OK, access local `a'
           p = c       -- OK, access global `c'
           p = b       -- ERROR: cannot access a variable in outer scope
           p = %b      -- OK, access frozen value of `b' (local to `f')
           %b = 3      -- ERROR: cannot change an upvalue
           %b.x = 3    -- OK, change the table contents
           p = %c      -- OK, access frozen value of global `c'
           p = %y      -- ERROR: `y' is not visible where `g' is defined
           p = %d      -- ERROR: `d' is not visible where `g' is defined
         end           -- g
       end             -- f
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">a，b，c = 1,2,3 -- 全局变量
本地 D
函数 F （X）
local b = {} -- x 和 b 是 f 的本地值;b 隐藏全局 b
本地 G = 函数 （A）
本地 y -- a 和 y 是 g 的本地
p = a -- 正常，访问本地 'a'
p = c -- 好，访问全局 'c'
p = b -- 错误：无法访问外部范围内的变量
p = %b -- 正常，访问 'b' 的冻结值（'f' 的局部值）
%b = 3 -- 错误：无法更改 upvalue
%b.x = 3 -- 好的，更改表格内容
p = %c -- 正常，访问全局 'c' 的冻结值
p = %y -- 错误：在定义 'g' 的位置，'y' 不可见
p = %d -- 错误：在定义 'g' 的位置，'d' 不可见
结束 -- g
结束 -- F</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="error" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="4.7" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.7 - Error Handling<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.7 - 错误处理</font></font></font></h2> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Because Lua is an extension language,
all Lua actions start from C&nbsp;code in the host program
calling a function from the Lua library.
Whenever an error occurs during Lua compilation or execution,
the function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> is called <a name="_ERRORMESSAGE" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
(provided it is different from <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>),
and then the corresponding function from the library
(<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dofile</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dostring</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dobuffer</code>, or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_call</code>)
is terminated, returning an error condition.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">由于 Lua 是一种扩展语言，因此所有 Lua 操作都从主机程序中的 C 代码开始，调用 Lua 库中的函数。每当在 Lua 编译或执行期间发生错误时，都会调用函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code>（前提是它与 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 不同），然后终止库中的相应函数（<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dofile</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dostring</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dobuffer</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_call</code>），并返回错误条件。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Memory allocation errors are an exception to the previous rule.
When memory allocation fails, Lua may not be able to execute the
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> function.
So, for this kind of error, Lua does not call
the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> function;
instead, the corresponding function from the library
returns immediately with a special error code (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ERRMEM</code>).
This and other error codes are defined in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua.h</code>;
Section&nbsp;<a href="#luado" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">5.8</a>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">内存分配错误是前一条规则的例外。当内存分配失败时，Lua 可能无法执行 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> 函数。因此，对于这种错误，Lua 不会调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> 函数;相反，库中的相应函数会立即返回一个特殊的错误代码 （<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ERRMEM</code>）。此错误代码和其他错误代码在 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua.h</code> 中定义;第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#luado">5.8</a> 节.</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The only argument to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> is a string
describing the error.
The default definition for
this function calls <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ALERT</code>, <a name="_ALERT" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
which prints the message to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stderr</code> (see Section&nbsp;<a href="#alert" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>).
The standard I/O library redefines <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code>
and uses the debug facilities (see Section&nbsp;<a href="#debugI" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">7</a>)
to print some extra information,
such as a call stack traceback.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code>的唯一参数是描述错误的字符串。此函数的默认定义调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ALERT</code>，它将消息打印到 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stderr</code>（请参见第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#alert">6.1</a> 节）。标准 I/O 库重新定义了 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> 并使用调试工具（请参阅 第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#debugI">7</a> 节）来打印一些额外的信息，例如调用堆栈回溯。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua code can explicitly generate an error by calling the
function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">error</code> (see Section&nbsp;<a href="#pdf-error" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>).
Lua code can ``catch'' an error using the function
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">call</code> (see Section&nbsp;<a href="#pdf-call" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 代码可以通过调用函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">error</code> 显式生成错误（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#pdf-error">6.1</a>）。Lua 代码可以使用函数<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">调用</code>来 “捕获” 错误（参见 第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#pdf-call">6.1</a> 节）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="4.8" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">4.8 - Tag Methods<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">4.8 - 标记方法</font></font></font></h2> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua provides a powerful mechanism to extend its semantics,
called <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag methods</em>.
A tag method is a programmer-defined function
that is called at specific key points during the execution of a Lua program,
allowing the programmer to change the standard Lua behavior at these points.
Each of these points is called an <a name="event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">event</em></a>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 提供了一种强大的机制来扩展其语义，称为 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag methods</em>。标记方法是程序员定义的函数，在 Lua 程序执行期间的特定关键点调用，允许程序员在这些点更改标准 Lua 行为。这些点中的每一个都称为<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="event"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">一个事件</em></a>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The tag method called for any specific event is selected
according to the tag of the values involved
in the event (see Section&nbsp;<a href="#TypesSec" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">3</a>).
The function <a name="settagmethod" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settagmethod</tt></a> changes the tag method
associated with a given pair <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">(tag, event)</em>.
Its first parameter is the tag, the second parameter is the event name
(a string; see below),
and the third parameter is the new method (a function),
or <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> to restore the default behavior for the pair.
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settagmethod</code> function returns the previous tag method for that pair.
A companion function <a name="gettagmethod" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gettagmethod</tt></a>
receives a tag and an event name and returns the
current method associated with the pair.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">根据事件中涉及的值的 tag 来选择为任何特定事件调用的 tag 方法（请参阅 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#TypesSec">3</a>）。该函数<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="settagmethod"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settagmethod</tt> </a>更改与给定对 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">（tag， event）</em> 关联的 tag 方法。它的第一个参数是 tag，第二个参数是事件名称（字符串;见下文），第三个参数是新方法（函数）或 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>，用于恢复对的默认行为。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settagmethod</code> 函数返回该对的上一个 tag 方法。伴生函数<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="gettagmethod"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gettagmethod</tt> </a>接收标记和事件名称，并返回与该对关联的当前方法。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Tag methods are called in the following events,
identified by the given names.
The semantics of tag methods is better explained by a Lua function
describing the behavior of the interpreter at each event.
This function not only shows when a tag method is called,
but also its arguments, its results, and the default behavior.
The code shown here is only <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">illustrative</em>;
the real behavior is hard coded in the interpreter,
and it is much more efficient than this simulation.
All functions used in these descriptions
(<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawget</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tonumber</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">call</code>, etc.)
are described in Section&nbsp;<a href="#predefined" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在以下事件中调用标记方法，由给定名称标识。标记方法的语义可以通过描述解释器在每个事件中的行为的 Lua 函数来更好地解释。此函数不仅显示何时调用 tag 方法，还显示其参数、结果和默认行为。此处显示的代码仅用于<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">说明</em>;真实行为在 Interpreter 中是硬编码的，它比这种模拟效率高得多。这些描述中使用的所有函数（<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawget</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tonumber</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">call</code> 等）都在 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#predefined">6.1</a> 中描述。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><dl data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``add'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''add'' ：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="add event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called when a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">+</code> operation is applied to non-numerical operands.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">+</code> 操作应用于非数值操作数时调用。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getbinmethod</code> below defines how Lua chooses a tag method
for a binary operation.
First, Lua tries the first operand.
If its tag does not define a tag method for the operation,
then Lua tries the second operand.
If it also fails, then it gets a tag method from tag&nbsp;0.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">下面的函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getbinmethod</code> 定义了 Lua 如何为二进制操作选择标签方法。首先，Lua 尝试第一个操作数。如果其 tag 没有为操作定义 tag 方法，则 Lua 会尝试第二个操作数。如果它也失败，则它会从标签 0 获取 tag 方法。</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function getbinmethod (op1, op2, event)
         return gettagmethod(tag(op1), event) or
                gettagmethod(tag(op2), event) or
                gettagmethod(0, event)
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 getbinmethod （op1， op2， event）
return gettagmethod（tag（op1）， event） 或
gettagmethod（tag（op2）， event） 或
gettagmethod（0， 事件）
结束</font></font></font></pre>
Using this function,
the tag method for the ``add'' event is
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用此功能，
''add'' 事件的标记方法是</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function add_event (op1, op2)
         local o1, o2 = tonumber(op1), tonumber(op2)
         if o1 and o2 then  -- both operands are numeric
           return o1+o2  -- '+' here is the primitive 'add'
         else  -- at least one of the operands is not numeric
           local tm = getbinmethod(op1, op2, "add")
           if tm then
             -- call the method with both operands and an extra
             -- argument with the event name
             return tm(op1, op2, "add")
           else  -- no tag method available: default behavior
             error("unexpected type at arithmetic operation")
           end
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 add_event （OP1， OP2）
本地 O1， O2 = TOWid（OP1）， TOWonumber（OP2）
如果 o1 和 o2 则 -- 两个操作数都是数字
return o1+o2 -- '+' 这里是原语 'add'
else -- 至少有一个操作数不是数字
本地 tm = getBinMethod（op1， op2， “add”）
如果 tm 那么
-- 使用两个操作数和一个额外的
-- 参数与事件名称
返回 tm（op1， op2， “add”）
else -- 没有可用的标记方法：默认行为
error（“算术运算中的意外类型”）
结束
结束
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``sub'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''sub'' 中：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="sub event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called when a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code> operation is applied to non-numerical operands.
Behavior similar to the ``add'' event.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code> 操作应用于非数字操作数时调用。类似于 ''add'' 事件的行为。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``mul'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''mul'' （多）：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="mul event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called when a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</code> operation is applied to non-numerical operands.
Behavior similar to the ``add'' event.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</code> 操作应用于非数字操作数时调用。类似于 ''add'' 事件的行为。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``div'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''div'' 中：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="div event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called when a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">/</code> operation is applied to non-numerical operands.
Behavior similar to the ``add'' event.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">/</code> 操作应用于非数字操作数时调用。类似于 ''add'' 事件的行为。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``pow'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''pow'' （噗噗噗噗）：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="pow event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called when a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^</code> operation (exponentiation) is applied,
even for numerical operands.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在应用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^</code> 运算（幂）时调用，
即使对于数值操作数也是如此。</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function pow_event (op1, op2)
         local tm = getbinmethod(op1, op2, "pow")
         if tm then
           -- call the method with both operands and an extra
           -- argument with the event name
           return tm(op1, op2, "pow")
         else  -- no tag method available: default behavior
           error("unexpected type at arithmetic operation")
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 pow_event （OP1， OP2）
本地 tm = getBinMethod（op1， op2， “pow”）
如果 tm 那么
-- 使用两个操作数和一个额外的
-- 参数与事件名称
返回 tm（OP1， OP2， “POW”）
else -- 没有可用的标记方法：默认行为
error（“算术运算中的意外类型”）
结束
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``unm'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''UNM'' ：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="unm event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called when a unary <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code> operation is applied to a non-numerical operand.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 一元 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code> 运算应用于非数值操作数时调用。</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function unm_event (op)
         local o = tonumber(op)
         if o then  -- operand is numeric
           return -o  -- '-' here is the primitive 'unm'
         else  -- the operand is not numeric.
           -- Try to get a tag method from the operand;
           --  if it does not have one, try a "global" one (tag 0)
           local tm = gettagmethod(tag(op), "unm") or
                      gettagmethod(0, "unm")
           if tm then
             -- call the method with the operand, nil, and an extra
             -- argument with the event name
             return tm(op, nil, "unm")
           else  -- no tag method available: default behavior
             error("unexpected type at arithmetic operation")
           end
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 unm_event （OP）
本地 o = toNumber（OP）
if o then -- 操作数为数值
return -o -- '-' 这里是原始的 'unm'
else -- 操作数不是数字。
-- 尝试从操作数中获取 tag 方法;
-- 如果没有，请尝试 “global” 的 （tag 0）
local tm = gettagmethod（tag（op）， “unm”） 或
gettagmethod（0， “UNM”）
如果 tm 那么
-- 使用操作数 nil 和额外的
-- 参数与事件名称
返回 tm（op， nil， “unm”）
else -- 没有可用的标记方法：默认行为
error（“算术运算中的意外类型”）
结束
结束
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``lt'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''lt'' ：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="lt event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called when an order operation is applied to non-numerical
or non-string operands.
It corresponds to the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&lt;</code> operator.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 Order 操作应用于非数值型
或非字符串操作数。
它对应于 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&lt;</code> 运算符。</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function lt_event (op1, op2)
         if type(op1) == "number" and type(op2) == "number" then
           return op1 &lt; op2   -- numeric comparison
         elseif type(op1) == "string" and type(op2) == "string" then
           return op1 &lt; op2   -- lexicographic comparison
         else
           local tm = getbinmethod(op1, op2, "lt")
           if tm then
             return tm(op1, op2, "lt")
           else
             error("unexpected type at comparison");
           end
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 lt_event （OP1， OP2）
如果 type（op1） == “number” 且 type（op2） == “number” 那么
return op1 &lt; op2 -- 数值比较
elseif type（op1） == “string” 和 type（op2） == “string” 那么
return op1 &lt; op2 -- 字典比较
还
本地 tm = getBinMethod（op1， op2， “lt”）
如果 tm 那么
返回 tm（op1， op2， “lt”）
还
error（“比较时意外的类型”）;
结束
结束
结束</font></font></font></pre>
The other order operators use this tag method according to the
usual equivalences:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">其他 order 运算符根据
通常的等价物：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       a&gt;b    &lt;=&gt;  b&lt;a
       a&lt;=b   &lt;=&gt;  not (b&lt;a)
       a&gt;=b   &lt;=&gt;  not (a&lt;b)
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">a&gt;b &lt;=&gt; b&lt;a
a&lt;=b &lt;=&gt; 不是 （b&lt;a）
a&gt;=b &lt;=&gt; 不是 （a&lt;b）</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``concat'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''concat'' 中：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="concatenation event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called when a concatenation is applied to non-string operands.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当串联应用于非字符串操作数时调用。</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function concat_event (op1, op2)
         if (type(op1) == "string" or type(op1) == "number") and
            (type(op2) == "string" or type(op2) == "number") then
           return op1..op2  -- primitive string concatenation
         else
           local tm = getbinmethod(op1, op2, "concat")
           if tm then
             return tm(op1, op2, "concat")
           else
             error("unexpected type for concatenation")
           end
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 concat_event （OP1， OP2）
if （type（op1） == “string” or type（op1） == “number”） 和
（type（op2） == “string” or type（op2） == “number”） 那么
返回 op1..op2 -- 原始字符串连接
还
本地 tm = getBinMethod（op1， op2， “concat”）
如果 tm 那么
返回 tm（op1， op2， “concat”）
还
error（“连接的意外类型”）
结束
结束
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``index'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''index'' ：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="index event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called when Lua tries to retrieve the value of an index
not present in a table.
See the ``gettable'' event for its semantics.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 Lua 尝试检索表中不存在的索引的值时调用。参见 ''gettable'' 事件了解它的语义。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``getglobal'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''getglobal'' 中：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="getglobal event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called whenever Lua needs the value of a global variable.
This method can only be set for <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> and for tags
created by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">newtag</code>.
Note that
the tag is that of the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">current value</em> of the global variable.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">每当 Lua 需要全局变量的值时调用。
此方法只能为 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 和 tag 设置
由 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NewTag</code> 创建。
请注意，
该标签是全局变量<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">的当前值的</em>标签。</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function getglobal (varname)
         -- access the table of globals
         local value = rawget(globals(), varname)
         local tm = gettagmethod(tag(value), "getglobal")
         if not tm then
           return value
         else
           return tm(varname, value)
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 getGlobal （varname）
-- 访问 globals 表
本地值 = rawget（globals（）， varname）
本地 tm = gettagmethod（tag（value）， “getglobal”）
如果不是 tm 那么
返回值
还
返回 tm（varname， value）
结束
结束</font></font></font></pre>
The function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getglobal</code> is defined in the basic library&nbsp;(see Section&nbsp;<a href="#predefined" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getglobal</code> 在 basic 库中定义（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#predefined">6.1</a>）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``setglobal'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''setglobal'' 中：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="setglobal event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called whenever Lua assigns to a global variable.
This method cannot be set for numbers, strings, and tables and
userdata with the default tag.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">每当 Lua 分配给全局变量时调用。
数字、字符串和表格不能设置此方法，并且
userdata 替换为 default 标签。</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function setglobal (varname, newvalue)
         local oldvalue = rawget(globals(), varname)
         local tm = gettagmethod(tag(oldvalue), "setglobal")
         if not tm then
           rawset(globals(), varname, newvalue)
         else
           tm(varname, oldvalue, newvalue)
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 setglobal （varname， newvalue）
本地 oldValue = rawget（globals（）， varname）
本地 tm = gettagmethod（tag（oldvalue）， “setglobal”）
如果不是 tm 那么
rawset（globals（）， varname， newvalue）
还
tm（varname， oldvalue， newvalue）
比
比</font></font></font></pre>
The function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setglobal</code> is defined in the basic library&nbsp;(see Section&nbsp;<a href="#predefined" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setglobal</code> 在 basic 库中定义（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#predefined">6.1</a>）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``gettable'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''gettable'' 中：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="gettable event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called whenever Lua accesses an indexed variable.
This method cannot be set for tables with the default tag.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">每当 Lua 访问索引变量时调用。
带有 default 标签的表不能设置此方法。</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function gettable_event (table, index)
         local tm = gettagmethod(tag(table), "gettable")
         if tm then
           return tm(table, index)
         elseif type(table) ~= "table" then
           error("indexed expression not a table");
         else
           local v = rawget(table, index)
           tm = gettagmethod(tag(table), "index")
           if v == nil and tm then
             return tm(table, index)
           else
             return v
           end
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 gettable_event （表、索引）
本地 tm = gettagmethod（tag（table）， “gettable”）
如果 tm 那么
返回 tm（表，索引）
elseif type（table） ~= “table” then
error（“索引表达式不是表”）;
还
本地 v = rawget（表，索引）
tm = gettagmethod（标签（表）， “索引”）
如果 v == nil 和 tm 则
返回 tm（表，索引）
还
返回 v
结束
结束
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``settable'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''settable'' 中：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="settable event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called when Lua assigns to an indexed variable.
This method cannot be set for tables with the default tag.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 Lua 分配给索引变量时调用。
带有 default 标签的表不能设置此方法。</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function settable_event (table, index, value)
         local tm = gettagmethod(tag(table), "settable")
         if tm then
           tm(table, index, value)
         elseif type(table) ~= "table" then
           error("indexed expression not a table")
         else
           rawset(table, index, value)
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 settable_event （表、索引、值）
本地 tm = gettagmethod（tag（table）， “settable”）
如果 tm 那么
tm（表、索引、值）
elseif type（table） ~= “table” then
error（“索引表达式不是表”）
还
rawset（表、索引、值）
结束
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``function'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''function'' 中：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="function event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called when Lua tries to call a non-function value.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 Lua 尝试调用非函数值时调用。</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function function_event (func, ...)
         if type(func) == "function" then
           return call(func, arg)
         else
           local tm = gettagmethod(tag(func), "function")
           if tm then
             for i=arg.n,1,-1 do
               arg[i+1] = arg[i]
             end
             arg.n = arg.n+1
             arg[1] = func
             return call(tm, arg)
           else
             error("call expression not a function")
           end
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 function_event （func， ...）
如果 type（func） == “function” 那么
返回调用（func， arg）
还
本地 tm = gettagmethod（tag（func）， “function”）
如果 tm 那么
对于 i=arg.n，1，-1 do
arg[i+1] = arg[i]
结束
arg.n = arg.n+1
arg[1] = 函数
返回调用 （tm， arg）
还
error（“call expression not a function”）
结束
结束
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``gc'':<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''gc'' ：</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="gc event" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
called when Lua is ``garbage collecting'' a userdata.
This tag method can be set only from&nbsp;C,
and cannot be set for a userdata with the default tag.
For each userdata to be collected,
Lua does the equivalent of the following function:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 Lua 正在 “垃圾回收” userdata 时调用。
此标记方法只能从 C 设置，
，并且不能为具有 default 标签的 userdata 设置。
对于每个需要收集的用户数据，
Lua 相当于以下功能：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function gc_event (obj)
         local tm = gettagmethod(tag(obj), "gc")
         if tm then
           tm(obj)
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 gc_event （OBJ）
本地 tm = gettagmethod（tag（obj）， “gc”）
如果 tm 那么
TM（物镜）
结束
结束</font></font></font></pre>
In a garbage-collection cycle,
the tag methods for userdata are called in <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">reverse</em> order of tag creation,
that is, the first tag methods to be called are those associated
with the last tag created in the program.
Moreover, at the end of the cycle,
Lua does the equivalent of the call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gc_event(nil)</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在垃圾回收周期中，
UserData 的 tag 方法的调用顺序与标签创建<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">的顺序相反</em>。
也就是说，要调用的第一个标记方法是那些关联的
替换为在程序中创建的最后一个标记。
此外，在周期结束时，
Lua 执行等效的调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gc_event（nil）。</code></font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd></dl>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<!-- ====================================================================== -->
</p><hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="5." data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<h1 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5 - The Application Program Interface<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5 - 应用程序界面</font></font></font></h1>
<a name="C API" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
This section describes the API for Lua, that is,
the set of C&nbsp;functions available to the host program to communicate
with Lua.
All API functions and related types and constants
are declared in the header file <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua.h</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">本节介绍 Lua 的 API，即
主机程序可用于通信的 C 函数集
与 Lua 一起。
所有 API 函数和相关类型和常量
在头文件 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua.h</code> 中声明。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Even when we use the term ``function'',
any facility in the API may be provided as a <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">macro</em> instead.
All such macros use each of its arguments exactly once,
and so do not generate hidden side-effects.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">即使我们使用术语 ''function'' ，API 中的任何工具也可以作为<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">宏</em>提供。所有这些宏都只使用一次其每个参数，因此不会产生隐藏的副作用。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="mangstate" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="5.1" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.1 - States<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.1 - 状态</font></font></font></h2> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The Lua library is fully reentrant:
it does not have any global variables.
<a name="state" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
The whole state of the Lua interpreter
(global variables, stack, tag methods, etc.)
is stored in a dynamically allocated structure of type <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_State</code>; <a name="lua_State" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
this state must be passed as the first argument to
every function in the library (except <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_open</code> below).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 库是完全可重入的：它没有任何全局变量。 Lua 解释器的整个状态（全局变量、堆栈、标签方法等）存储在 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_State</code> 类型的动态分配结构中; 此状态必须作为第一个参数传递给库中的每个函数（下面的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_open</code> 除外）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Before calling any API function,
you must create a state by calling
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在调用任何 API 函数之前，您必须通过调用</font></font></font><a name="lua_open" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       lua_State *lua_open (int stacksize);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">lua_State *lua_open （int stacksize）;</font></font></font></pre>
The sole argument to this function is the stack size for the interpreter.
(Each function call needs one stack position for each argument, local variable,
and temporary value, plus one position for book-keeping.
The stack must also have some 20 extra positions available.
For very small implementations, without recursive functions,
a stack size of&nbsp;100 should be enough.)
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stacksize</code> is zero,
then a default size of&nbsp;1024 is used.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数的唯一参数是解释器的堆栈大小。
（每个函数调用需要每个参数的一个堆栈位置、局部变量、
和 temporary value，外加一个用于记账的位置。
堆栈还必须有大约 20 个额外的可用位置。
对于非常小的实现，没有递归函数，
100 的堆栈大小应该就足够了。
如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stacksize</code> 为零，则
则使用默认大小 1024。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
To release a state created with <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_open</code>, call
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要释放使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_open</code> 创建的状态，请调用</font></font></font><a name="lua_close" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_close (lua_State *L);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效lua_close （lua_State *L）;</font></font></font></pre>
This function destroys all objects in the given Lua environment
(calling the corresponding garbage-collection tag methods, if any)
and frees all dynamic memory used by that state.
Usually, you do not need to call this function,
because all resources are naturally released when your program ends.
On the other hand,
long-running programs -
like a daemon or a web server -
might need to release states as soon as they are not needed,
to avoid growing too big.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数会销毁给定 Lua 环境中的所有对象
（调用对应的 garbage-collection 标签方法，如果有）
并释放该状态使用的所有动态内存。
通常，您不需要调用此函数，
因为所有资源都是在你的程序结束时自然释放的。
另一方面
长时间运行的程序 -
就像守护进程或 Web 服务器一样 -
可能需要在不需要 state 时立即释放它们，
以避免长得太大。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
With the exception of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_open</code>,
all functions in the Lua API need a state as their first argument.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">除了 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_open</code> 之外，Lua API 中的所有函数都需要一个状态作为其第一个参数。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="5.2" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.2 - The Stack and Indices<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.2 - 堆栈和索引</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua uses a <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stack</em> to pass values to and from C.
Each element in this stack represents a Lua value
(nil, number, string, etc.).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 使用<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">堆栈</em>将值传递到 C 和从 C 传递值。此堆栈中的每个元素都表示一个 Lua 值（nil、number、string 等）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
For convenience,
most query operations in the API do not follow a strict stack discipline.
Instead, they can refer to any element in the stack by using an <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</em>:
A positive index represents an <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">absolute</em> stack position
(starting at&nbsp;1, not 0 as in C);
a negative index represents an <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">offset</em> from the top of the stack.
More specifically, if the stack has <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> elements,
index&nbsp;1 represents the first element
(that is, the first element pushed onto the stack),
and
index&nbsp;<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> represents the last element;
index&nbsp;<i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-1</i> also represents the last element
(that is, the element at the top),
and index <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-n</i> represents the first element.
We say that an index is <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">valid</em>
if it lays between&nbsp;1 and the stack top
(that is, if <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">1 &lt;= abs(index) &lt;= top</code>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">为方便起见，API 中的大多数查询操作都不遵循严格的堆栈规则。相反，它们可以使用<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">索引</em>来引用堆栈中的任何元素：正索引表示<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">绝对</em>堆栈位置（从 1 开始，而不是 C 中的 0）;负索引表示与堆栈顶部的<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">偏移</em>量。更具体地说，如果堆栈有 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> 个元素，则索引 1 表示第一个元素（即推送到堆栈上的第一个元素），索引 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> 表示最后一个元素;索引 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-1</i> 还表示最后一个元素（即顶部的元素），索引 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-n</i> 表示第一个元素。如果索引位于 1 和堆栈顶部之间（即，如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">1 &lt;= abs（index） &lt;= top</code>），则表示该索引<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">有效</em>。</font></font></font><a name="stack index" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a> <a name="valid index" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
At any time, you can get the index of the top element by calling
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在任何时候，您都可以通过调用</font></font></font><a name="lua_gettop" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int lua_gettop (lua_State *L);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_gettop （lua_State *L）;</font></font></font></pre>
Because indices start at&nbsp;1,
the result of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_gettop</code> is equal to the number of elements in the stack
(and so 0&nbsp;means an empty stack).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">因为索引从 1 开始， 所以
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_gettop</code> 的结果等于堆栈中的元素数
（因此 0 表示空堆栈）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
When you interact with Lua API,
<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">you are responsible for controlling stack overflow</em>.
The function <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当您与 Lua API 交互时，<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">您负责控制堆栈溢出</em>。函数</font></font></font><a name="lua_stackspace" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int lua_stackspace (lua_State *L);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_stackspace （lua_State *L）;</font></font></font></pre>
returns the number of stack positions still available.
Whenever Lua calls C, <a name="LUA_MINSTACK" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
it ensures that
at least <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_MINSTACK</code> positions are still available.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_MINSTACK</code> is defined in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua.h</code> and is at least&nbsp;16,
and so you have to worry about stack space only
when your code has loops pushing elements onto the stack.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回仍可用的堆栈位置数。
每当 Lua 调用 C 时，
它确保
至少有 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_MINSTACK</code> 个职位仍然可用。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_MINSTACK</code> 在 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua.h</code> 中定义，至少为 16，
因此，您只需担心堆栈空间
当你的代码具有将元素推送到堆栈上的循环时。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Most query functions accept as indices any value inside the
available stack space.
Such indices are called <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">acceptable indices</em>.
More formally, we can define an <a name="acceptable index" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">acceptable index</em></a>
as
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">大多数查询函数接受可用堆栈空间内的任何值作为索引。此类指数称为<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">可接受指数</em>。更正式地说，我们可以将<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="acceptable index"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">可接受的索引</em></a>定义为</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">     (index &lt; 0 &amp;&amp; abs(index) &lt;= top) || (index &gt; 0 &amp;&amp; index &lt;= top + stackspace)
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">（索引 &lt; 0 &amp;&amp; abs（索引） &lt;= 顶部） ||（索引 &gt; 0 &amp;&amp; 索引 &lt;= 顶部 + 堆栈空间）</font></font></font></pre>
Note that 0 is not an acceptable index.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">请注意，0 不是可接受的索引。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="5.3" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.3 - Stack Manipulation<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.3 - 堆栈操作</font></font></font></h2>
The API offers the following functions for basic stack manipulation:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">API 为基本堆栈操作提供以下函数：</font></font></font><a name="lua_settop" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_pushvalue" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_remove" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_insert" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_settop    (lua_State *L, int index);
       void lua_pushvalue (lua_State *L, int index);
       void lua_remove    (lua_State *L, int index);
       void lua_insert    (lua_State *L, int index);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">void lua_settop （lua_State *L， int index）;
void lua_pushvalue （lua_State *L， int index）;
void lua_remove （lua_State *L， int index）;
void lua_insert （lua_State *L， int index）;</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_settop</code> accepts any acceptable index,
or 0,
and sets the stack top to that index.
If the new top is larger than the old one,
then the new elements are filled with <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> is 0, then all stack elements are removed.
A useful macro defined in the API is
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_settop</code>接受任何可接受的索引或 0，并将堆栈顶部设置为该索引。如果新顶部大于旧顶部，则新元素将填充 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> 为 0，则删除所有堆栈元素。API 中定义的一个有用的宏是</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       #define lua_pop(L,n) lua_settop(L, -(n)-1)
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">#define lua_pop（L，n） lua_settop（L， -（n）-1）</font></font></font></pre>
which pops <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> elements from the stack.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">它从堆栈中弹出 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 个元素。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushvalue</code> pushes onto the stack a <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">copy</em> of the element
at the given index.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_remove</code> removes the element at the given position,
shifting down the elements on top of that position to fill in the gap.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_insert</code> moves the top element into the given position,
shifting up the elements on top of that position to open space.
These functions accept only valid indices.
As an example, if the stack starts as <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">10 20 30 40 50</code>
(from bottom to top),
then
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushvalue</code> 将给定索引处的元素<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">副本</em>推送到堆栈上。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_remove</code> 删除给定位置的元素，向下移动该位置顶部的元素以填充间隙。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_insert</code>将顶部元素移动到给定位置，并将该位置顶部的元素向上移动以打开空间。这些函数只接受有效的索引。例如，如果堆栈从 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">10 20 30 40 50</code>（从下到上）开始，则</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       lua_pushvalue(L, 3)    --&gt; 10 20 30 40 50 30
       lua_pushvalue(L, -1)   --&gt; 10 20 30 40 50 30 30
       lua_remove(L, -3)      --&gt; 10 20 30 40 30 30
       lua_remove(L,  6)      --&gt; 10 20 30 40 30
       lua_insert(L,  1)      --&gt; 30 10 20 30 40
       lua_insert(L, -1)      --&gt; 30 10 20 30 40  (no effect)
       lua_settop(L, -3)      --&gt; 30 10 20
       lua_settop(L, 6)       --&gt; 30 10 20 nil nil nil
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">lua_pushvalue（L， 3） --&gt; 10 20 30 40 50 30
       lua_pushvalue（L， -1） --&gt; 10 20 30 40 50 30 30
       lua_remove（L， -3） --&gt; 10 20 30 40 30 30
       lua_remove（L， 6） --&gt; 10 20 30 40 30
       lua_insert（L， 1） --&gt; 30 10 20 30 40
       lua_insert（L， -1） --&gt; 30 10 20 30 40 （无效果）
       lua_settop（L， -3） --&gt; 30 10 20
       lua_settop（L， 6） --&gt; 30 10 20 nil nil nil</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="5.4" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.4 - Querying the Stack<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.4 - 查询堆栈</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
To check the type of a stack element,
the following functions are available:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要检查堆栈元素的类型，可以使用以下函数：</font></font></font><a name="lua_type" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_tag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_isnil" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_isnumber" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_isstring" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_istable" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_isfunction" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_iscfunction" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_isuserdata" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int         lua_type        (lua_State *L, int index);
       int         lua_tag         (lua_State *L, int index);
       int         lua_isnil       (lua_State *L, int index);
       int         lua_isnumber    (lua_State *L, int index);
       int         lua_isstring    (lua_State *L, int index);
       int         lua_istable     (lua_State *L, int index);
       int         lua_isfunction  (lua_State *L, int index);
       int         lua_iscfunction (lua_State *L, int index);
       int         lua_isuserdata  (lua_State *L, int index);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_type （lua_State *L， int index）;
int lua_tag （lua_State *L， int index）;
int lua_isnil （lua_State *L， int index）;
int lua_isnumber （lua_State *L， int index）;
int lua_isstring （lua_State *L， int index）;
int lua_istable （lua_State *L， int index）;
int lua_isfunction （lua_State *L， int index）;
int lua_iscfunction （lua_State *L， int index）;
int lua_isuserdata （lua_State *L， int index）;</font></font></font></pre>
These functions can be called with any acceptable index.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">可以使用任何可接受的索引调用这些函数。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_type</code> returns one of the following constants,
according to the type of the given object:
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TNIL</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TNUMBER</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TSTRING</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TTABLE</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TFUNCTION</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TUSERDATA</code>.
If the index is non-valid
(that is, if that stack position is ``empty''),
then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_type</code> returns <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TNONE</code>.
These constants can be converted to strings with
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_type</code> 根据给定对象的类型返回以下常量之一：<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TNIL</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TNUMBER</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TSTRING</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TTABLE</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TFUNCTION</code> <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TUSERDATA</code>。如果索引无效（即，如果该堆栈位置为 ''empty''），则 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_type</code> 返回 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_TNONE</code>。这些常量可以转换为字符串</font></font></font><a name="lua_typename" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       const char *lua_typename (lua_State *L, int t);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">const char *lua_typename （lua_State *L， int t）;</font></font></font></pre>
where <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t</code> is a type returned by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_type</code>.
The strings returned by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_typename</code> are
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"nil"</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"number"</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"string"</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"table"</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"function"</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"userdata"</code>, and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"no value"</code>,
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">其中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t</code> 是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_type</code> 返回的类型。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_typename</code> 返回的字符串是
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“nil”</code>， <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“number”</code>， <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“string”</code>， <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“table”</code>，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“function”、“</code><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">userdata”</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“no value”</code>、</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tag</code> returns the tag of a value,
or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_NOTAG</code> for a non-valid index.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tag</code> 返回值的标签，或非有效索引的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_NOTAG</code>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_is*</code> functions return&nbsp;1 if the object is compatible
with the given type, and 0 otherwise.
They always return 0 for a non-valid index.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_isnumber</code> accepts numbers and numerical strings,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_isstring</code> accepts strings and numbers (see Section&nbsp;<a href="#coercion" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.2</a>),
and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_isfunction</code> accepts both Lua functions and C&nbsp;functions.
To distinguish between Lua functions and C&nbsp;functions,
you should use <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_iscfunction</code>.
To distinguish between numbers and numerical strings,
you can use <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_type</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果对象与给定类型兼容，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">则 lua_is*</code> 函数返回 1，否则返回 0。对于无效索引，它们始终返回 0。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_isnumber</code> 接受数字和数字字符串，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_isstring</code> 接受字符串和数字（参见 第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#coercion">4.2</a> 节），<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_isfunction</code> 接受 Lua 函数和 C 函数。要区分 Lua 函数和 C 函数，您应该使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_iscfunction</code>。要区分数字和数字字符串，可以使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_type</code>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The API also has functions to compare two values in the stack:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">该 API 还具有用于比较堆栈中两个值的函数：</font></font></font><a name="lua_equal" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_lessthan" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int lua_equal    (lua_State *L, int index1, int index2);
       int lua_lessthan (lua_State *L, int index1, int index2);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_equal （lua_State *L， int index1， int index2）;
int lua_lessthan （lua_State *L， int index1， int index2）;</font></font></font></pre>
These functions are equivalent to their counterparts in Lua.
Specifically, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_lessthan</code> is equivalent to the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lt_event</code>
described in Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>.
Both functions return 0 if any of the indices are non-valid.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这些函数等同于 Lua 中的对应函数。
具体来说，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_lessthan</code> 等同于<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lt_event</code>
在 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">Section 4.8</a> 中描述。
如果任何索引无效，则两个函数都返回 0。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
To translate a value in the stack to a specific C&nbsp;type,
you can use the following conversion functions:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要将堆栈中的值转换为特定的 C 类型，您可以使用以下转换函数：</font></font></font><a name="lua_tonumber" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_tostring" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_strlen" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_tocfunction" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_touserdata" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       double         lua_tonumber    (lua_State *L, int index);
       const char    *lua_tostring    (lua_State *L, int index);
       size_t         lua_strlen      (lua_State *L, int index);
       lua_CFunction  lua_tocfunction (lua_State *L, int index);
       void          *lua_touserdata  (lua_State *L, int index);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">双lua_tonumber （lua_State *L， int index）;
const char *lua_tostring （lua_State *L， int index）;
size_t lua_strlen （lua_State *L， int index）;
lua_CFunction lua_tocfunction （lua_State *L， int index）;
void *lua_touserdata （lua_State *L， int index）;</font></font></font></pre>
These functions can be called with any acceptable index.
When called with a non-valid index,
they act as if the given value had an incorrect type.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">可以使用任何可接受的索引调用这些函数。
当使用无效索引调用时，
它们的行为就像给定值的类型不正确一样。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tonumber</code> converts the value at the given index
to a floating-point number.
This value must be a number or a string convertible to number
(see Section&nbsp;<a href="#coercion" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.2</a>); otherwise, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tonumber</code> returns&nbsp;0.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tonumber</code> 将给定索引处的值转换为浮点数。此值必须是数字或可转换为 number 的字符串（请参阅 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#coercion">4.2</a>）;否则，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tonumber</code> 返回 0。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tostring</code> converts a Lua value to a string
(<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">const char*</code>).
This value must be a string or a number;
otherwise, the function returns <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL</code>.
This function returns a pointer to a string inside the Lua environment.
Those strings always have a zero (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">'\0'</code>) after their last character (as in C),
but may contain other zeros in their body.
If you do not know whether a string may contain zeros,
you should use <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_strlen</code> to get its actual length.
Because Lua has garbage collection,
there is no guarantee that the pointer returned by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tostring</code>
will be valid after the respective value is removed from the stack.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tostring</code> Lua 值转换为字符串 （<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">const char*</code>）。此值必须是字符串或数字;否则，该函数返回 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL。</code>此函数返回指向 Lua 环境中的字符串的指针。这些字符串在其最后一个字符后始终有一个零 （<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">'\0'</code>） （如 C），但其正文中可能包含其他零。如果您不知道字符串是否可以包含零，则应使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_strlen</code> 来获取其实际长度。由于 Lua 具有垃圾回收功能，因此无法保证 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tostring</code> 返回的指针在从堆栈中删除相应值后仍然有效。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tocfunction</code> converts a value in the stack to a C&nbsp;function.
This value must be a C&nbsp;function;
otherwise, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tocfunction</code> returns <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL</code>.
The type <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_CFunction</code> is explained in Section&nbsp;<a href="#LuacallC" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">5.13</a>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tocfunction</code> 将堆栈中的值转换为 C 函数。此值必须是 C 函数;否则，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_tocfunction</code> 返回 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL。</code>类型 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_CFunction</code> 在 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#LuacallC">5.13</a> 中进行了解释。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_touserdata</code> converts a value to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">void*</code>.
This value must have type <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">userdata</em>;
otherwise, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_touserdata</code> returns <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_touserdata</code> 将值转换为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">void*</code>。此值必须具有 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">userdata</em> 类型;否则，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_touserdata</code> 返回 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL。</code></font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="5.5" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.5 - Pushing values onto the Stack<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.5 - 将值推送到堆栈上</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The API has the following functions to
push C&nbsp;values onto the stack:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">该 API 具有以下函数，用于将 C 值推送到堆栈上：</font></font></font><a name="lua_pushnumber" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_pushlstring" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_pushstring" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_pushcfunction" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_pushusertag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="pushing" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_pushnil" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_pushuserdata" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_pushnumber    (lua_State *L, double n);
       void lua_pushlstring   (lua_State *L, const char *s, size_t len);
       void lua_pushstring    (lua_State *L, const char *s);
       void lua_pushusertag   (lua_State *L, void *u, int tag);
       void lua_pushnil       (lua_State *L);
       void lua_pushcfunction (lua_State *L, lua_CFunction f);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_pushnumber （lua_State *L， double n）;
无效 lua_pushlstring （lua_State *L， const char *s， size_t len）;
无效 lua_pushstring （lua_State *L， const char *s）;
void lua_pushusertag （lua_State *L， void *u， int 标签）;
无效lua_pushnil （lua_State *L）;
无效lua_pushcfunction （lua_State *L， lua_CFunction f）;</font></font></font></pre>
These functions receive a C&nbsp;value,
convert it to a corresponding Lua value,
and push the result onto the stack.
In particular, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushlstring</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushstring</code>
make an <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">internal copy</em> of the given string.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushstring</code> can only be used to push proper C&nbsp;strings
(that is, strings that end with a zero and do not contain embedded zeros);
otherwise you should use the more general <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushlstring</code>,
which accepts an explicit size.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这些函数接收一个 C 值
将其转换为相应的 Lua 值，
并将结果推送到堆栈上。
特别是<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushlstring</code>和<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushstring</code>
制作给定字符串的内部<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">副本</em>。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushstring</code> 只能用于推送正确的 C 字符串
（即，以 0 结尾且不包含嵌入的 0 的字符串）;
否则，您应该使用更通用的<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushlstring</code>
它接受显式大小。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="GC" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="5.6" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.6 - Garbage Collection<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.6 - 垃圾回收</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua uses two numbers to control its garbage collection.
One number counts how many bytes of dynamic memory Lua is using,
and the other is a threshold.
(This internal byte counter kept by Lua is not completely acurate;
it is just a lower bound, usually within&nbsp;10% of the correct value.)
When the number of bytes crosses the threshold,
Lua runs a garbage-collection cycle,
which reclaims the memory of all ``dead'' objects
(that is, objects no longer accessible from Lua).
The byte counter is corrected,
and then the threshold is reset to twice the value of the byte counter.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 使用两个数字来控制其垃圾回收。一个数字计算 Lua 正在使用多少字节的动态内存，另一个数字是阈值。（Lua 保存的这个内部字节计数器并不完全准确;它只是一个下限，通常在正确值的 10% 以内。当字节数超过阈值时，Lua 会运行一个垃圾回收周期，回收所有 ''dead'' 对象的内存（即，无法再从 Lua 访问的对象）。更正字节计数器，然后将阈值重置为字节计数器值的两倍。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
You can access the current values of these two numbers through the
following functions:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">您可以通过以下函数访问这两个数字的当前值：</font></font></font><a name="lua_getgcthreshold" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a> <a name="lua_getgccount" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int  lua_getgccount (lua_State *L);
       int  lua_getgcthreshold (lua_State *L);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_getgccount （lua_State *L）;
int lua_getgcthreshold （lua_State *L）;</font></font></font></pre>
Both return their respective values in Kbytes.
You can change the threshold value with
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">两者都返回各自的值（以 KB 为单位）。
您可以使用</font></font></font><a name="lua_setgcthreshold" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void  lua_setgcthreshold (lua_State *L, int newthreshold);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_setgcthreshold （lua_State *L， int newthreshold）;</font></font></font></pre>
Again, the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">newthreshold</code> value is given in Kbytes.
When you call this function,
Lua sets the new threshold and checks it against the byte counter.
If the new threshold is smaller than the byte counter,
then Lua immediately runs the garbage collector;
after the collection, 
a new threshold is set according to the previous rule.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">同样，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">newthreshold</code> 值以 KB 为单位。
调用此函数时，
Lua 设置新的阈值并根据字节计数器对其进行检查。
如果新阈值小于字节计数器，
然后 Lua 立即运行垃圾回收器;
收集后，
根据前面的规则设置新的阈值。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
If you want to change the adaptative behavior of the garbage collector,
you can use the garbage-collection tag method for <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 
to set your own threshold
(the tag method is called after Lua resets the threshold).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果要改变垃圾回收器的自适应行为，可以使用 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 的 garbage-collection 标签方法来设置自己的阈值（tag 方法在 Lua 重置阈值后调用）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="C-tags" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="5.7" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.7 - Userdata and Tags<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.7 - 用户数据和标签</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Because userdata are objects,
the function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushusertag</code> may create a new userdata.
If Lua has a userdata with the given value (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">void*</code>) and tag,
then that userdata is pushed.
Otherwise, a new userdata is created, with the given value and tag.
If this function is called with
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag</code> equal to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ANYTAG</code><a name="LUA_ANYTAG" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>,
then Lua will try to find any userdata with the given value,
regardless of its tag.
If there is no userdata with that value, then a new one is created,
with tag equal to 0.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">由于 userdata 是对象，因此函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushusertag</code> 可能会创建新的 userdata。如果 Lua 具有具有给定值 （<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">void*</code>） 和 tag 的 userdata，则会推送该 userdata。否则，将创建一个新的 userdata，其中包含给定的值和标签。如果调用此函数时 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag</code> 等于 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ANYTAG</code>，则 Lua 将尝试查找具有给定值的任何 userdata，而不管其 tag 如何。如果没有具有该值的 userdata，则会创建一个新的 userdata，其 tag 等于 0。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Userdata can have different tags,
whose semantics are only known to the host program.
Tags are created with the function
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Userdata 可以具有不同的标记，其语义只有主机程序知道。标签是使用函数创建的</font></font></font><a name="lua_newtag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int lua_newtag (lua_State *L);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_newtag （lua_State *L）;</font></font></font></pre>
The function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_settag</code> changes the tag of
the object on top of the stack (without popping it):
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_settag</code>更改
堆栈顶部的对象（不弹出它）：</font></font></font><a name="lua_settag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_settag (lua_State *L, int tag);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_settag （lua_State *L， int 标签）;</font></font></font></pre>
The object must be a userdata or a table;
the given <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag</code> must be a value created with <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_newtag</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">对象必须是 userdata 或 table;
给定<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">的标签</code>必须是使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_newtag</code> 创建的值。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="luado" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="5.8" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.8 - Executing Lua Code<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.8 - 执行 Lua 代码</font></font></font></h2>
A host program can execute Lua chunks written in a file or in a string
by using the following functions:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">主机程序可以执行写入文件或字符串中的 Lua 块
使用以下函数：</font></font></font><a name="lua_dofile" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_dostring" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_dobuffer" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int lua_dofile   (lua_State *L, const char *filename);
       int lua_dostring (lua_State *L, const char *string);
       int lua_dobuffer (lua_State *L, const char *buff,
                         size_t size, const char *name);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_dofile （lua_State *L， const char *filename）;
int lua_dostring （lua_State *L， const char *string）;
int lua_dobuffer （lua_State *L， const char *buff，
size_t size， const char *name）;</font></font></font></pre>
These functions return
0 in case of success, or one of the following error codes if they fail:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这些函数返回
如果成功，则为 0，如果失败，则为以下错误代码之一：</font></font></font><ul data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="LUA_ERRRUN" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ERRRUN</tt></a> -
error while running the chunk.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="LUA_ERRRUN"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ERRRUN</tt> </a> - 运行 chunk 时出错。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="LUA_ERRSYNTAX" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ERRSYNTAX</tt></a> -
syntax error during pre-compilation.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="LUA_ERRSYNTAX"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ERRSYNTAX</tt> </a> - 预编译期间的语法错误。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="LUA_ERRMEM" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ERRMEM</tt></a> -
memory allocation error.
For such errors, Lua does not call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> (see Section&nbsp;<a href="#error" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.7</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="LUA_ERRMEM"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ERRMEM</tt> </a> - 内存分配错误。对于此类错误，Lua 不会调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code>（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#error">4.7</a> ）。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="LUA_ERRERR" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ERRERR</tt></a> -
error while running <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code>.
For such errors, Lua does not call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> again, to avoid loops.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="LUA_ERRERR"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ERRERR</tt> </a> - 运行 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> 时出错。对于此类错误，Lua 不会再次调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code>，以避免循环。</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><a name="LUA_ERRFILE" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ERRFILE</tt></a> -
error opening the file (only for <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dofile</code>).
In this case,
you may want to
check <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">errno</code>,
call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strerror</code>,
or call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">perror</code> to tell the user what went wrong.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="LUA_ERRFILE"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_ERRFILE</tt> </a> - 打开文件时出错（仅适用于 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dofile</code>）。在这种情况下，您可能需要检查 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">errno</code>、调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strerror</code> 或调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">perror</code> 来告诉用户出了什么问题。</font></font></font></li></ul>
These constants are defined in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua.h</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这些常量在 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua.h</code> 中定义。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
When called with argument <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dofile</code> executes the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code> stream.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dofile</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dobuffer</code>
are both able to execute pre-compiled chunks.
They automatically detect whether the chunk is text or binary,
and load it accordingly (see program <a name="luac" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></tt></a><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><a href="luac.html">luac</a></tt>).
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dostring</code> executes only source code,
given in textual form.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当使用参数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL</code> 调用时，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dofile</code> 将执行 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code> 流。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dofile</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dobuffer</code> 都能够执行预编译的 chunk。它们会自动检测块是 text 还是 binary，并相应地加载它（请参阅 program <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="luac"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></tt> </a> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><a href="luac.html">luac</a></tt> ）。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dostring</code> 仅执行以文本形式给出的源代码。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The third parameter to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dobuffer</code>
is the ``name of the chunk'',
which is used in error messages and debug information.
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</code> is <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL</code>,
then Lua gives a default name to the chunk.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dobuffer</code>的第三个参数是 ''name of the chunk'' ，它用于错误消息和调试信息。如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</code> 为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL，</code>则 Lua 会为数据块提供默认名称。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
These functions push onto the stack
any values eventually returned by the chunk.
A chunk may return any number of values;
Lua takes care that these values fit into the stack space,
but after the call the responsibility is back to you.
If you need to push other elements after calling any of these functions,
and you want to ``play safe'',
you must either check the stack space
with <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_stackspace</code>
or remove the returned elements
from the stack (if you do not need them).
For instance, the following code
loads a chunk in a file and discards all results returned by this chunk,
leaving the stack as it was before the call:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这些函数将 chunk 最终返回的任何值推送到堆栈上。一个 chunk 可以返回任意数量的值;Lua 会注意这些值适合堆栈空间，但在调用之后，责任又回到了你。如果你在调用这些函数中的任何一个后需要推送其他元素，并且你想 “安全游戏”，你必须用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_stackspace</code> 检查堆栈空间或从堆栈中删除返回的元素（如果你不需要它们）。例如，以下代码在文件中加载一个数据块，并丢弃此数据块返回的所有结果，使堆栈保持调用之前的状态：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">      {
       int oldtop = lua_gettop(L);
       lua_dofile(L, filename);
       lua_settop(L, oldtop);
      }
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">{
int oldtop = lua_gettop（L）;
lua_dofile（L，文件名）;
lua_settop（L， oldtop）;
      }</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="5.9" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.9 - Manipulating Global Variables in Lua<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.9 - 在 Lua 中操作全局变量</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
To read the value of a global Lua variable,
you call
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要读取全局 Lua 变量的值，请调用</font></font></font><a name="lua_getglobal" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_getglobal (lua_State *L, const char *varname);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_getglobal （lua_State *L， const char *varname）;</font></font></font></pre>
which pushes onto the stack the value of the given variable.
As in Lua, this function may trigger a tag method
for the ``getglobal'' event (see Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>).
To read the real value of a global variable,
without invoking any tag method,
use <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_rawget</code> over the table of globals
(see below).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这会将给定变量的值推送到堆栈上。
与 Lua 中一样，此函数可能会触发 tag 方法
对于 ''getglobal'' 事件（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a>）。
要读取全局变量的实值，
而不调用任何 tag 方法，
在 global 表上使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_rawget</code>
（见下文）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
To store a value in a global variable,
you call
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要在全局变量中存储值，您可以调用</font></font></font><a name="lua_setglobal" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_setglobal (lua_State *L, const char *varname);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_setglobal （lua_State *L， const char *varname）;</font></font></font></pre>
which pops from the stack the value to be stored in the given variable.
As in Lua, this function may trigger a tag method
for the ``setglobal'' event (see Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>).
To set the real value of a global variable,
without invoking any tag method,
use <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_rawset</code> over the table of globals
(see below).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">它从堆栈中弹出要存储在给定变量中的值。
与 Lua 中一样，此函数可能会触发 tag 方法
对于 ''setglobal'' 事件 （参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a>）。
要设置全局变量的实值，
而不调用任何 tag 方法，
在 global 表上使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_rawset</code>
（见下文）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
All global variables are kept in an ordinary Lua table.
You can get this table calling
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">所有全局变量都保存在一个普通的 Lua 表中。您可以让此表调用</font></font></font><a name="lua_getglobals" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_getglobals (lua_State *L);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_getglobals （lua_State *L）;</font></font></font></pre>
which pushes the current table of globals onto the stack.
To set another table as the table of globals,
you call
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这会将当前的 globals 表推送到堆栈上。
要将另一个表设置为全局表，
你调用</font></font></font><a name="lua_setglobals" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_setglobals (lua_State *L);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效lua_setglobals （lua_State *L）;</font></font></font></pre>
The table to be used is popped from the stack.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要使用的表将从堆栈中弹出。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="5.10" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.10 - Manipulating Tables in Lua<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.10 - 在 Lua 中操作表格</font></font></font></h2>
Lua tables can also be manipulated through the API.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 表也可以通过 API 进行操作。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
To read the value of in a table,
the table must reside somewhere in the stack.
With this set,
you call
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要读取表中的值 of，该表必须位于堆栈中的某个位置。使用此集合，您可以调用</font></font></font><a name="lua_gettable" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_gettable (lua_State *L, int index);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">void lua_gettable （lua_State *L， int index）;</font></font></font></pre>
where <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> refers to the table.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_gettable</code> pops a key from the stack,
and returns (on the stack) the contents of the table at that key.
As in Lua, this operation may trigger a tag method
for the ``gettable'' event.
To get the real value of any table key,
without invoking any tag method,
use the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">raw</em> version:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">其中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> 引用 table。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_gettable</code> 从堆栈中弹出一个键，
并返回（在堆栈上）该键处的表内容。
与 Lua 中一样，此操作可能会触发 tag 方法
对于 ''gettable'' 事件。
要获取任何表键的实值，
而不调用任何 tag 方法，
使用 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">RAW</em> 版本：</font></font></font><a name="lua_rawget" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_rawget (lua_State *L, int index);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_rawget （lua_State *L， int index）;</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
To store a value into a table that resides somewhere in the stack,
you push the key and the value onto the stack
(in this order),
and then call
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要将值存储到位于堆栈中某个位置的表中，请将键和值（按此顺序）推送到堆栈上，然后调用</font></font></font><a name="lua_settable" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_settable (lua_State *L, int index);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_settable （lua_State *L， int index）;</font></font></font></pre>
where <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> refers to the table.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_settable</code> pops from the stack both the key and the value.
As in Lua, this operation may trigger a tag method
for the ``settable'' event.
To set the real value of any table index,
without invoking any tag method,
use the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">raw</em> version:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">其中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> 引用 table。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_settable</code> 键和值都从堆栈中弹出。
与 Lua 中一样，此操作可能会触发 tag 方法
对于 ''settable'' 事件。
要设置任何表索引的实际值，
而不调用任何 tag 方法，
使用 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">RAW</em> 版本：</font></font></font><a name="lua_rawset" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_rawset (lua_State *L, int index);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">void lua_rawset （lua_State *L， int index）;</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Finally, the function
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">最后，函数</font></font></font><a name="lua_newtable" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_newtable (lua_State *L);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_newtable （lua_State *L）;</font></font></font></pre>
creates a new, empty table and pushes it onto the stack.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">创建一个新的空表并将其推送到堆栈上。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="5.11" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.11 - Using Tables as Arrays<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.11 - 将表用作数组</font></font></font></h2>
The API has functions that help to use Lua tables as arrays,
that is,
tables indexed by numbers only:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">该 API 具有有助于将 Lua 表用作数组的函数，
那是
仅按数字索引的表：</font></font></font><a name="lua_rawgeti" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_rawseti" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_getn" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_rawgeti (lua_State *L, int index, int n);
       void lua_rawseti (lua_State *L, int index, int n);
       int  lua_getn    (lua_State *L, int index);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_rawgeti （lua_State *L， int index， int n）;
void lua_rawseti （lua_State *L， int index， int n）;
int lua_getn （lua_State *L， int index）;</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_rawgeti</code> gets the value of the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em>-th element of the table
at stack position <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_rawgeti</code> 获取 stack position <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> 处表的第 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> 个元素的值。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_rawseti</code> sets the value of the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em>-th element of the table
at stack position <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> to the value at the top of the stack.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_rawseti</code> 将表的第 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> 个元素在堆栈位置<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">索引</code>处的值设置为堆栈顶部的值。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getn</code> returns the number of elements in the table
at stack position <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code>.
This number is the value of the table field <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code>,
if it has a numeric value,
or
the largest numerical index with a non-nil value in the table.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getn</code> 返回表中堆栈位置<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">索引</code>处的元素数。此数字是表字段 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 的值（如果它具有数值）或表中具有非 nil 值的最大数字索引。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="5.12" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.12 - Calling Lua Functions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.12 - 调用 Lua 函数</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Functions defined in Lua
(and C&nbsp;functions registered in Lua)
can be called from the host program.
This is done using the following protocol:
First, the function to be called is pushed onto the stack;
then, the arguments to the function are pushed
(see Section&nbsp;<a href="#pushing" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">5.5</a>) in <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">direct order</em>, that is, the first argument is pushed first.
Finally, the function is called using
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">可以从主机程序调用 Lua 中定义的函数（以及在 Lua 中注册的 C 函数）。这是使用以下协议完成的：首先，将要调用的函数推送到堆栈上;然后，函数的参数按<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">直接顺序</em>推送（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#pushing">5.5</a>），即第一个参数首先推送。最后，使用</font></font></font><a name="lua_call" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int lua_call (lua_State *L, int nargs, int nresults);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_call （lua_State *L， int nargs， int nresults）;</font></font></font></pre>
This function returns the same error codes as <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dostring</code> and
friends (see Section&nbsp;<a href="#luado" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">5.8</a>).
If you want to propagate the error,
instead of returning an error code,
use
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数返回与 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dostring</code> 和
朋友（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#luado">5.8</a>）。
如果要传播错误，
而不是返回错误代码，
用</font></font></font><a name="lua_rawcall" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_rawcall (lua_State *L, int nargs, int nresults);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_rawcall （lua_State *L， int nargs， int nresults）;</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
In both functions,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nargs</code> is the number of arguments that you pushed onto the stack.
All arguments and the function value are popped from the stack,
and the function results are pushed.
The number of results are adjusted (see Section&nbsp;<a href="#adjust" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.3</a>) to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nresults</code>,
unless <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nresults</code> is <a name="LUA_MULTRET" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_MULTRET</tt></a>.
In that case, <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">all</em> results from the function are pushed.
The function results are pushed in direct order
(the first result is pushed first),
so that after the call the last result is on the top.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在这两个函数中，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nargs</code> 是你推送到堆栈上的参数的数量。所有参数和函数值都从堆栈中弹出，并推送函数结果。结果的数量被调整（参见第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#adjust">4.3</a> 节）为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nresults</code>，除非 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nresults</code> 是 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="LUA_MULTRET"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_MULTRET</tt> </a>。在这种情况下，将推送该函数<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">的所有</em>结果。函数结果按直接顺序推送（第一个结果先推送），因此在调用后，最后一个结果位于顶部。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The following example shows how the host program may do the
equivalent to the Lua code:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">以下示例显示了主机程序如何执行与 Lua 代码等效的操作：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       a,b = f("how", t.x, 4)
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">a，b = f（“如何”， t.x， 4）</font></font></font></pre>
Here it is in&nbsp;C:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">这是 C 语言：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">    lua_getglobal(L, "t");                      /* global `t' (for later use) */
    lua_getglobal(L, "f");                           /* function to be called */
    lua_pushstring(L, "how");                                 /* 1st argument */
    lua_pushstring(L, "x");                            /* push the string `x' */
    lua_gettable(L, -4);                      /* push result of t.x (2nd arg) */
    lua_pushnumber(L, 4);                                     /* 3rd argument */
    lua_call(L, 3, 2);        /* call function with 3 arguments and 2 results */
    lua_setglobal(L, "b");                         /* set global variable `b' */
    lua_setglobal(L, "a");                         /* set global variable `a' */
    lua_pop(L, 1);                               /* remove `t' from the stack */
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">lua_getglobal（L， “t”）;                     /* 全局 't' （供以后使用） */
lua_getglobal（L， “f”）;                          /* 要调用的函数 */
lua_pushstring（L， “如何”）;                                /* 第一个参数 */
lua_pushstring（L， “x”）;                           /* 推送字符串 'x' */
lua_gettable（L， -4）;                     /* t.x 的推送结果（第 2 个参数） */
lua_pushnumber（L， 4）;                                    /* 第三个参数 */
lua_call（L， 3， 2）;       /* 调用具有 3 个参数和 2 个结果的函数 */
lua_setglobal（L， “b”）;                        /* 设置全局变量 'b' */
lua_setglobal（L， “a”）;                        /* 设置全局变量 'a' */
lua_pop（L， 1）;                              /* 从堆栈中删除 't' */</font></font></font></pre>
Notice that the code above is ``balanced'':
at its end ,the stack is back to its original configuration.
This is considered good programming practice.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">请注意，上面的代码是 ''balanced''：
在它结束时，堆栈返回到其原始配置。
这被认为是良好的编程实践。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Some special Lua functions have their own C&nbsp;interfaces.
The host program can generate a Lua error calling the function
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">一些特殊的 Lua 函数有自己的 C 接口。主机程序在调用函数时可能会生成 Lua 错误</font></font></font><a name="lua_error" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_error (lua_State *L, const char *message);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_error （lua_State *L， const char *message）;</font></font></font></pre>
This function never returns.
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_error</code> is called from a C&nbsp;function that has been called from Lua,
then the corresponding Lua execution terminates,
as if an error had occurred inside Lua code.
Otherwise, the whole host program terminates with a call to
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exit(EXIT_FAILURE)</code>.
Before terminating execution,
the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">message</code> is passed to the error handler function,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> (see Section&nbsp;<a href="#error" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.7</a>).
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">message</code> is <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL</code>,
then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> is not called.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数永远不会返回。
如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_error</code> 是从 Lua 调用的 C 函数调用的，则
然后相应的 Lua 执行终止，
就好像 Lua 代码中发生了错误一样。
否则，整个主机程序将终止，并调用
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exit（EXIT_FAILURE）</code> 中。
在终止执行之前，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">该消息</code>被传递给错误处理程序函数
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code>（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#error">4.7</a>）。
如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">message</code> 为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL，</code>则
则不会调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Tag methods can be changed with <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">标签方法可以通过以下方式更改</font></font></font><a name="lua_settagmethod" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_settagmethod (lua_State *L, int tag, const char *event);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_settagmethod （lua_State *L， int 标签， const char *event）;</font></font></font></pre>
The second parameter is the tag,
and the third is the event name (see Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>);
the new method is popped from the stack.
To get the current value of a tag method,
use the function <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">第二个参数是标签
第三个是事件名称（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a>）;
新方法将从堆栈中弹出。
要获取 tag 方法的当前值，
使用函数</font></font></font><a name="lua_gettagmethod" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_gettagmethod (lua_State *L, int tag, const char *event);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_gettagmethod （lua_State *L， int 标签， const char *event）;</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
It is also possible to copy all tag methods from one tag
to another: <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">也可以将所有标记方法从一个标记复制到另一个标记：</font></font></font><a name="lua_copytagmethods" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int lua_copytagmethods (lua_State *L, int tagto, int tagfrom);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_copytagmethods （lua_State *L， int tagto， int tagfrom）;</font></font></font></pre>
This function returns <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tagto</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数返回 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tagto</code>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
You can traverse a table with the function <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">您可以使用函数</font></font></font><a name="lua_next" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int lua_next (lua_State *L, int index);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_next （lua_State *L， int index）;</font></font></font></pre>
where <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> refers to the table to be traversed.
The function pops a key from the stack,
and pushes a key-value pair from the table
(the ``next'' pair after the given key).
If there are no more elements, then the function returns 0
(and pushes nothing).
A typical traversal looks like this:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">其中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> 是指需要遍历的表。
该函数从堆栈中弹出一个键
并从表中推送一个键值对
（给定键后的 ''next'' 对）。
如果没有更多元素，则函数返回 0
（并且什么都不推送）。
典型的遍历如下所示：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       /* table is in the stack at index `t' */
       lua_pushnil(L);  /* first key */
       while (lua_next(L, t) != 0) {
         /* `key' is at index -2 and `value' at index -1 */
         printf("%s - %s\n",
           lua_typename(L, lua_type(L, -2)), lua_typename(L, lua_type(L, -1)));
         lua_pop(L, 1);  /* removes `value'; keeps `index' for next iteration */
       }
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">/* 表位于堆栈中的索引 't' 处 */
lua_pushnil（升）; /* 第一个键 */
while （lua_next（L， t） ！= 0） {
/* 'key' 位于索引 -2 处，'value' 位于索引 -1 处 */
printf（“%s - %s\n”，
lua_typename（L， lua_type（L， -2））， lua_typename（L， lua_type（L， -1）））;
lua_pop（L， 1）; /* 删除 'value';保留 'index' 用于下一次迭代 */
       }</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The function <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数</font></font></font><a name="lua_concat" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_concat (lua_State *L, int n);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_concat （lua_State *L， int n）;</font></font></font></pre>
concatenates the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> values at the top of the stack,
pops them, and leaves the result at the top;
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code>&nbsp;must be at least 2.
Concatenation is done following the usual semantics of Lua
(see Section&nbsp;<a href="#concat" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.5.5</a>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">连接堆栈顶部的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 个值，
弹出它们，并将结果留在顶部;
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 必须至少为 2。
连接是按照 Lua 的通常语义完成的
（参见第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#concat">4.5.5</a> 节）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="LuacallC" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="5.13" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.13 - Defining C Functions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.13 - 定义 C 函数</font></font></font></h2> 
To register a C&nbsp;function to Lua,
there is the following convenience macro:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要将 C 函数注册到 Lua，
有以下便利宏：</font></font></font><a name="lua_register" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">     #define lua_register(L, n, f) (lua_pushcfunction(L, f), lua_setglobal(L, n))
     /* const char *n;   */
     /* lua_CFunction f; */
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">#define lua_register（L， n， f） （lua_pushcfunction（L， f）， lua_setglobal（L， n））
/* const char *n;  */
/* lua_CFunction f;*/</font></font></font></pre>
which receives the name the function will have in Lua,
and a pointer to the function.
This pointer must have type <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_CFunction</code>,
which is defined as
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">它接收函数在 Lua 中的名称，
和指向函数的指针。
此指针的类型必须<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">为 lua_CFunction</code>，
其定义为</font></font></font><a name="lua_CFunction" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       typedef int (*lua_CFunction) (lua_State *L);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">typedef int （*lua_CFunction） （lua_State *L）;</font></font></font></pre>
that is, a pointer to a function with integer result and a single argument,
a Lua environment.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">也就是说，指向具有整数 result 和单个参数的函数的指针
一个 Lua 环境。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
In order to communicate properly with Lua,
a C&nbsp;function must follow the following protocol,
which defines the way parameters and results are passed:
A C&nbsp;function receives its arguments from Lua in the stack,
in direct order (the first argument is pushed first).
To return values to Lua, a C&nbsp;function just pushes them onto the stack,
in direct order (the first result is pushed first),
and returns the number of results.
Like a Lua function, a C&nbsp;function called by Lua can also return
many results.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">为了与 Lua 正确通信，C 函数必须遵循以下协议，该协议定义了参数和结果的传递方式：C 函数从堆栈中的 Lua 接收其参数，顺序直接（第一个参数先推送）。要将值返回给 Lua，C 函数只需将它们按直接顺序推送到堆栈上（第一个结果首先被推送），并返回结果的数量。与 Lua 函数一样，Lua 调用的 C 函数也可以返回许多结果。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
As an example, the following function receives a variable number
of numerical arguments and returns their average and sum:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">例如，以下函数接收可变数量的数值参数并返回它们的 average 和 sum：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       static int foo (lua_State *L) {
         int n = lua_gettop(L);    /* number of arguments */
         double sum = 0;
         int i;
         for (i = 1; i &lt;= n; i++) {
           if (!lua_isnumber(L, i))
             lua_error(L, "incorrect argument to function `average'");
           sum += lua_tonumber(L, i);
         }
         lua_pushnumber(L, sum/n);        /* first result */
         lua_pushnumber(L, sum);         /* second result */
         return 2;                   /* number of results */
       }
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">static int foo （lua_State *L） {
int n = lua_gettop（L）;   /* 参数数量 */
双和 = 0;
int i;
for （i = 1; i &lt;= n; i++） {
如果 （！lua_isnumber（L， i））
lua_error（L， “函数 'average' 的不正确参数”）;
总和 += lua_tonumber（L， i）;
         }
lua_pushnumber（L， sum/n）;       /* 第一个结果 */
lua_pushnumber（L， 总和）;        /* 第二个结果 */
返回 2;                  /* 结果数量 */
       }</font></font></font></pre>
This function may be registered in Lua as `<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">average</code>' by calling
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数可以在 Lua 中注册为 '<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">average</code>'，方法是调用</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       lua_register(L, "average", foo);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">lua_register（L， “平均”， foo）;</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
When a C&nbsp;function is created,
it is possible to associate some <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">upvalues</em> to it
(see Section&nbsp;<a href="#upvalue" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.6</a>),
thus creating a <a name="C closure" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">C&nbsp;closure</em></a>;
these values are passed to the function whenever it is called,
as ordinary arguments.
To associate upvalues to a C&nbsp;function,
first these values should be pushed onto the stack.
Then the function <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当创建一个 C 函数时，可以将一些 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">upvalues</em> 与它相关联（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#upvalue">4.6</a>），从而创建一个 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="C closure"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">C&nbsp;闭包</em></a>;每当调用函数时，这些值都会作为普通参数传递给函数。要将 upvalues 关联到 C 函数，首先应该将这些值推送到堆栈上。然后函数</font></font></font><a name="lua_pushcclosure" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       void lua_pushcclosure (lua_State *L, lua_CFunction fn, int n);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">无效 lua_pushcclosure （lua_State *L， lua_CFunction fn， int n）;</font></font></font></pre>
is used to push the C&nbsp;function onto the stack,
with the argument <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> telling how many upvalues should be
associated with the function
(these upvalues are popped from the stack);
in fact, the macro <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushcfunction</code> is defined as
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushcclosure</code> with <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> set to 0.
Then, whenever the C&nbsp;function is called,
these upvalues are inserted as the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">last</em> arguments to the function,
after the actual arguments provided in the call.
This makes it easy to get the upvalues without knowing how many arguments
the function received (recall that functions in Lua can receive any number of
arguments): The <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</em>-th upvalue is in the stack at index <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i-(n+1)</i>,
where <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> is the number of upvalues.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">用于将 C 函数推送到堆栈上，
参数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 告诉应该有多少个 upvalues
与函数关联
（这些 upvalues 是从堆栈中弹出的）;
事实上，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">宏 lua_pushcfunction</code>定义为
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_pushcclosure，n</code> 设置为 0。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></code>
然后，每当调用 C 函数时，
这些 upvalues 作为<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">函数的最后一个</em>参数插入
在调用中提供的实际参数之后。
这使得在不知道有多少参数的情况下很容易获得 upvalues
接收到的函数（回想一下 Lua 中的函数可以接收任意数量的
arguments）：第 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</em> 个上值在堆栈中的索引 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i-（n+1）</i> 处，
其中 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> 是 upvalues 的数量。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
For more examples of C&nbsp;functions and closures, see files
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lbaselib.c</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">liolib.c</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lmathlib.c</code>, and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lstrlib.c</code>
in the official Lua distribution.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">有关 C 函数和闭包的更多示例，请参阅官方 Lua 发行版中的文件 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lbaselib.c</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">liolib.c</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lmathlib.c</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lstrlib.c</code>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="5.14" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">5.14 - References to Lua Objects<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">5.14 - 对 Lua 对象的引用</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
If the C&nbsp;code needs to keep a Lua value
outside the life span of a C&nbsp;function,
then it must create a <a name="reference" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">reference</em></a> to the value.
The functions to manipulate references are the following:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果 C 代码需要在 C 函数的生命周期之外保持 Lua 值，那么它必须创建对该值的<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="reference"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">引用</em></a>。用于操作引用的函数如下：</font></font></font><a name="lua_ref" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_getref" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_unref" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int   lua_ref    (lua_State *L, int lock);
       int   lua_getref (lua_State *L, int ref);
       void  lua_unref  (lua_State *L, int ref);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_ref （lua_State *L， int lock）;
int lua_getref （lua_State *L， int ref）;
无效 lua_unref （lua_State *L， int ref）;</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_ref</code> pops a value from
the stack, creates a reference to it,
and returns this reference.
For a <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> value,
the reference is always <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_REFNIL</code>.<a name="LUA_REFNIL" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
(<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua.h</code> also defines a constant <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_NOREF</code> <a name="LUA_NOREF" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
that
is different from any valid reference.)
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lock</code> is not zero, then the object is <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">locked</em>:
this means the object will not be garbage collected.
<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">Unlocked references may be garbage collected</em>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_ref</code> 从堆栈中弹出一个值，创建对它的引用，并返回此引用。对于 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 值，引用始终为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_REFNIL</code>。（<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua.h</code> 还定义了一个不同<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">于</code>任何有效引用的常量 LUA_NOREF。如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lock</code> 不为零，则对象被<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">锁定</em>：这意味着该对象不会被垃圾回收。<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">未锁定的引用可能会被垃圾回收</em>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Whenever the referenced object is needed in&nbsp;C,
a call to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getref</code>
pushes that object onto the stack;
if the object has been collected,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getref</code> returns 0 (and does not push anything).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">每当 C 中需要引用的对象时，对 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getref</code> 的调用都会将该对象推到堆栈上;如果对象已被收集，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">则 lua_getref</code> 返回 0（并且不会推送任何内容）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
When a reference is no longer needed,
it should be released with a call to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_unref</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当不再需要引用时，应通过调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_unref</code> 来释放该引用。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Registry<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">注册表</font></font></font></h3>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
When Lua starts, it registers a table at position
<a name="LUA_REFREGISTRY" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_REFREGISTRY</tt></a>.
It can be accessed through the macro<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 Lua 启动时，它会在位置 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="LUA_REFREGISTRY"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">LUA_REFREGISTRY</tt> </a>注册一个表 。可以通过宏</font></font></font><a name="lua_getregistry" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">  #define lua_getregistry(L)      lua_getref(L, LUA_REFREGISTRY)
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">#define lua_getregistry（L） lua_getref（L， LUA_REFREGISTRY）</font></font></font></pre>
This table can be used by C&nbsp;libraries as a general registry mechanism.
Any C&nbsp;library can store data into this table,
as long as it chooses a key different from other libraries.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">C 库可以将此表用作常规注册表机制。
任何 C 库都可以将数据存储到此表中，
只要它选择一个不同于其他库的键。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<!-- ====================================================================== -->
</p><hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="6." data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<h1 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">6 - Standard Libraries<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">6 - 标准库</font></font></font></h1>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The standard libraries provide useful functions
that are implemented directly through the standard API.
Therefore, they are not necessary to the language,
and are provided as separate C&nbsp;modules.
Currently, Lua has the following standard libraries:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">标准库提供了直接通过标准 API 实现的有用功能。因此，它们对于语言来说不是必需的，而是作为单独的 C 模块提供。目前，Lua 有以下标准库：</font></font></font></p><ul data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">basic library;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">基本库;</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">string manipulation;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">字符串操作;</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">mathematical functions (sin, log, etc);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">数学函数（sin、log 等）;</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">input and output (plus some system facilities).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">输入和输出（加上一些系统设施）。</font></font></font></li></ul>
To have access to these libraries,
the C&nbsp;host program must call the functions
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_baselibopen</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_strlibopen</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_mathlibopen</code>,
and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_iolibopen</code>, which are declared in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lualib.h</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要访问这些库，
C 主机程序必须调用函数
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_baselibopen</code>，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_strlibopen</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_mathlibopen</code>、
和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_iolibopen</code>，它们在 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lualib.h</code> 中声明。</font></font></font><a name="lua_baselibopen" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_strlibopen" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_mathlibopen" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="lua_iolibopen" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="predefined" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="6.1" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">6.1 - Basic Functions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">6.1 - 基本功能</font></font></font></h2> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The basic library provides some core functions to Lua.
Therefore, if you do not include this library in your application,
you should check carefully whether you need to provide some alternative
implementation for some facilities.
(For instance,
without function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code>,
Lua is unable to show error messages.)
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">basic 库为 Lua 提供了一些核心功能。因此，如果未在应用程序中包含此库，则应仔细检查是否需要为某些功能提供一些替代实现。（例如，如果没有 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function _ERRORMESSAGE，Lua</code> 将无法显示错误消息。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="alert" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ALERT (message)</tt></h3><a name="alert" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Prints its only string argument to <a name="stderr" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stderr</tt></a>.
All error messages in Lua are printed through the function stored
in the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ALERT</code> global variable
(see Section&nbsp;<a href="#error" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.7</a>).
Therefore, a program may assign another function to this variable
to change the way such messages are shown
(for instance, for systems without <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stderr</code>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将其唯一的字符串参数打印为 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="stderr"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stderr</tt> </a>.
Lua 中的所有错误消息都是通过函数存储的
在 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ALERT</code> 全局变量中
（参见第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#error">4.7</a> 节）。
因此，程序可能会为此变量分配另一个函数
更改此类消息的显示方式
（例如，对于没有 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stderr</code> 的系统）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">assert (v [, message])</tt></h3><a name="assert" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Issues an <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">``assertion failed!''</em> error
when its argument <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">v</code> is <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
This function is equivalent to the following Lua function:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">发出 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">''assertion failed！'</em> 错误
当其参数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">v</code> 为 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 时。
该函数相当于下面的 Lua 函数：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function assert (v, m)
         if not v then
           m = m or ""
           error("assertion failed!  " .. m)
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 assert （v， m）
如果不是 v 则
m = m 或 “”
error（“断言失败！ " ..m)
结束
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">call (func, arg [, mode [, errhandler]])</tt></h3><a name="call" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="pdf-call" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>

Calls function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">func</code> with
the arguments given by the table <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arg</code>.
The call is equivalent to
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">调用函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">func</code>
表 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arg</code>.
该调用等效于</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       func(arg[1], arg[2], ..., arg[n])
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">func（arg[1]， arg[2]， ...， arg[n]）</font></font></font></pre>
where <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> is the result of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getn(arg)</code> (see Section&nbsp;<a href="#getn" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>).
All results from <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">func</code> are simply returned by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">call</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">其中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getn（arg）</code> 的结果（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#getn">6.1</a>）。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">func</code> 的所有结果都只是通过 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">call</code> 返回。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
By default,
if an error occurs during the call to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">func</code>,
the error is propagated.
If the string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">mode</code> contains <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"x"</code>,
then the call is <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">protected</em>.<a name="protected calls" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
In this mode, function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">call</code> does not propagate an error,
regardless of what happens during the call.
Instead, it returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> to signal the error
(besides calling the appropriated error handler).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">默认情况下，如果在调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">func</code> 期间发生错误，则会传播该错误。如果字符串<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">模式</code>包含 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“x”</code>，则调用<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">受保护</em>。在此模式下，函数<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">调用</code>不会传播错误，无论调用期间发生什么情况。相反，它返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 来表示错误（除了调用适当的错误处理程序）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">errhandler</code> is provided,
the error function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> is temporarily set to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">errhandler</code>,
while <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">func</code> runs.
In particular, if <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">errhandler</code> is <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>,
no error messages will be issued during the execution of the called function.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果提供了 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">errhandler</code>，则 error 函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_ERRORMESSAGE</code> 将暂时设置为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">errhandler</code>，同时 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">func</code> 运行。特别是，如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">errhandler</code> 为 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>，则在执行被调用的函数期间不会发出错误消息。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">collectgarbage ([limit])</tt></h3><a name="collectgarbage" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Sets the garbage-collection threshold for the given limit
(in Kbytes), and checks it against the byte counter.
If the new threshold is smaller than the byte counter,
then Lua immediately runs the garbage collector (see Section&nbsp;<a href="#GC" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">5.6</a>).
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">limit</code> is absent, it defaults to zero
(thus forcing a garbage-collection cycle).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">为给定限制（以 KB 为单位）设置垃圾回收阈值，并根据字节计数器对其进行检查。如果新阈值小于字节计数器，则 Lua 立即运行垃圾回收器（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#GC">5.6</a>）。如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">limit</code> 不存在，则默认为零（从而强制进行垃圾回收循环）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">copytagmethods (tagto, tagfrom)</tt></h3>
<a name="copytagmethods" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Copies all tag methods from one tag to another;
returns <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tagto</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将所有标记方法从一个标记复制到另一个标记;
返回 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tagto</code>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">dofile (filename)</tt></h3><a name="dofile" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Receives a file name,
opens the named file, and executes its contents as a Lua chunk,
or as pre-compiled chunks.
When called without arguments,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">dofile</code> executes the contents of the standard input (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code>).
If there is any error executing the file,
then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">dofile</code> returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
Otherwise, it returns the values returned by the chunk,
or a non-<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> value if the chunk returns no values.
It issues an error when called with a non-string argument.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">接收文件名
打开命名文件，并将其内容作为 Lua 块执行，
或作为预编译的块。
当不带参数调用时，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">dofile</code> 执行标准输入 （<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin）</code> 的内容。
如果执行文件时出现任何错误，
然后 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">dofile</code> 返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。
否则，它将返回 chunk 返回的值
如果块不返回任何值，则为非 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 值。
当使用非字符串参数调用时，它会发出错误。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">dostring (string [, chunkname])</tt></h3><a name="dostring" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Executes a given string as a Lua chunk.
If there is any error executing the string,
then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">dostring</code> returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
Otherwise, it returns the values returned by the chunk,
or a non-<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> value if the chunk returns no values.
The optional parameter <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">chunkname</code>
is the ``name of the chunk'',
used in error messages and debug information.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将给定的字符串作为 Lua 块执行。
如果执行字符串时出现任何错误，
然后 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">doString</code> 返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。
否则，它将返回 chunk 返回的值
如果块不返回任何值，则为非 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 值。
可选参数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">chunkname</code>
是 ''chunk 的名称'' ，
用于错误消息和调试信息。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="pdf-error" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">error (message)</tt></h3><a name="error" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Calls the error handler (see Section&nbsp;<a href="#error" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.7</a>) and then terminates
the last protected function called
(in&nbsp;C: <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dofile</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dostring</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dobuffer</code>, or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_callfunction</code>;
in Lua: <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">dofile</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">dostring</code>, or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">call</code> in protected mode).
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">message</code> is <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>, then the error handler is not called.
Function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">error</code> never returns.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">调用错误处理程序（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#error">4.7</a>），然后终止
最后一个名为
（C 语言：<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dofile</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dostring</code>、
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dobuffer</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_callfunction</code>;
在 Lua 中：<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">dofile</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">dostring</code> 或<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">保护模式下的 call</code>）。
如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">message</code> 为 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>，则不会调用错误处理程序。
函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">error</code> 永远不会返回。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreach (table, func)</tt></h3><a name="foreach" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Executes the given <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">func</code> over all elements of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</code>.
For each element, the function is called with the index and
respective value as arguments.
If the function returns any non-<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> value,
then the loop is broken, and this value is returned
as the final value of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreach</code>.
This function could be defined in Lua:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">对 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</code> 的所有元素执行给定的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">func</code>。
对于每个元素，使用索引和
各自的值作为参数。
如果函数返回任何非 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 值，则
然后循环被打破，并返回此值
作为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreach</code> 的最终值。
这个函数可以在 Lua 中定义：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function foreach (t, f)
         for i, v in t do
           local res = f(i, v)
           if res then return res end
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 foreach （t， f）
for i， v in t do
局部分辨率 = f（i， v）
如果 res 则返回 res end
结束
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The behavior of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreach</code> is <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">undefined</em> if you change
the table <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t</code> during the traversal.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果在遍历期间更改表 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t</code>，则 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreach</code> 的行为<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">是未定义的</em>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreachi (table, func)</tt></h3><a name="foreachi" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Executes the given <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">func</code> over the
numerical indices of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</code>.
For each index, the function is called with the index and
respective value as arguments.
Indices are visited in sequential order,
from&nbsp;1 to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code>,
where <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> is the result of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getn(table)</code> (see Section&nbsp;<a href="#getn" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>).
If the function returns any non-<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> value,
then the loop is broken, and this value is returned
as the final value of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreachi</code>.
This function could be defined in Lua:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">在</code>
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">表格</code>的数字索引。
对于每个索引，使用索引和
各自的值作为参数。
索引按顺序访问，
从 1 到 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code>，
其中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getn（table）</code> 的结果（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#getn">6.1</a>）。
如果函数返回任何非 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 值，则
然后循环被打破，并返回此值
作为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreachi</code> 的最终值。
这个函数可以在 Lua 中定义：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function foreachi (t, f)
         for i=1,getn(t) do
           local res = f(i, t[i])
           if res then return res end
         end
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 foreachi （t， f）
对于 i=1，getn（t） do
局部分辨率 = f（i， t[i]）
如果 res 则返回 res end
结束
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getglobal (name)</tt></h3><a name="getglobal" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Gets the value of a global variable,
or calls a tag method for ``getglobal''.
Its full semantics is explained in Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>.
The string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</code> does not need to be a
syntactically valid variable name.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">获取全局变量
or 调用 ''getglobal'' 的标签方法。
它的完整语义在 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a> 中解释。
字符串<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">名称</code>不需要是
语法上有效的变量名称。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="getn" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getn (table)</tt></h3><a name="getn" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Returns the ``size'' of a table, when seen as a list.
If the table has an <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> field with a numeric value,
this value is the ``size'' of the table.
Otherwise, the ``size'' is the largest numerical index with a non-nil
value in the table.
This function could be defined in Lua:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回表的 ''size'' （当被视为列表时）。
如果表具有具有数值的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 字段，
这个值是表的 ''size'' 。
否则， ''size'' 是具有非 nil 的最大数字索引
值。
这个函数可以在 Lua 中定义：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function getn (t)
         if type(t.n) == "number" then return t.n end
         local max = 0
         for i, _ in t do
           if type(i) == "number" and i&gt;max then max=i end
         end
         return max
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 getn （t）
如果 type（t.n） == “number” 则返回 t.n end
本地最大值 = 0
对于 i， _ in t do
如果 type（i） == “number” 和 i&gt;max 则 max=i 结束
结束
返回最大值
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gettagmethod (tag, event)</tt></h3>
<a name="gettagmethod" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Returns the current tag method
for a given pair <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">(tag, event)</em>.
This function cannot be used to get a tag method for the ``gc'' event.
(Such tag methods can only be manipulated by C&nbsp;code.)
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回当前标记方法
对于给定的对 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">（tag， event）。</em>
此函数不能用于获取 ''gc'' 事件的标记方法。
（此类标记方法只能由 C 代码操作。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">globals ([table])</tt></h3><a name="globals" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Returns the current table of globals.
If the argument <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</code> is given,
then it also sets this table as the table of globals.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回当前全局变量表。
如果给出了参数<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">表</code>，则
然后，它还将此 table 设置为 global 的 table。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="pdf-newtag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">newtag ()</tt></h3><a name="newtag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Returns a new tag.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回一个新标签。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">next (table, [index])</tt></h3><a name="next" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Allows a program to traverse all fields of a table.
Its first argument is a table and its second argument
is an index in this table.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">next</code> returns the next index of the table and the
value associated with the index.
When called with <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> as its second argument,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">next</code> returns the first index
of the table and its associated value.
When called with the last index,
or with <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> in an empty table,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">next</code> returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
If the second argument is absent, then it is interpreted as <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">允许程序遍历表的所有字段。
它的第一个参数是表，第二个参数
是此表中的索引。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">next</code> 返回表的下一个索引，而
值。
当以 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 作为其第二个参数调用时，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">next</code> 返回第一个索引
及其关联值。
当使用最后一个索引调用时，
或者空表中<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">有 nil</b>，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">next</code> 返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。
如果第二个参数不存在，则将其解释为 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua has no declaration of fields;
semantically, there is no difference between a
field not present in a table or a field with value <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
Therefore, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">next</code> only considers fields with non-<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> values.
The order in which the indices are enumerated is not specified,
<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">even for numeric indices</em>
(to traverse a table in numeric order,
use a numerical <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> or the function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreachi</code>).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 没有字段声明;从语义上讲，表中不存在的字段与值为 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 的字段之间没有区别。因此，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">next</code> 仅考虑具有非 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 值的字段。未指定索引的枚举顺序，<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">即使对于数字索引</em>也是如此（要按数字顺序遍历表，请使用数字 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> 或函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreachi</code>）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The behavior of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">next</code> is <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">undefined</em> if you change
the table during the traversal.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果在遍历期间更改表，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">则 next</code> 的行为是<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">未定义的</em>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">print (e1, e2, ...)</tt></h3><a name="print" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Receives any number of arguments,
and prints their values using the strings returned by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tostring</code>.
This function is not intended for formatted output,
but only as a quick way to show a value,
for instance for debugging.
See Section&nbsp;<a href="#libio" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.4</a> for functions for formatted output.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">接收任意数量的参数，
并使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">toString</code> 返回的字符串打印它们的值。
此函数不适用于格式化输出，
但只是作为显示值的一种快速方式，
例如用于调试。
有关格式化输出的函数，请参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#libio">6.4</a> 。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawget (table, index)</tt></h3><a name="rawget" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Gets the real value of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table[index]</code>,
without invoking any tag method.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</code> must be a table,
and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> is any value different from <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">获取 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table[index]</code> 的实值，
而无需调用任何 tag 方法。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</code> 必须是一个 table，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index 是</code>不同于 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 的任何值。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawset (table, index, value)</tt></h3><a name="rawset" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Sets the real value of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table[index]</code> to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">value</code>,
without invoking any tag method.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</code> must be a table,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> is any value different from <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>,
and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">value</code> is any Lua value.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table[index]</code> 的实值设置为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">value</code>，
而无需调用任何 tag 方法。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</code> 必须是一个 table，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index</code> 是任何不同于 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 的值，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">value</code> 是任何 Lua 值。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setglobal (name, value)</tt></h3><a name="setglobal" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Sets the named global variable to the given value,
or calls a tag method for ``setglobal''.
Its full semantics is explained in Section&nbsp;<a href="#tag-method" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.8</a>.
The string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</code> does not need to be a
syntactically valid variable name.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将命名的全局变量设置为给定值
or 调用 ''setglobal'' 的标签方法。
它的完整语义在 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#tag-method">4.8</a> 中解释。
字符串<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">名称</code>不需要是
语法上有效的变量名称。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settag (t, tag)</tt></h3><a name="settag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Sets the tag of a given table (see Section&nbsp;<a href="#TypesSec" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">3</a>).
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag</code> must be a value created with <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">newtag</code>
(see Section&nbsp;<a href="#pdf-newtag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>).
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settag</code> returns the value of its first argument (the table).
For the safety of host programs,
it is impossible to change the tag of a userdata from Lua.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">设置给定表的标签（请参阅 第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#TypesSec">3</a> 节）。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag</code> 必须是使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">newtag</code> 创建的值
（参见第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#pdf-newtag">6.1</a> 节）。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settag</code> 返回其第一个参数 （TABLE） 的值。
为了主机程序的安全，
无法从 Lua 更改 userdata 的标签。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settagmethod (tag, event, newmethod)</tt></h3>
<a name="settagmethod" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Sets a new tag method to the given pair <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">(tag, event)</em> and
returns the old method.
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">newmethod</code> is <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>,
then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settagmethod</code> restores the default behavior for the given event.
This function cannot be used to set a tag method for the ``gc'' event.
(Such tag methods can only be manipulated by C&nbsp;code.)
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">为给定的对 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">（tag， event）</em> 设置新的标记方法，并且
返回旧方法。
如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">newmethod</code> 为 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>，则
然后 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">settagMethod</code> 恢复给定事件的默认行为。
此函数不能用于为 ''gc'' 事件设置标签方法。
（此类标记方法只能由 C 代码操作。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">sort (table [, comp])</tt></h3><a name="sort" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Sorts table elements in a given order, <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">in-place</em>,
from <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table[1]</code> to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table[n]</code>,
where <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> is the result of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getn(table)</code> (see Section&nbsp;<a href="#getn" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>).
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">comp</code> is given,
then it must be a function that receives two table elements,
and returns true (that is, a value different from <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>)
when the first is less than the second
(so that <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">not comp(a[i+1], a[i])</code> will be true after the sort).
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">comp</code> is not given,
then the standard Lua operator <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&lt;</code> is used instead.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">按给定顺序对表格元素进行排序，<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">就地</em>、
从 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table[1]</code> 到 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table[n]</code>，
其中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getn（table）</code> 的结果（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#getn">6.1</a>）。
如果给出 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">comp</code>，则
那么它必须是一个接收两个 table 元素的函数，
并返回 true（即，不同于 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 的值）
当第一个小于第二个时
（因此 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">not comp（a[i+1]， a[i]）</code> 在排序后将为 true）。
如果未给出 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">comp</code>，则
然后改用标准 Lua 运算符 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&lt;</code>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The sort algorithm is <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">not</em> stable
(that is, elements considered equal by the given order
may have their relative positions changed by the sort).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">排序算法<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">不稳定</em>（即，按给定顺序认为相等的元素可能会因排序而更改其相对位置）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="pdf-tag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tag (v)</tt></h3><a name="tag" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Allows Lua programs to test the tag of a value (see Section&nbsp;<a href="#TypesSec" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">3</a>).
It receives one argument, and returns its tag (a number).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">允许 Lua 程序测试值的标签（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#TypesSec">3</a>）。
它接收一个参数，并返回其标签（一个数字）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tonumber (e [, base])</tt></h3><a name="tonumber" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Tries to convert its argument to a number.
If the argument is already a number or a string convertible
to a number, then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tonumber</code> returns that number;
otherwise, it returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">尝试将其参数转换为数字。
如果参数已经是可转换的数字或字符串
设置为一个数字，则 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">toNumber</code> 返回该数字;
否则，它将返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
An optional argument specifies the base to interpret the numeral.
The base may be any integer between 2 and 36, inclusive.
In bases above&nbsp;10, the letter `A' (either upper or lower case)
represents&nbsp;10, `B' represents&nbsp;11, and so forth, with `Z' representing 35.
In base 10 (the default), the number may have a decimal part,
as well as an optional exponent part (see Section&nbsp;<a href="#coercion" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">4.2</a>).
In other bases, only unsigned integers are accepted.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">可选参数指定解释数字的基数。基数可以是 2 到 36 之间的任何整数（包括 2 和 36）。在 10 以上的基数中，字母 'A' （大写或小写） 代表 10，'B' 代表 11，依此类推，'Z' 代表 35。在以 10 为基数（默认值）中，数字可以有一个小数部分，也可以有一个可选的指数部分（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#coercion">4.2</a>）。在其他 base 中，只接受 unsigned integers。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tostring (e)</tt></h3><a name="tostring" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Receives an argument of any type and
converts it to a string in a reasonable format.
For complete control of how numbers are converted,
use function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">format</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">接收任何类型的参数，并且
将其转换为合理格式的字符串。
为了完全控制数字的转换方式，
use 函数<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">格式</code>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tinsert (table [, pos] , value)</tt></h3><a name="tinsert" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Inserts element <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">value</code> at table position <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pos</code>,
shifting other elements to open space, if necessary.
The default value for <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pos</code> is <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n+1</code>,
where <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> is the result of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getn(table)</code> (see Section&nbsp;<a href="#getn" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>),
so that a call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tinsert(t,x)</code> inserts <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</code> at the end
of table <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t</code>.
This function also sets or increments the field <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> of the table
to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n+1</code>.
This function is equivalent to the following Lua function,
except that the table accesses are all <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">raw</em>
(that is, without tag methods):
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在表格位置 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pos</code> 处插入元素<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">值</code>，必要时将其他元素移动到开放空间。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pos</code> 的默认值是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n+1</code>，其中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getn（table）</code> 的结果（参见第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#getn">6.1</a> 节），因此调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tinsert（t，x）</code> 会在表 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t</code> 的末尾插入 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</code>。此函数还将表的字段 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 设置或递增为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n+1</code>。该函数等价于下面的 Lua 函数，只是表访问都是<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">原始</em>的（即没有 tag 方法）：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function tinsert (t, ...)
         local pos, value
         local n = getn(t)
         if arg.n == 1 then
           pos, value = n+1, arg[1]
         else
           pos, value = arg[1], arg[2]
         end
         t.n = n+1;
         for i=n,pos,-1 do
           t[i+1] = t[i]
         end
         t[pos] = value
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 tinsert （t， ...）
本地 POS、值
本地 n = getn（t）
如果 arg.n == 1 则
pos，值 = n+1，arg[1]
还
pos，值 = arg[1]， arg[2]
结束
t.n = n+1;
对于 i=n，pos，-1 do
t[i+1] = t[i]
结束
t[pos] = 值
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tremove (table [, pos])</tt></h3><a name="tremove" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Removes from <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">table</code> the element at position <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pos</code>,
shifting other elements to close the space, if necessary.
Returns the value of the removed element.
The default value for <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pos</code> is <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code>,
where <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> is the result of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getn(table)</code> (see Section&nbsp;<a href="#getn" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">6.1</a>),
so that a call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tremove(t)</code> removes the last element
of table <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t</code>.
This function also sets or decrements the field <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> of the table
to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n-1</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">从<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">表格</code>中删除位置 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pos</code> 处的元素，必要时移动其他元素以关闭空间。返回已删除元素的值。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pos</code> 的默认值是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code>，其中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getn（table）</code> 的结果（参见第 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#getn">6.1</a> 节），因此调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tremove（t）</code> 会删除表 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">t</code> 的最后一个元素。此函数还将表的字段 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 设置或递减为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n-1</code>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
This function is equivalent to the following Lua function,
except that the table accesses are all <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">raw</em>
(that is, without tag methods):
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">该函数等价于下面的 Lua 函数，只是表访问都是<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">原始</em>的（即没有 tag 方法）：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       function tremove (t, pos)
         local n = getn(t)
         if n&lt;=0 then return end
         pos = pos or n
         local value = t[pos]
         for i=pos,n-1 do
           t[i] = t[i+1]
         end
         t[n] = nil
         t.n = n-1
         return value
       end
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 tremove （t， pos）
本地 n = getn（t）
如果 n&lt;=0 则返回 end
pos = pos 或 n
局部值 = t[pos]
对于 i=pos，n-1 do
t[i] = t[i+1]
结束
t[n] = 无
t.n = n-1
返回值
结束</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="pdf-type" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">type (v)</tt></h3><a name="type" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Allows Lua programs to test the type of a value.
It receives one argument, and returns its type, coded as a string.
The possible results of this function are
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"nil"</code> (a string, not the value <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>),
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"number"</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"string"</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"table"</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"function"</code>,
and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"userdata"</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">允许 Lua 程序测试值的类型。
它接收一个参数，并返回其类型，编码为字符串。
此函数的可能结果是
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“nil”</code> （字符串，而不是值 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>），
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“number”</code>、
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“字符串”</code>、
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“table”</code>、
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“函数”</code>、
和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“userdata”</code> 的</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="6.2" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">6.2 - String Manipulation<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">6.2 - 字符串操作</font></font></font></h2>
This library provides generic functions for string manipulation,
such as finding and extracting substrings and pattern matching.
When indexing a string in Lua, the first character is at position&nbsp;1
(not at&nbsp;0, as in C).
Also,
indices are allowed to be negative and are intepreted as indexing backwards,
from the end of the string. Thus, the last character is at position <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-1</i>,
and so on.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此库提供了用于字符串操作的通用函数，
例如查找和提取子字符串以及模式匹配。
在 Lua 中为字符串编制索引时，第一个字符位于位置 1
（而不是 C 中的 0）。
也
indices 可以是负数，并被解释为向后索引，
从字符串的末尾开始。因此，最后一个字符位于位置 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-1</i>，
等等。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strbyte (s [, i])</tt></h3><a name="strbyte" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Returns the internal numerical code of the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</em>-th character of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code>.
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</code> is absent, then it is assumed to be&nbsp;1.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</code> may be negative.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code> 的第 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</em> 个字符的内部数字代码。
如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</code> 不存在，则假定为 1。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">我</code>可能是负面的。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Numerical codes are not necessarily portable across platforms.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">数字代码不一定可以跨平台移植。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strchar (i1, i2, ...)</tt></h3><a name="strchar" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Receives 0 or more integers.
Returns a string with length equal to the number of arguments,
wherein each character has the internal numerical code equal
to its correspondent argument.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">接收 0 个或多个整数。
返回一个长度等于参数个数的字符串，
其中，每个字符的内部数字代码等于
到其相应的论点。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Numerical codes are not necessarily portable across platforms.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">数字代码不一定可以跨平台移植。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strfind (s, pattern [, init [, plain]])</tt></h3>
<a name="strfind" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Looks for the first <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">match</em> of
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pattern</code> in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code>.
If it finds one, then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strfind</code> returns the indices of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code>
where this occurrence starts and ends;
otherwise, it returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
If the pattern specifies captures (see <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gsub</code> below),
the captured strings are returned as extra results.
A third, optional numerical argument <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">init</code> specifies
where to start the search;
its default value is&nbsp;1, and may be negative.
A value of&nbsp;1 as a fourth, optional argument <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">plain</code>
turns off the pattern matching facilities,
so the function does a plain ``find substring'' operation,
with no characters in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pattern</code> being considered ``magic''.
Note that if <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">plain</code> is given, then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">init</code> must be given too.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">查找 的第一个<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">匹配项</em>
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">S</code> 中的<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">模式</code>。
如果找到一个，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">则 strfind</code> 返回 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code> 的索引
此事件的开始和结束位置;
否则，它将返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。
如果模式指定了 captures（参见下面的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gsub</code>），
捕获的字符串将作为额外结果返回。
第三个可选的数字参数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">init</code> 指定
从哪里开始搜索;
其默认值为 1，可能为负数。
值 1 作为第四个可选参数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">plain</code>
关闭模式匹配功能，
所以这个函数做了一个普通的 ''find substring'' 操作，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pattern</code> 中没有字符被视为 ''magic'' 。
请注意，如果给出了 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">plain</code> ，则也必须给出 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">init</code>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strlen (s)</tt></h3><a name="strlen" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Receives a string and returns its length.
The empty string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">""</code> has length 0.
Embedded zeros are counted,
and so <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"a\000b\000c"</code> has length 5.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">接收字符串并返回其长度。
空字符串 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“”</code> 的长度为 0。
内嵌的零被计算在内，
因此 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“A\000B\000C”</code> 的长度为 5。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strlower (s)</tt></h3><a name="strlower" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Receives a string and returns a copy of that string with all
upper case letters changed to lower case.
All other characters are left unchanged.
The definition of what is an upper-case
letter depends on the current locale.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">接收一个字符串并返回该字符串的副本，其中包含所有
大写字母更改为小写字母。
所有其他字符保持不变。
什么是大写的定义
letter 取决于当前区域设置。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strrep (s, n)</tt></h3><a name="strrep" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Returns a string that is the concatenation of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> copies of
the string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回一个字符串，该字符串是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">的 n</code> 个副本的串联
字符串 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strsub (s, i [, j])</tt></h3><a name="strsub" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Returns another string, which is a substring of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code>,
starting at <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</code>  and running until <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">j</code>;
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">j</code> may be negative,
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">j</code> is absent, then it is assumed to be equal to <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-1</i>
(which is the same as the string length).
In particular,
the call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strsub(s,1,j)</code> returns a prefix of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code>
with length <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">j</code>,
and the call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strsub(s, -i)</code> returns a suffix of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code>
with length <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回另一个字符串，它是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code> 的子字符串，
从 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</code> 开始，一直到 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">j</code>;
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">j</code> 可能为负数，
如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">j</code> 不存在，则假定它等于 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-1</i>
（与字符串长度相同）。
特别
调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strSub（s，1，j）</code> 返回 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code> 的前缀
长度<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">为 j</code>，
调用<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strsub（s， -i）</code> 返回后缀 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code>
长度<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">为 i</code>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strupper (s)</tt></h3><a name="strupper" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Receives a string and returns a copy of that string with all
lower case letters changed to upper case.
All other characters are left unchanged.
The definition of what is a lower case
letter depends on the current locale.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">接收一个字符串并返回该字符串的副本，其中包含所有
小写字母更改为大写。
所有其他字符保持不变。
什么是小写的定义
letter 取决于当前区域设置。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">format (formatstring, e1, e2, ...)</tt></h3><a name="format" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="format" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>

Returns a formatted version of its variable number of arguments
following the description given in its first argument (which must be a string).
The format string follows the same rules as the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">printf</code> family of
standard C&nbsp;functions.
The only differences are that the options/modifiers
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">l</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">L</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">p</code>,
and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">h</code> are not supported,
and there is an extra option, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">q</code>.
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">q</code> option formats a string in a form suitable to be safely read
back by the Lua interpreter:
The string is written between double quotes,
and all double quotes, returns, and backslashes in the string
are correctly escaped when written.
For instance, the call
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回其可变参数数量的格式化版本
在其第一个参数中给出的描述（必须是字符串）之后。
格式字符串遵循与 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">printf</code> 系列
标准 C 函数。
唯一的区别是选项/修饰符
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">l</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">L</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">p</code>、
和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">h</code> 不受支持，
还有一个额外的选项 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">q</code>。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">q</code> 选项以适合安全读取的形式格式化字符串
返回 Lua 解释器：
字符串写在双引号之间，
以及字符串中的所有双引号、返回值和反斜杠
在写入时正确转义。
例如，调用</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       format('%q', 'a string with "quotes" and \n new line')
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">format（'%q'， '带有 “引号” 和 \n 新行的字符串'）</font></font></font></pre>
will produce the string:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将生成字符串：</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">"a string with \"quotes\" and \
 new line"
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">“带有 \”引号\“ 和 \ 的字符串
新行”</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Conversions can be applied to the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em>-th argument in the argument list,
rather than the next unused argument.
In this case, the conversion character <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%</code> is replaced
by the sequence <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%d$</code>, where <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">d</code> is a
decimal digit in the range [1,9],
giving the position of the argument in the argument list.
For instance, the call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">format("%2$d -&gt; %1$03d", 1, 34)</code> will
result in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"34 -&gt; 001"</code>.
The same argument can be used in more than one conversion.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">转换可以应用于参数列表中的第 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> 个参数，而不是下一个未使用的参数。在这种情况下，转换字符 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%</code> 被序列 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%d$</code> 替换，其中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">d</code> 是 [1,9] 范围内的十进制数字，给出参数在参数列表中的位置。例如，调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">format("%2$d -&gt; %1$03d", 1, 34)</code> 将导致 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“34 -&gt; 001”。</code>同一参数可用于多个转换。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The options <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">c</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">d</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">E</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">e</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">g</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">G</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">o</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">u</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">X</code>, and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</code> all
expect a number as argument,
whereas <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">q</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code> expect a string.
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</code> modifier can be simulated by building
the appropriate format string.
For example, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"%*g"</code> can be simulated with
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"%"..width.."g"</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">选项 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">c</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">d</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">E</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">e</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">g</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">G</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">i</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">o</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">u</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">X</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</code> 都需要一个数字作为参数，而 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">q</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code> 需要一个字符串。可以通过构建适当的格式字符串来模拟 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</code> 修饰符。例如，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“%*g”</code> 可以用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“%”来模拟。宽度..”g“的。</code></font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Neither the format string nor the string values to be formatted with
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%s</code> can contain embedded zeros.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%q</code> handles string values with embedded zeros.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">格式字符串和要使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%s</code> 设置格式的字符串值都不能包含嵌入的零。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%q</code> 处理带有嵌入零的字符串值。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gsub (s, pat, repl [, n])</tt></h3>
<a name="gsub" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
Returns a copy of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code>
in which all occurrences of the pattern <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pat</code> have been
replaced by a replacement string specified by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repl</code>.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gsub</code> also returns, as a second value,
the total number of substitutions made.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">s</code> 的副本
其中，模式 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">PAT</code> 的所有匹配项都已
替换为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repl</code> 指定的替换字符串。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">gsub</code> 还返回第二个值
换人的总数。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repl</code> is a string, then its value is used for replacement.
Any sequence in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repl</code> of the form <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%n</code>
with <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> between 1 and 9
stands for the value of the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em>-th captured substring.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repl</code> 是一个字符串，则其值用于替换。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">任何 repl</code> 中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%n</code> 形式且 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 介于 1 和 9 之间的序列都代表第 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> 个捕获的子字符串的值。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repl</code> is a function, then this function is called every time a
match occurs, with all captured substrings passed as arguments,
in order (see below).
If the value returned by this function is a string,
then it is used as the replacement string;
otherwise, the replacement string is the empty string.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repl</code> 是一个函数，则每次发生匹配时都会调用此函数，并按顺序将所有捕获的子字符串作为参数传递（请参阅下文）。如果此函数返回的值是字符串，则将其用作替换字符串;否则，替换字符串为空字符串。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The last, optional parameter <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> limits
the maximum number of substitutions to occur.
For instance, when <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> is 1 only the first occurrence of
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pat</code> is replaced.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">最后一个可选参数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 限制要发生的最大替换数。例如，当 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 为 1 时，仅替换第一次出现的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pat</code>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Here are some examples:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">以下是一些示例：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">   x = gsub("hello world", "(%w+)", "%1 %1")
   --&gt; x="hello hello world world"
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">x = gsub（“你好世界”， “（%w+）”， “%1 %1”）
--&gt; x=“你好 你好 世界”</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
   x = gsub("hello world", "(%w+)", "%1 %1", 1)
   --&gt; x="hello hello world"
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">x = gsub（“你好 世界”， “（%w+）”， “%1 %1”， 1） --&gt; x=“你好 你好 世界”</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
   x = gsub("hello world from Lua", "(%w+)%s*(%w+)", "%2 %1")
   --&gt; x="world hello Lua from"
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">x = gsub（“来自 Lua 的你好世界”， “（%w+）%s*（%w+）”， “%2 %1”） --&gt; x=“世界你好 Lua 来自”</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
   x = gsub("home = $HOME, user = $USER", "%$(%w+)", getenv)
   --&gt; x="home = /home/roberto, user = roberto"  (for instance)
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">x = gsub（“home = $HOME， user = $USER”， “%$（%w+）”， getenv） --&gt; x=“home = /home/roberto， user = roberto”（例如）</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
   x = gsub("4+5 = $return 4+5$", "%$(.-)%$", dostring)
   --&gt; x="4+5 = 9"
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">x = gsub（“4+5 = $return 4+5$”， “%$（.-）%$”， dostring） --&gt; x=“4+5 = 9”</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
   local t = {name="lua", version="4.0"}
   x = gsub("$name - $version", "%$(%w+)", function (v) return %t[v] end)
   --&gt; x="lua - 4.0"
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">本地 t = {name=“lua”， version=“4.0”} x = gsub（“$name - $version”， “%$（%w+）”， 函数 （v） 返回 %t[v] end） --&gt; x=“lua - 4.0”</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
   t = {n=0}
   gsub("first second word", "(%w+)", function (w) tinsert(%t, w) end)
   --&gt; t={"first", "second", "word"; n=3}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">t = {n=0} gsub（“第一个第二个单词”， “（%w+）”， 函数 （w） tinsert（%t， w） end） --&gt; t={“第一个”， “第二个”， “单词”;n=3}</font></font></font></p></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="pm" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Patterns<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">模式</font></font></font></h3> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h4 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Character Class:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">字符类：</font></font></font></h4>
a <a name="character class" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">character class</em></a> is used to represent a set of characters.
The following combinations are allowed in describing a character class:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="character class"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">字符类</em></a>用于表示一组字符。
在描述字符类时，允许使用以下组合：</font></font></font><dl data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">x</em></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> (where <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> is any magic characters
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^$()%.[]*+-?</code>)
- represents the character <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> itself.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">（其中 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> 是任何魔法字符 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^$（）%.[]*+-？</code>）- 表示字符 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> 本身。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">.</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> - (a dot) represents all characters.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">- （一个点）表示所有字符。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%a</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> - represents all letters.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">- 表示所有字母。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%c</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> - represents all control characters.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">- 表示所有控制字符。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%d</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> - represents all digits.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">- 表示所有数字。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%l</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> - represents all lower case letters.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">- 表示所有小写字母。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%p</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> - represents all punctuation characters.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">- 表示所有标点字符。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%s</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> - represents all space characters.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">- 表示所有空格字符。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%u</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> - represents all upper case letters.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">- 表示所有大写字母。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%w</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> - represents all alphanumeric characters.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">- 表示所有字母数字字符。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%x</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> - represents all hexadecimal digits.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">- 表示所有十六进制数字。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%z</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> - represents the character with representation 0.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">- 表示 0 的字符。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%<em>x</em></tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> (where <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> is any non-alphanumeric character)  -
represents the character <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em>.
This is the standard way to escape the magic characters.
We recommend that any punctuation character (even the non magic)
should be preceded by a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%</code>
when used to represent itself in a pattern.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">（其中 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> 是任何非字母数字字符）- 表示字符 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em>。这是转义魔法字符的标准方法。我们建议任何标点符号字符（即使是非魔法字符）在用于在模式中表示自身时，都应该在前面加上 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%。</code></font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[char-set</tt></b>]</dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> -
represents the class which is the union of all
characters in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">char-set</code>.
A range of characters may be specified by
separating the end characters of the range with a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code>.
All classes <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%</code><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> described above may also be used as
components in a char-set.
All other characters in char-set represent themselves.
For example, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[%w_]</code> (or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[_%w]</code>)
represents all alphanumeric characters plus the underscore,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[0-7]</code> represents the octal digits,
and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[0-7%l%-]</code> represents the octal digits plus
the lower case letters plus the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code> character.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">-
表示类，该类是所有
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">字符</code>。
字符范围可以由
用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code> 分隔范围的结束字符。
上述所有类 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%</code><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> 也可以用作
组件。
char-set 中的所有其他字符都表示自身。
例如，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[%w_]</code>（或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[_%w]</code>）
表示所有字母数字字符加上下划线，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[0-7]</code> 表示八进制数字，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[0-7%l%-]</code> 表示八进制数字加
小写字母加上 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code> 字符。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The interaction between ranges and classes is not defined.
Therefore, patterns like <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[%a-z]</code> or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[a-%%]</code>
have no meaning.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">范围和类之间的交互未定义。因此，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">像 [%a-z]</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[a-%%]</code> 这样的模式没有意义。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[^char-set</tt></b>]</dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> -
represents the complement of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">char-set</code>,
where <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">char-set</code> is interpreted as above.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">- 表示 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">char-set</code> 的补码，其中 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">char-set</code> 的解释如上所述。</font></font></font></dd></dl>
For all classes represented by single letters (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%a</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%c</code>, ...),
the corresponding upper-case letter represents the complement of the class.
For instance, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%S</code> represents all non-space characters.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">对于由单个字母 （<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%a</code>， <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%c</code>， ...） 表示的所有类，
相应的大写字母表示类的补码。
例如，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%S</code> 表示所有非空格字符。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The definitions of letter, space, etc. depend on the current locale.
In particular, the class <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[a-z]</code> may not be equivalent to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%l</code>.
The second form should be preferred for portability.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">letter、space 等的定义取决于当前的 locale。特别是，类 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[a-z]</code> 可能不等同于 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%l</code>。第二种形式应该是可移植性的优先选择。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h4 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Pattern Item:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">图案项目：</font></font></font></h4>
a <a name="pattern item" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pattern item</em></a> may be
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="pattern item"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">模式项</em></a>可以是</font></font></font><ul data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
a single character class,
which matches any single character in the class;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">单个字符类，与类中的任何单个字符匹配;</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
a single character class followed by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</code>,
which matches 0 or more repetitions of characters in the class.
These repetition items will always match the longest possible sequence;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">一个字符类，后跟 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</code>，它匹配类中 0 个或多个重复的字符。这些重复项将始终匹配尽可能长的序列;</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
a single character class followed by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">+</code>,
which matches 1 or more repetitions of characters in the class.
These repetition items will always match the longest possible sequence;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">单个字符类，后跟 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">+</code>，匹配类中的 1 个或多个重复字符。这些重复项将始终匹配尽可能长的序列;</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
a single character class followed by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code>,
which also matches 0 or more repetitions of characters in the class.
Unlike <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</code>,
these repetition items will always match the shortest possible sequence;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">单个字符类后跟 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</code>，它还匹配类中 0 个或多个重复字符。与 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</code> 不同，这些重复项将始终匹配尽可能短的序列;</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
a single character class followed by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">?</code>,
which matches 0 or 1 occurrence of a character in the class;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">单个字符类后跟 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">？</code>，它与类中字符的 0 次或 1 次匹配;</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%<em>n</em></tt>, for <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> between 1 and 9;
such item matches a sub-string equal to the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em>-th captured string
(see below);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%<em>n</em></tt> ，对于 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> 介于 1 和 9 之间;此类 item 匹配等于第 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</em> 个捕获的字符串的子字符串（见下文）;</font></font></font></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%b<em>xy</em></tt>, where <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> and <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">y</em> are two distinct characters;
such item matches strings that start with&nbsp;<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em>, end with&nbsp;<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">y</em>,
and where the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> and <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">y</em> are <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">balanced</em>.
This means that, if one reads the string from left to right,
counting <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">+1</i> for an <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> and <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-1</i> for a <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">y</em>,
the ending <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">y</em> is the first <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">y</em> where the count reaches 0.
For instance, the item <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%b()</code> matches expressions with
balanced parentheses.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%b<em>xy</em></tt> ，其中 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> 和 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">y</em> 是两个不同的字符;此类项目匹配以 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> 开头、以 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">y</em> 结尾以及 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> 和 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">y</em> <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">平衡的</em>字符串。这意味着，如果从左到右读取字符串，对 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x</em> 计数 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">+1</i>，对 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">y</em> 计数 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-1</i>，则结尾 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">y</em> 是计数达到 0 的第一个 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">y</em>。例如，项 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%b（）</code> 匹配带有平衡括号的表达式。</font></font></font></li></ul>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h4 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Pattern:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">模式：</font></font></font></h4>
a <a name="pattern" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">pattern</em></a> is a sequence of pattern items.
A <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^</code> at the beginning of a pattern anchors the match at the
beginning of the subject string.
A <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">$</code> at the end of a pattern anchors the match at the
end of the subject string.
At other positions,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">$</code> have no special meaning and represent themselves.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="pattern"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">模式</em></a>是一系列模式项。
模式开头的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^</code> 将匹配项锚定在
主题字符串的开头。
模式末尾的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">$</code> 将匹配项锚定在
主题字符串的结尾。
在其他位置，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">$</code> 没有特殊含义，它们代表自己。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h4 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Captures:<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">捕获：</font></font></font></h4>
A pattern may contain sub-patterns enclosed in parentheses,
they describe <a name="captures" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">captures</em></a>.
When a match succeeds, the sub-strings of the subject string
that match captures are stored (<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">captured</em>) for future use.
Captures are numbered according to their left parentheses.
For instance, in the pattern <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"(a*(.)%w(%s*))"</code>,
the part of the string matching <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"a*(.)%w(%s*)"</code> is
stored as the first capture (and therefore has number&nbsp;1);
the character matching <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">.</code> is captured with number&nbsp;2,
and the part matching <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%s*</code> has number&nbsp;3.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">模式可以包含括在括号中的子模式，
它们描述<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="captures"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">捕获</em></a>。
匹配成功后，主题字符串的子字符串
匹配捕获将被存储 （<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">捕获</em>） 以备将来使用。
捕获根据其左括号进行编号。
例如，在模式 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“（a*（.）%w（%s*））“</code>，
字符串中匹配 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“A*（.）%w（%s*）“</code> 为
存储为第一个捕获（因此具有编号 1）;
匹配的字符 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">.</code> 被捕获为数字 2，
匹配 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%s*</code> 的部分的编号为 3。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
A pattern cannot contain embedded zeros.  Use <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%z</code> instead.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">模式不能包含嵌入的零。请改用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%z</code>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="mathlib" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="6.3" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">6.3 - Mathematical Functions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">6.3 - 数学函数</font></font></font></h2> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
This library is an interface to some functions of the standard C&nbsp;math library.
In addition, it registers a tag method for the binary operator <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^</code> that
returns <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x^y</i> when applied to numbers <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x^y</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">该库是标准 C 数学库的某些函数的接口。此外，它还为二元运算符 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">^</code> 注册了一个标记方法，该方法在应用于数字 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x^y</code> 时返回 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">x^y</i>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The library provides the following functions:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">该库提供以下功能：</font></font></font><a name="abs" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="acos" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="asin" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="atan" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="atan2" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="ceil" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="cos" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="def" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="exp" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="floor" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="log" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="log10" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="max" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="min" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="mod" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="rad" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="sin" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="sqrt" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="tan" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="frexp" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="ldexp" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="random" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="randomseed" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       abs  acos  asin  atan  atan2  ceil  cos  deg    exp    floor   log  log10
       max  min   mod   rad   sin    sqrt  tan  frexp  ldexp  random  randomseed
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">ABS ACOS ASIN ATAN ATAN2 CEIL COS DEG EXP 地板日志日志10
最大最小 Mod rad sin sqrt tan frexp ldexp 随机种子</font></font></font></pre>
plus a global variable <a name="PI" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">PI</tt></a>.
Most of them
are only interfaces to the homonymous functions in the C&nbsp;library,
except that, for the trigonometric functions,
all angles are expressed in <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">degrees</em>, not radians.
The functions <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">deg</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rad</code> can be used to convert
between radians and degrees.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">加上一个全局变量 <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="PI"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">PI</tt> </a>.
他们中的大多数
只是 C 库中同名函数的接口，
不同之处在于，对于三角函数，
所有角度均以<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">度</em>数表示，而不是弧度。
函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">deg</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rad</code> 可用于转换
弧度和度数之间。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">max</code> returns the maximum
value of its numeric arguments.
Similarly, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">min</code> computes the minimum.
Both can be used with 1, 2, or more arguments.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">max</code> 返回其数字参数的最大值。同样，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">min</code> 计算最小值。两者都可以与 1 个、2 个或多个参数一起使用。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The functions <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">random</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">randomseed</code> are interfaces to
the simple random generator functions <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rand</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">srand</code>,
provided by ANSI C.
(No guarantees can be given for their statistical properties.)
The function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">random</code>, when called without arguments,
returns a pseudo-random real number in the range <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[0,1)</i>.
When called with a number <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</i>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">random</code> returns a pseudo-random integer in the range <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[1,n]</i>.
When called with two arguments, <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">l</i> and <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">u</i>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">random</code> returns a pseudo-random integer in the range <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[l,u]</i>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">random</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">randomseed</code> 是 ANSI C 提供的简单随机生成器函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rand</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">srand</code> 的接口。（不能保证它们的统计属性。函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">random</code> 在不带参数调用时，返回 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[0,1）</i> 范围内的伪随机实数。当使用数字 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</i> 调用时，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">random</code> 返回 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[1，n]</i> 范围内的伪随机整数。当使用两个参数 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">l</i> 和 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">u</i> 调用时，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">random</code> 返回 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[l，u]</i> 范围内的伪随机整数。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="libio" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="6.4" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">6.4 - I/O Facilities<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">6.4 - I/O 设施</font></font></font></h2> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
All input and output operations in Lua are done, by default,
over two <a name="file handles" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">file handles</em></a>, one for reading and one for writing.
These handles are stored in two Lua global variables,
called <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code>.
The global variables
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_STDIN</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_STDOUT</code>, and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_STDERR</code>
are initialized with file descriptors for
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdout</code>, and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stderr</code>.
Initially, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT=_STDIN</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT=_STDOUT</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">默认情况下，Lua 中的所有输入和输出操作都是通过两个<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="file handles"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">文件句柄</em></a>完成的，一个用于读取，一个用于写入。这些句柄存储在两个 Lua 全局变量中，分别称为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code>。全局变量 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_STDIN</code>、 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_STDOUT</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_STDERR</code> 使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdout</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stderr</code> 的文件描述符进行初始化。最初，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT=_STDIN</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT=_STDOUT</code>。</font></font></font><a name="_INPUT" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="_OUTPUT" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="_STDIN" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="_STDOUT" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="_STDERR" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
A file handle is a userdata containing the file stream (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">FILE*</code>),
and with a distinctive tag created by the I/O library.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">文件句柄是包含文件流 （<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">FILE*</code>） 的用户数据，并带有由 I/O 库创建的独特标记。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Unless otherwise stated,
all I/O functions return <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> on failure and
some value different from <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> on success.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">除非另有说明，否则所有 I/O 函数在失败时都返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>，并且在成功时返回一些与 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 不同的值。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">openfile (filename, mode)</tt></h3><a name="openfile" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
This function opens a file,
in the mode specified in the string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">mode</code>.
It returns a new file handle,
or, in case of errors, <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> plus a string describing the error.
This function does not modify either <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code> or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数以字符串<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">模式</code>中指定的模式打开文件。它返回一个新的文件句柄，或者在出现错误的情况下，返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 加上一个描述错误的字符串。此函数不会修改 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">mode</code> string can be any of the following:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">mode</code> 字符串可以是以下任何值：</font></font></font></p><dl data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``r''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''r''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> read mode;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">读取模式;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``w''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''w''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> write mode;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">写入模式;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``a''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''一个''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> append mode;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">附加模式;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``r+''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''r+''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> update mode, all previous data is preserved;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">update 模式，则保留所有以前的数据;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``w+''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''w+''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> update mode, all previous data is erased;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">update 模式，则之前的所有数据都将被擦除;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``a+''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''a+''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> append update mode, previous data is preserved,
  writing is only allowed at the end of file.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">append update 模式，保留以前的数据，只允许在文件末尾写入。</font></font></font></dd></dl>
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">mode</code> string may also have a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">b</code> at the end,
which is needed in some systems to open the file in binary mode.
This string is exactlty what is used in the standard&nbsp;C function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">fopen</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">mode</code> 字符串的末尾也可能有一个 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">b</code>，
在某些系统中，需要 以二进制模式打开文件。
此字符串与标准 C 函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">fopen</code> 中使用的字符串完全相同。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">closefile (handle)</tt></h3><a name="closefile" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
This function closes the given file.
It does not modify either <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code> or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数关闭给定的文件。它不会修改 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">readfrom (filename)</tt></h3><a name="readfrom" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
This function may be called in two ways.
When called with a file name, it opens the named file,
sets its handle as the value of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code>,
and returns this value.
It does not close the current input file.
When called without parameters,
it closes the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code> file,
and restores <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code> as the value of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code>.
If this function fails, it returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>,
plus a string describing the error.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">可以通过两种方式调用此函数。当使用文件名调用时，它会打开命名文件，将其句柄设置为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code> 的值，然后返回此值。它不会关闭当前输入文件。当不带参数调用时，它会关闭 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code> 文件，并将 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code> 恢复为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code> 的值。如果此函数失败，它将返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 以及描述错误的字符串。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filename</code> starts with a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">|</code>,
then a <a name="piped input" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">piped input</a> is opened, via function <a name="popen" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">popen</tt></a>.
Not all systems implement pipes.
Moreover,
the number of files that can be open at the same time is
usually limited and depends on the system.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filename</code> 以 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">|</code>开头，则通过 function <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="popen"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">popen</tt> </a>打开<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="piped input">管道输入</a>。并非所有系统都实施管道。此外，可以同时打开的文件数量通常是有限的，并且取决于系统。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">writeto (filename)</tt></h3><a name="writeto" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
This function may be called in two ways.
When called with a file name,
it opens the named file,
sets its handle as the value of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code>,
and returns this value.
It does not close the current output file.
Note that, if the file already exists,
then it will be <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">completely erased</em> with this operation.
When called without parameters,
this function closes the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code> file,
and restores <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdout</code> as the value of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code>.
<a name="closing a file" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
If this function fails, it returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>,
plus a string describing the error.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">可以通过两种方式调用此函数。使用文件名调用时，它会打开命名文件，将其句柄设置为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code> 的值，然后返回此值。它不会关闭当前输出文件。请注意，如果文件已经存在，则此操作将<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">完全擦除</em>该文件。在没有参数的情况下调用时，此函数将关闭 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code> 文件，并将 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdout</code> 恢复为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code> 的值。 如果此函数失败，它将返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 以及描述错误的字符串。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filename</code> starts with a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">|</code>,
then a <a name="piped input" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">piped input</a> is opened, via function <a name="popen" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">popen</tt></a>.
Not all systems implement pipes.
Moreover,
the number of files that can be open at the same time is
usually limited and depends on the system.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filename</code> 以 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">|</code>开头，则通过 function <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="popen"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">popen</tt> </a>打开<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="piped input">管道输入</a>。并非所有系统都实施管道。此外，可以同时打开的文件数量通常是有限的，并且取决于系统。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">appendto (filename)</tt></h3><a name="appendto" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Opens a file named <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filename</code> and sets it as the
value of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code>.
Unlike the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">writeto</code> operation,
this function does not erase any previous contents of the file;
instead, anything written to the file is appended to its end.
If this function fails, it returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>,
plus a string describing the error.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">打开名为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filename</code> 的文件，并将其设置为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code> 的值。与 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">writeto</code> 操作不同，此函数不会擦除文件的任何先前内容;相反，写入文件的任何内容都会附加到其末尾。如果此函数失败，它将返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 以及描述错误的字符串。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">remove (filename)</tt></h3><a name="remove" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Deletes the file with the given name.
If this function fails, it returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>,
plus a string describing the error.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">删除具有给定名称的文件。如果此函数失败，它将返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 以及描述错误的字符串。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rename (name1, name2)</tt></h3><a name="rename" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Renames file named <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name1</code> to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name2</code>.
If this function fails, it returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>,
plus a string describing the error.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将名为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name1</code> 的文件重命名为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name2</code>。如果此函数失败，它将返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 以及描述错误的字符串。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">flush ([filehandle])</tt></h3><a name="flush" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Saves any written data to the given file.
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filehandle</code> is not specified,
then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">flush</code> flushes all open files.
If this function fails, it returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>,
plus a string describing the error.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将写入的所有数据保存到给定的文件中。如果未指定 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filehandle</code>，则 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">flush</code> 将刷新所有打开的文件。如果此函数失败，它将返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 以及描述错误的字符串。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">seek (filehandle [, whence] [, offset])</tt></h3><a name="seek" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Sets and gets the file position,
measured in bytes from the beginning of the file,
to the position given by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">offset</code> plus a base
specified by the string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">whence</code>, as follows:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">设置并获取文件位置（从文件开头开始以字节为单位）到 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">offset</code> 加上字符串 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">whence</code> 指定的基数给出的位置，如下所示：</font></font></font></p><dl data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``set''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''设置''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> base is position 0 (beginning of the file);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">base 是位置 0（文件开头）;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``cur''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''cur''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> base is current position;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">base 是当前位置;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``end''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''完''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> base is end of file;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">base 是文件末尾;</font></font></font></dd></dl>
In case of success, function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">seek</code> returns the final file position,
measured in bytes from the beginning of the file.
If the call fails, it returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>,
plus a string describing the error.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果成功，则函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">seek</code> 返回最终的文件位置
以字节为单位，从文件开头开始测量。
如果调用失败，则返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>，
加上描述错误的字符串。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The default value for <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">whence</code> is <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"cur"</code>,
and for <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">offset</code> is 0.
Therefore, the call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">seek(file)</code> returns the current
file position, without changing it;
the call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">seek(file, "set")</code> sets the position to the
beginning of the file (and returns 0);
and the call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">seek(file, "end")</code> sets the position to the
end of the file, and returns its size.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">whence</code> 的默认值为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“cur”</code>，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">offset</code> 的默认值为 0。因此，调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">seek（file）</code> 返回当前文件位置，而不更改它;调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">seek（file， “set”）</code> 将位置设置为文件的开头（并返回 0）;调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">seek（file， “end”）</code> 将位置设置为文件末尾，并返回其大小。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tmpname ()</tt></h3><a name="tmpname" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Returns a string with a file name that can safely
be used for a temporary file.
The file must be explicitly opened before its use
and removed when no longer needed.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回一个字符串，其文件名可以安全地用于临时文件。该文件必须在使用之前显式打开，并在不再需要时将其删除。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">read ([filehandle,] format1, ...)</tt></h3><a name="read" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Reads file <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code>,
or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filehandle</code> if this argument is given,
according to the given formats, which specify what to read.
For each format,
the function returns a string (or a number) with the characters read,
or <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> if it cannot read data with the specified format.
When called without formats,
it uses a default format that reads the next line
(see below).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">根据指定要读取的内容的给定格式读取 file <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_INPUT</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filehandle</code>（如果给出了此参数）。对于每种格式，该函数返回一个字符串（或数字），其中包含 read 字符，如果无法读取指定格式的数据，则返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。当在没有格式的情况下调用时，它使用读取下一行的默认格式（见下文）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The available formats are
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">可用格式包括</font></font></font></p><dl data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``*n''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''*n''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> reads a number;
this is the only format that returns a number instead of a string.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">读取一个数字;这是唯一返回数字而不是字符串的格式。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``*l''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''*l''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> reads the next line
(skipping the end of line), or <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> on end of file.
This is the default format.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">读取下一行（跳过行尾），或在文件末尾读取 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。这是默认格式。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``*a''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''*a''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> reads the whole file, starting at the current position.
On end of file, it returns the empty string.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">从当前位置开始读取整个文件。在文件末尾，它返回空字符串。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">``*w''<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">''*w''</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> reads the next word
(maximal sequence of non--white-space characters),
skipping spaces if necessary, or <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> on end of file.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">读取下一个单词（非空白字符的最大序列），必要时跳过空格，或在文件末尾读取 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">number<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">数</font></font></font></em></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> reads a string with up to that number of characters,
or <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> on end of file.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">读取最多包含该字符数的字符串，或在文件末尾<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">读取 nil</b>。</font></font></font></dd></dl>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">write ([filehandle, ] value1, ...)</tt></h3><a name="write" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Writes the value of each of its arguments to
file <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code>,
or to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filehandle</code> if this argument is given.
The arguments must be strings or numbers.
To write other values,
use <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tostring</code> or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">format</code> before <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">write</code>.
If this function fails, it returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>,
plus a string describing the error.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将其每个参数的值写入 file <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_OUTPUT</code>，如果给出了此参数，则写入 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filehandle</code>。参数必须是字符串或数字。要写入其他值，请在<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">写入</code>前使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">tostring</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">format</code>。如果此函数失败，它将返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> 以及描述错误的字符串。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="libiosys" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="6.5" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">6.5 - System Facilities<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">6.5 - 系统设施</font></font></font></h2> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">clock ()</tt></h3><a name="clock" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Returns an approximation of the amount of CPU time
used by the program, in seconds.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回程序使用的 CPU 时间量的近似值（以秒为单位）。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">date ([format])</tt></h3><a name="date" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Returns a string containing date and time
formatted according to the given string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">format</code>,
following the same rules of the ANSI&nbsp;C function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strftime</code>.
When called without arguments,
it returns a reasonable date and time representation that depends on
the host system and on the current locale.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回一个字符串，其中包含根据给定字符串<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">格式</code>格式化的日期和时间，并遵循 ANSI C 函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">strftime</code> 的相同规则。当不带参数调用时，它将返回一个合理的日期和时间表示形式，该表示形式取决于主机系统和当前区域设置。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">execute (command)</tt></h3><a name="execute" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
This function is equivalent to the C&nbsp;function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">system</code>.
It passes <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">command</code> to be executed by an operating system shell.
It returns a status code, which is system-dependent.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数等效于 C 函数<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">系统</code>。它传递要由操作系统 shell 执行的<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">命令</code>。它返回一个状态代码，该代码与系统相关。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exit ([code])</tt></h3><a name="exit" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Calls the C&nbsp;function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exit</code>,
with an optional <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">code</code>,
to terminate the program.
The default value for <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">code</code> is the success code.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用可选<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">代码</code>调用 C 函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">exit</code> 以终止程序。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">code</code> 的默认值是 success code。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getenv (varname)</tt></h3><a name="getenv" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Returns the value of the process environment variable <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">varname</code>,
or <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> if the variable is not defined.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回流程环境变量 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">varname</code> 的值，如果未定义变量，则返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setlocale (locale [, category])</tt></h3><a name="setlocale" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
This function is an interface to the ANSI&nbsp;C function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setlocale</code>.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">locale</code> is a string specifying a locale;
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">category</code> is an optional string describing which category to change:
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"all"</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"collate"</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"ctype"</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"monetary"</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"numeric"</code>, or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"time"</code>;
the default category is <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"all"</code>.
The function returns the name of the new locale,
or <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> if the request cannot be honored.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数是 ANSI C 函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setlocale</code> 的接口。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">locale</code> 是指定 locale 的字符串;<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">category</code> 是一个可选字符串，描述要更改的类别：“<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">all”、“</code><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">collate”、“</code><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ctype”、“</code><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">monetary”、“</code><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">numeric”</code>或<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“time”</code>;默认类别为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“all”。</code>该函数返回新区域设置的名称，如果无法接受请求，<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">则返回 nil</b>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="debugI" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<!-- ====================================================================== -->
</p><hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="7." data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<h1 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">7 - The Debug Interface<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">7 - 调试界面</font></font></font></h1> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua has no built-in debugging facilities.
Instead, it offers a special interface,
by means of functions and <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">hooks</em>,
which allows the construction of different
kinds of debuggers, profilers, and other tools
that need ``inside information'' from the interpreter.
This interface is declared in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">luadebug.h</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 没有内置的调试工具。相反，它通过函数和<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">钩子</em>提供了一个特殊的接口，允许构造不同类型的调试器、分析器和其他需要解释器的“内部信息”的工具。此接口在 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">luadebug.h</code> 中声明。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="7.1" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">7.1 - Stack and Function Information<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">7.1 - 堆栈和函数信息</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<a name="lua_getstack" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
The main function to get information about the interpreter stack is
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">获取有关解释器堆栈的信息的主要函数是</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int lua_getstack (lua_State *L, int level, lua_Debug *ar);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_getstack （lua_State *L， int level， lua_Debug *ar）;</font></font></font></pre>
It fills parts of a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_Debug</code> structure with
an identification of the <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">activation record</em>
of the function executing at a given level.
Level&nbsp;0 is the current running function,
whereas level <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n+1</i> is the function that has called level <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</i>.
Usually, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getstack</code> returns 1;
when called with a level greater than the stack depth,
it returns 0.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">它用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_Debug</code> 结构的一部分填充
<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">激活记录</em>的标识
的函数。
Level 0 是当前正在运行的功能，
而 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">level n+1</i> 是调用了 level <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</i> 的函数。
通常，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getstack</code> 返回 1;
当使用大于堆栈深度的级别调用时，
它返回 0。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<a name="lua_Debug" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
The structure <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_Debug</code> is used to carry different pieces of
information about an active function:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">结构 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_Debug</code> 用于携带有关活动函数的不同信息：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">      typedef struct lua_Debug {
        const char *event;     /* "call", "return" */
        int currentline;       /* (l) */
        const char *name;      /* (n) */
        const char *namewhat;  /* (n) global, tag method, local, field */
        int nups;              /* (u) number of upvalues */
        int linedefined;       /* (S) */
        const char *what;      /* (S) "Lua" function, "C" function, Lua "main" */
        const char *source;    /* (S) */
        char short_src[LUA_IDSIZE]; /* (S) */
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">typedef struct lua_Debug {
const char *事件;    /* “调用”， “返回” */
int currentline;      /* （l） */
const char *名称;     /* （n） */
const char *namewhat; /* （n） 全局、标记方法、本地、字段 */
int nups;             /* （u） 升值数 */
int linedefined;      /* （S） */
const char *什么;     /* （S） “Lua” 函数， “C” 函数， Lua “main” */
const char *源;   /* （S） */
char short_src[LUA_IDSIZE];/* （S） */</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
        /* private part */
        ...
      } lua_Debug;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">/* 私人部分 */ ... }lua_Debug;</font></font></font></p></pre>
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getstack</code> fills only the private part
of this structure, for future use.
To fill in the other fields of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_Debug</code> with useful information,
call <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getstack</code> 仅填充私有部分
供将来使用。
要在 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_Debug</code> 的其他字段中填写有用的信息，
叫</font></font></font><a name="lua_getinfo" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int lua_getinfo (lua_State *L, const char *what, lua_Debug *ar);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int lua_getinfo （lua_State *L， const char *what， lua_Debug *ar）;</font></font></font></pre>
This function returns 0 on error
(e.g., an invalid option in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">what</code>).
Each character in the string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">what</code>
selects some fields of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ar</code> to be filled,
as indicated by the letter in parentheses in the definition of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_Debug</code>:
`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">S</code>' fills in the fields <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">source</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">linedefined</code>,
and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">what</code>;
`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">l</code>' fills in the field <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">currentline</code>, etc.
Moreover, `<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f</code>' pushes onto the stack the function that is
running at the given level.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数出错时返回 0
（例如，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">what</code> 中的无效选项）。
字符串中的每个字符 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">what</code>
选择要填充的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">AR</code> 的一些字段，
如 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_Debug</code> 定义中括号中的字母所示：
'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">S</code>' 填充字段 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">source</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">linedefined</code>、
又<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">是什么</code>;
'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">l</code>' 填充字段 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">currentline</code>，依此类推。
此外，'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f</code>' 将函数
在给定级别运行。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
To get information about a function that is not active (that is,
it is not in the stack),
you push the function onto the stack,
and start the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">what</code> string with the character <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&gt;</code>.
For instance, to know in which line a function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f</code> was defined,
you can write
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">要获取有关未处于活动状态的函数（即它不在堆栈中）的信息，请将该函数推送到堆栈上，并使用字符 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&gt;</code> 启动 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">what</code> 字符串。例如，要知道函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f</code> 是在哪一行中定义的，您可以编写</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       lua_Debug ar;
       lua_getglobal(L, "f");
       lua_getinfo(L, "&gt;S", &amp;ar);
       printf("%d\n", ar.linedefined);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">lua_Debug AR;
lua_getglobal（L， “f”）;
lua_getinfo（L， “&gt;S”， &amp;ar）;
printf（“%d\n”， ar.linedefined）;</font></font></font></pre>
The fields of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_Debug</code> have the following meaning:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_Debug</code> 的字段具有以下含义：</font></font></font><dl data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">source<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">源</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
If the function was defined in a string,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">source</code> is that string;
if the function was defined in a file,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">source</code> starts with a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">@</code> followed by the file name.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">如果函数是在字符串中定义的，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">则 source</code> 是该字符串;如果函数是在文件中定义的，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">则 source</code> 以 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">@</code> 开头，后跟文件名。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">short_src</b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
A ``printable'' version of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">source</code>, to be used in error messages.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">源</code>的 ''printable'' 版本，用于错误消息。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">linedefined</b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
the line number where the definition of the function starts.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数定义的起始行号。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">what<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">什么</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> the string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"Lua"</code> if this is a Lua function,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"C"</code> if this is a C&nbsp;function,
or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"main"</code> if this is the main part of a chunk.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">字符串 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“Lua”</code> 如果这是 Lua 函数，则为<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">字符串 “C”</code>，如果这是 C 函数，则为<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">字符串 “main”</code>，如果这是数据块的主要部分。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">currentline<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当前线路</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
the current line where the given function is executing.
When no line information is available,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">currentline</code> is set to <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-1</i>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">执行给定函数的当前行。当没有可用的行信息时，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">currentline</code> 设置为 <i data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-1</i>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">name<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">名字</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
a reasonable name for the given function.
Because functions in Lua are first class values,
they do not have a fixed name:
Some functions may be the value of many global variables,
while others may be stored only in a table field.
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getinfo</code> function checks whether the given
function is a tag method or the value of a global variable.
If the given function is a tag method,
then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</code> points to the event name.
If the given function is the value of a global variable,
then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</code> points to the variable name.
If the given function is neither a tag method nor a global variable,
then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</code> is set to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">给定函数的合理名称。因为 Lua 中的函数是第一类值，所以它们没有固定的名称：一些函数可能是许多全局变量的值，而其他函数可能只存储在表字段中。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getinfo</code> 函数检查给定函数是标记方法还是全局变量的值。如果给定的函数是 tag 方法，则 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</code> 指向事件名称。如果给定的函数是全局变量的值，则 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</code> 指向变量名称。如果给定的函数既不是标记方法也不是全局变量，则 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</code> 设置为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL。</code></font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">namewhat<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">name什么</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Explains the previous field.
If the function is a global variable,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">namewhat</code> is <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"global"</code>;
if the function is a tag method,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">namewhat</code> is <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"tag-method"</code>;
otherwise <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">namewhat</code> is <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">""</code> (the empty string).
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">解释上一个字段。如果函数是全局变量，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">则 namewhat</code> 是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“global”</code>;如果函数是 tag 方法，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">则 nameWhat</code> 是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“tag-method”</code>;否则 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name什么是</code> <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“”（</code>空字符串）。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">nups<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">纳普斯</font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Number of upvalues of a function.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数的升值数。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></dd></dl>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="7.2" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">7.2 - Manipulating Local Variables<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">7.2 - 操作局部变量</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
For the manipulation of local variables,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">luadebug.h</code> uses indices:
The first parameter or local variable has index&nbsp;1, and so on,
until the last active local variable.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">对于局部变量的操作，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">luadebug.h</code> 使用索引：第一个参数或局部变量的索引为 1，依此类推，直到最后一个活动的局部变量。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<a name="lua_getlocal" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_setlocal" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
The following functions allow the manipulation of the
local variables of a given activation record.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">以下函数允许操作给定激活记录的局部变量。</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       const char *lua_getlocal (lua_State *L, const lua_Debug *ar, int n);
       const char *lua_setlocal (lua_State *L, const lua_Debug *ar, int n);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">const char *lua_getlocal （lua_State *L， const lua_Debug *ar， int n）;
const char *lua_setlocal （lua_State *L， const lua_Debug *ar， int n）;</font></font></font></pre>
The parameter <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ar</code> must be a valid activation record,
filled by a previous call to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getstack</code> or
given as argument to a hook (see Section&nbsp;<a href="#sub-hooks" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">7.3</a>).
Function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getlocal</code> gets the index of a local variable
(<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code>), pushes its value onto the stack,
and returns its name.
For <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_setlocal</code>,
you push the new value onto the stack,
and the function assigns that value to the variable and returns its name.
Both functions return <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL</code> on failure;
that happens if the index is greater than
the number of active local variables.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">参数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ar</code> 必须是有效的激活记录，
由之前对 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getstack</code> 的调用填充，或者
作为钩子的参数给出（参见 Section <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="#sub-hooks">7.3</a>）。
函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getlocal</code> 获取局部变量的索引
（<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code>） 将其值推送到堆栈上，
并返回其名称。
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">对于 lua_setlocal</code>，
您将新值推送到堆栈上，
函数将该值分配给变量并返回其名称。
两个函数在失败时都返回 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL</code>;
如果索引大于
活动局部变量的数量。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
As an example, the following function lists the names of all
local variables for a function at a given level of the stack:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">例如，以下函数列出了堆栈的给定级别的函数的所有局部变量的名称：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       int listvars (lua_State *L, int level) {
         lua_Debug ar;
         int i = 1;
         const char *name;
         if (lua_getstack(L, level, &amp;ar) == 0)
           return 0;  /* failure: no such level in the stack */
         while ((name = lua_getlocal(L, &amp;ar, i++)) != NULL) {
           printf("%s\n", name);
           lua_pop(L, 1);  /* remove variable value */
         }
         return 1;
       }
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">int listvars （lua_State *L， int 级别） {
lua_Debug AR;
int i = 1;
const char *名称;
if （lua_getstack（L， level， &amp;ar） == 0）
返回 0; /* failure：堆栈中没有这样的级别 */
while （（name = lua_getlocal（L， &amp;ar， i++）） ！= NULL） {
printf（“%s\n”， 名称）;
lua_pop（L， 1）; /* 删除变量值 */
         }
返回 1;
       }</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="sub-hooks" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="7.3" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">7.3 - Hooks<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">7.3 - 钩子</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The Lua interpreter offers two hooks for debugging purposes:
a <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">call</em> hook and a <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">line</em> hook.
Both have the same type,
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 解释器提供了两个用于调试目的的钩子：<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">一个 call</em> 钩子和一个 <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">line</em> 钩子。两者具有相同的类型，</font></font></font><a name="lua_Hook" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       typedef void (*lua_Hook) (lua_State *L, lua_Debug *ar);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">typedef void （*lua_Hook） （lua_State *L， lua_Debug *ar）;</font></font></font></pre>
and you can set them with the following functions:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">您可以使用以下功能设置它们：</font></font></font><a name="lua_setcallhook" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a><a name="lua_setlinehook" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       lua_Hook lua_setcallhook (lua_State *L, lua_Hook func);
       lua_Hook lua_setlinehook (lua_State *L, lua_Hook func);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">lua_Hook lua_setcallhook （lua_State *L， lua_Hook func）;
lua_Hook lua_setlinehook （lua_State *L， lua_Hook func）;</font></font></font></pre>
A hook is disabled when its value is <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL</code>,
which is the initial value of both hooks.
The functions <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_setcallhook</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_setlinehook</code>
set their corresponding hooks and return their previous values.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当钩子的值为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NULL</code> 时，钩子被禁用，
这是两个钩子的初始值。
函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_setcallhook</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_setlinehook</code>
设置它们对应的钩子并返回它们以前的值。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The call hook is called whenever the
interpreter enters or leaves a function.
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">event</code> field of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ar</code> has the strings <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"call"</code>
or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"return"</code>.
This <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ar</code> can then be used in calls to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getinfo</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getlocal</code>, and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_setlocal</code>
to get more information about the function and to manipulate its
local variables.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">每当解释器进入或离开函数时，都会调用 call hook。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ar</code> 的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">event</code> 字段包含字符串 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“call”</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“return”。</code>然后，此 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ar</code> 可用于对 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getinfo</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getlocal</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_setlocal</code> 的调用，以获取有关函数的更多信息并操作其局部变量。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The line hook is called every time the interpreter changes
the line of code it is executing.
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">event</code> field of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ar</code> has the string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"line"</code>,
and the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">currentline</code> field has the line number.
Again, you can use this <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ar</code> in other calls to the debug API.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">每次解释器更改它正在执行的代码行时，都会调用 line hook。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ar</code> 的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">event</code> 字段为字符串 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“line”</code>，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">currentline</code> 字段为行号。同样，您可以在对调试 API 的其他调用中使用此 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ar</code>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
While Lua is running a hook, it disables other calls to hooks.
Therefore, if a hook calls Lua to execute a function or a chunk,
this execution ocurrs without any calls to hooks.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当 Lua 运行钩子时，它会禁用对钩子的其他调用。因此，如果钩子调用 Lua 来执行函数或块，则此执行不会对钩子进行任何调用。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="7.4" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">7.4 - The Reflexive Debug Interface<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">7.4 - 自反调试接口</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The library <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ldblib</code> provides
the functionality of the debug interface to Lua programs.
If you want to use this library,
your host application must open it,
by calling <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dblibopen</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">库 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">ldblib</code> 为 Lua 程序提供调试接口的功能。如果要使用此库，主机应用程序必须通过调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_dblibopen</code> 来打开它。</font></font></font><a name="lua_dblibopen" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
You should exert great care when using this library.
The functions provided here should be used exclusively for debugging
and similar tasks (e.g., profiling).
Please resist the temptation to use them as a
usual programming tool.
They are slow and violate some (otherwise) secure aspects of the
language (e.g., privacy of local variables).
As a general rule, if your program does not need this library,
do not open it.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用此库时应格外小心。此处提供的函数应专门用于调试和类似任务（例如，分析）。请抵制将它们用作常规编程工具的诱惑。它们很慢，并且违反了语言的某些（其他）安全方面（例如，局部变量的隐私）。作为一般规则，如果您的程序不需要此库，请不要打开它。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo (function, [what])</tt></h3><a name="getinfo" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
This function returns a table with information about a function.
You can give the function directly,
or you can give a number as the value of <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</code>,
which means the function running at level <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</code> of the stack:
Level 0 is the current function (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo</code> itself);
level 1 is the function that called <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo</code>;
and so on.
If <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</code> is a number larger than the number of active functions,
then <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo</code> returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数返回一个包含函数相关信息的表。你可以直接给出函数，也可以给出一个数字作为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</code> 的值，这意味着在堆栈的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">level 函数</code>上运行的函数：Level 0 是当前函数（<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo</code> 本身）;级别 1 是调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getInfo</code> 的函数;等等。如果 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</code> 是大于活动函数数的数字，则 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo</code> 返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The returned table contains all the fields returned by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getinfo</code>,
with the string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">what</code> describing what to get.
The default for <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">what</code> is to get all information available.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">返回的 table 包含 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_getinfo</code> 返回的所有字段，其中字符串 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">what</code> 描述了要获取的内容。获取所有可用<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></code>信息的默认值。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
For instance, the expression <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo(1,"n").name</code> returns
the name of the current function, if a reasonable name can be found,
and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo(print)</code> returns a table with all available information
about the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">print</code> function.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">例如，表达式 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo（1，“n”）.name</code> 返回当前函数的名称（如果可以找到合理的名称），而 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo（print）</code> 返回一个包含有关 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">print</code> 函数的所有可用信息的表。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getlocal (level, local)</tt></h3><a name="getlocal" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
This function returns the name and the value of the local variable
with index <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">local</code> of the function at level <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">level</code> of the stack.
(The first parameter or local variable has index&nbsp;1, and so on,
until the last active local variable.)
The function returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> if there is no local
variable with the given index,
and raises an error when called with a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">level</code> out of range.
(You can call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo</code> to check whether the level is valid.)
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数返回局部变量的名称和值，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">其中函数的</code>索引位于堆栈<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">的</code>级别。（第一个参数或局部变量的索引为 1，依此类推，直到最后一个活动局部变量。如果没有具有给定索引的局部变量，则函数返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>，并在<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">级别超出范围</code>的情况下调用时引发错误。（你可以调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo</code> 查看级别是否有效。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setlocal (level, local, value)</tt></h3><a name="setlocal" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
This function assigns the value <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">value</code> to the local variable
with index <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">local</code> of the function at level <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">level</code> of the stack.
The function returns <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> if there is no local
variable with the given index,
and raises an error when called with a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">level</code> out of range.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">此函数将 value <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">值</code>分配给局部变量，其函数的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">index local</code> 位于<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">堆栈的级别</code>。如果没有具有给定索引的局部变量，则函数返回 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b>，并在<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">级别超出范围</code>的情况下调用时引发错误。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setcallhook (hook)</tt></h3><a name="setcallhook" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Sets the function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">hook</code> as the call hook;
this hook will be called every time the interpreter starts and
exits the execution of a function.
The only argument to the call hook is the event name (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"call"</code> or
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"return"</code>).
You can call <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo</code> with level 2 to get more information about
the function being called or returning
(level&nbsp;0 is the <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo</code> function,
and level&nbsp;1 is the hook function).
When called without arguments,
this function turns off call hooks.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setcallhook</code> returns the old hook.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">hook</code> 设置为 call hook;每次解释器启动和退出函数的执行时，都会调用此钩子。call hook 的唯一参数是事件名称（<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“call”</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“return”）。</code>您可以调用级别 2 的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo</code>，以获取有关正在调用或返回的函数的更多信息（级别 0 是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getinfo</code> 函数，级别 1 是钩子函数）。当不带参数调用时，此函数会关闭调用钩子。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setCallHook</code> 返回旧的钩子。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setlinehook (hook)</tt></h3><a name="setlinehook" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Sets the function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">hook</code> as the line hook;
this hook will be called every time the interpreter changes
the line of code it is executing.
The only argument to the line hook is the line number the interpreter
is about to execute.
When called without arguments,
this function turns off line hooks.
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setlinehook</code> returns the old hook.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">hook</code> 设置为 line hook;每次解释器更改它正在执行的代码行时，都会调用此钩子。line hook 的唯一参数是解释器将要执行的行号。当不带参数调用时，此函数会关闭线钩。<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setlinehook</code> 返回旧的钩子。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="lua-sa" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<!-- ====================================================================== -->
</p><hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="8." data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<h1 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">8 - Lua Stand-alone<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">8 - Lua 独立版</font></font></font></h1> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Although Lua has been designed as an extension language,
to be embedded in a host C&nbsp;program,
it is frequently used as a stand-alone language.
An interpreter for Lua as a stand-alone language,
called simply <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua</code>,
is provided with the standard distribution.
This program can be called with any sequence of the following arguments:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">尽管 Lua 被设计为一种扩展语言，要嵌入到主机 C 程序中，但它经常被用作独立语言。标准发行版提供了将 Lua 作为独立语言的解释器，简称为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua</code>。可以使用以下参数的任何序列调用此程序：</font></font></font></p><dl data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-sNUM</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> sets the stack size to <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NUM</tt>
(if present, this must be the first option);
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将 stack size 设置为 <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">NUM</tt> （如果存在，这必须是第一个选项）;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</tt> </b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> executes <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code> as a file;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code> 作为文件执行;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-c</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> calls <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua_close</code> after running all arguments;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在运行所有参数后<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">调用 lua_close</code>;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-e</tt> \rm<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stat</em><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-e</tt> \rm<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stat</em></font></font></font></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> executes string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stat</code>;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">执行 string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stat</code>;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-f filename</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> executes file <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filename</code> with the
remaining arguments in table <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arg</code>;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">执行 file <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filename</code> 和 table <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arg</code> 中的其余参数;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-i</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> enters interactive mode with prompt;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">进入交互模式并提示;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-q</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> enters interactive mode without prompt;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">进入交互模式，无提示;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-v</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> prints version information;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">打印版本信息;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">var=value</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> sets global <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">var</code> to string <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"value"</code>;
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将全局 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">var</code> 设置为字符串 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“value”</code>;</font></font></font></dd><dt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filename</tt></b></dt><dd data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1"> executes file <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filename</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">执行 File <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filename</code>。</font></font></font></dd></dl>
When called without arguments,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua</code> behaves as <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua -v -i</code> when <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code> is a terminal,
and as <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua -</code> otherwise.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">当不带参数调用时，
当 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code> 是终端时，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua</code> 的行为与 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua -v -i</code> 相同，
和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lua -</code> 否则。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
All arguments are handled in order, except <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-c</code>.
For instance, an invocation like
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">所有参数都按顺序处理，但 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-c</code> 除外。例如，像</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       $ lua -i a=test prog.lua
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">$ lua -i a=测试 prog.lua</font></font></font></pre>
will first interact with the user until an <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">EOF</code> in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code>,
then will set <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</code> to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"test"</code>,
and finally will run the file <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">prog.lua</code>.
(Here,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">$</code> is the shell prompt. Your prompt may be different.)
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">将首先与用户交互，直到 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">stdin</code> 中的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">EOF</code>，
然后将 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</code> 设置为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“test”</code>，
最后将运行文件 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">prog.lua</code>。
（这里，
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">$</code> 是 shell 提示符。您的提示可能有所不同。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
When the option <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-f filename</tt> is used,
all remaining arguments in the command line
are passed to the Lua program <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">filename</code> in a table called <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arg</code>.
In this table,
the field <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> gets the index of the last argument,
and the field 0 gets <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">"filename"</code>.
For instance, in the call
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用该选项 <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-f filename</tt> 时，命令行中的所有剩余参数都将传递到名为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">arg</code> 的表中的 Lua 程序<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">文件名</code>。在此表中，字段 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">n</code> 获取最后一个参数的索引，字段 0 获取 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">“filename”。</code>例如，在调用</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       $ lua a.lua -f b.lua t1 t3
</pre>
the interpreter first runs the file <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a.lua</tt>,
then creates a table
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">解释器首先运行文件 <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a.lua</tt> ，
然后创建一个表</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       arg = {"t1", "t3";  n = 2, [0] = "b.lua"}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">arg = {“t1”， “t3”; n = 2， [0] = “b.lua”}</font></font></font></pre>
and finally runs the file <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">b.lua</tt>.
<a name="getargs" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
The stand-alone interpreter also provides a <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getargs</code> function that
can be used to access <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">all</em> command line arguments.
For instance, if you call Lua with the line
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">最后运行文件 <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">b.lua</tt> .

独立解释器还提供了一个 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getargs</code> 函数，该函数
可用于访问<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">所有</em>命令行参数。
例如，如果你用</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       $ lua -c a b
</pre>
then a call to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getargs</code> in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</code> or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">b</code> will return the table
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">然后，调用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">a</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">b</code> 中的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">getArgs</code> 将返回表</font></font></font><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       {[0] = "lua", [1] = "-c", [2] = "a", [3] = "b", n = 3}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">{[0] = “lua”， [1] = “-c”， [2] = “a”， [3] = “b”， n = 3}</font></font></font></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
In interactive mode,
a multi-line statement can be written finishing intermediate
lines with a backslash (`<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\</code>').
If the global variable <a name="_PROMPT" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_PROMPT</tt></a> is defined as a string,
then its value is used as the prompt.
Therefore, the prompt can be changed directly on the command line:
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在交互模式下，可以编写多行语句，用反斜杠 （'<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\</code>'） 结束中间行。如果全局变量<a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" name="_PROMPT"> <tt data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_PROMPT</tt> </a>定义为字符串，则其值将用作提示符。因此，可以直接在命令行上更改提示符：</font></font></font></p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">       $ lua _PROMPT='myprompt&gt; ' -i
</pre>
or in any Lua programs by assigning to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_PROMPT</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">或任何 Lua 程序中，通过分配给 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">_PROMPT</code>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
In Unix systems, Lua scripts can be made into executable programs
by using <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">chmod +x</code> and the&nbsp;<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">#!</code> form,
as in <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">#!/usr/local/bin/lua</code>,
or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">#!/usr/local/bin/lua -f</code> to get other arguments.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在 Unix 系统中，可以使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">chmod +x</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">#！</code> 形式将 Lua 脚本制作成可执行程序，如 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">#！/usr/local/bin/lua</code>，或者 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">#！/usr/local/bin/lua -f</code> 来获取其他参数。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="Acknowledgments" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<h1 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Acknowledgments<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">确认</font></font></font></h1>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The authors would like to thank CENPES/PETROBRAS which,
jointly with TeCGraf, used early versions of
this system extensively and gave valuable comments.
The authors would also like to thank Carlos Henrique Levy,
who found the name of the game.
Lua means ``moon'' in Portuguese.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">作者要感谢 CENPES/PETROBRAS，它与 TeCGraf 一起广泛使用了该系统的早期版本，并提供了宝贵的意见。作者还要感谢 Carlos Henrique Levy，他找到了游戏的名称。Lua 在葡萄牙语中的意思是“月亮”。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="Incompatibilities" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<h1 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Incompatibilities with Previous Versions<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">与早期版本不兼容</font></font></font></h1>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Lua 4.0 is a major revision of the language.
We took a great care to avoid incompatibilities with
the previous public versions of Lua,
but some differences had to be introduced.
Here is a list of all these incompatibilities.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 4.0 是该语言的主要修订版。我们非常小心地避免与 Lua 以前的公共版本不兼容，但必须引入一些差异。以下是所有这些不兼容之处的列表。</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h2 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Incompatibilities with <a name="version 3.2</h2>" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">version 3.2</a><font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">与</font></font></font></h2>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Changes in the Language<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">语言的变化</font></font></font></h3>
<ul data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
All pragmas (<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">$debug</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">$if</code>, ...) have been removed.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">所有编译指示 （<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">$debug</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">$if</code> 等） 均已删除。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b>, <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b>, and <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">in</b> are now reserved words.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b>、<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> 和 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">in</b> 现在是保留字。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Garbage-collection tag methods for tables is now obsolete.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">表的 Garbage-collection 标记方法现已过时。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
There is now only one tag method for order operators.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">现在，订单运算符只有一种标签方法。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
In nested function calls like <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f(g(x))</code>,
<em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">all</em> return values from <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">g</code> are passed as arguments to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f</code>.
This only happens when <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">g</code> is the last
or the only argument to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">在像 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f（g（x））</code> 这样的嵌套函数调用中，<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">g</code> <em data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">的所有</em>返回值都作为参数传递给 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f</code>。仅当 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">g</code> 是 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">f</code> 的最后一个或唯一参数时，才会发生这种情况。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The pre-compiler may assume that some operators are associative,
for optimizations.
This may cause problems if these operators
have non-associative tag methods.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">预编译器可能会假定某些运算符是 ascociative 的，以便进行优化。如果这些运算符具有非关联标记方法，这可能会导致问题。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Old pre-compiled code is obsolete, and must be re-compiled.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">旧的预编译代码已过时，必须重新编译。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li></ul>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Changes in the Libraries<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">库中的更改</font></font></font></h3>
<ul data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
When traversing a table with <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">next</code> or <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreach</code>,
the table cannot be modified in any way.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">使用 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">next</code> 或 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreach</code> 遍历表时，不能以任何方式修改该表。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
General read patterns are now obsolete.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">常规读取模式现已过时。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The functions <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawgettable</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawsettable</code>
have been renamed to <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawget</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawset</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawgettable</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawsettable</code> 已重命名为 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawget</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawset</code>。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The functions <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreachvar</code>, <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nextvar</code>,
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawsetglobal</code>, and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawgetglobal</code> are obsolete.
You can get their functionality using table operations
over the table of globals,
which is returned by <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">globals</code>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">foreachvar</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nextvar</code>、<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawsetglobal</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">rawgetglobal</code> 已过时。您可以使用对 globals 返回的 table 操作来获取它们<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">的功能。</code></font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setglobal</code> and <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">sort</code> no longer return a value;
<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">type</code> no longer returns a second value.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1"><code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">setglobal</code> 和 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">sort</code> 不再返回值;<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">type</code> 不再返回第二个值。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">p</code> option in function <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">call</code> is now obsolete.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">函数<code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">调用</code>中的 <code data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">p</code> 选项现已过时。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li></ul>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><h3 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">Changes in the API<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">API 中的更改</font></font></font></h3>
<ul data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The API has been completely rewritten:
It is now fully reentrant and much clearer.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">API 已被完全重写：它现在是完全可重入的，并且更加清晰。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li><li data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
The debug API has been completely rewritten.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">调试 API 已完全重写。</font></font></font><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></li></ul>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="BNF" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
<a name="grammar" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<h1 data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">The Complete Syntax of Lua<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">Lua 的完整语法</font></font></font></h1> 
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<a name="grammar" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"></a>
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><pre data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8"><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       chunk ::= {stat [`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">;</b>']}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">块 ：：= {stat ['<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">;</b>']}</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       block ::= chunk
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">块 ：：= 块</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       stat ::=  varlist1 `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' explist1 <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">stat ：：= varlist1 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' explist1</font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| functioncall <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|function调用</font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b> <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">阻止</b><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">结束</b></font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">while</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b> <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">而</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">执行</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b></font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">repeat</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">until</b> exp1 <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">重复</b>块<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，直到</b> exp1</font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">if</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">then</b> block {<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">elseif</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">then</b> block} [<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">else</b> block] <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b> <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">if</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">then</b> block {<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">elseif</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">then</b> block} [<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">else</b> block] <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">结束</b></font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">return</b> [explist1] <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">返回</b> [explist1]</font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">break</b> <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">破</b></font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' exp1 `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' exp1 [`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' exp1] <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b> <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">对于</b> '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' exp1 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' exp1 ['<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' exp1] <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b></font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">for</b> `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">in</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">do</b> block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b> <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">对于</b> exp1 <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">中的</b> '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">、</b>'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name'，</b><b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">请执行</b>块<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">结束</b></font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</b> funcname `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">(</b>' [parlist1] `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">)</b>' block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b> <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</b> funcname '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">（</b>' [parlist1] '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">）</b>' 块<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">结束</b></font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">local</b> declist [init] 
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">本地</b> declist [init]</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       funcname ::=  `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">.</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">:</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' 
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">funcname ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">名称</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">名称</b>' '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">.</b>' '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">名称</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">'：</b>' '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>'</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       varlist1 ::= var {`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' var}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">varlist1 ：：= var {'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' var}</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       var ::=  `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' | varorfunc `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[</b>' exp1 `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">]</b>' | varorfunc `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">.</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' 
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">var ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">名称</b>' |varorfunc '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[</b>' exp1 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">]</b>' |varorfunc '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">.</b>' <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">'名称</b>'</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       varorfunc ::= var | functioncall
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">varorfunc ：：= var |function调用</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       declist ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' {`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>'}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">declist ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">名称</b>' {'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">'名称</b>'}</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       init ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' explist1
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">初始化 ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' explist1</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       explist1 ::= {exp1 `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>'} exp
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">explist1 ：：= {exp1 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>'} exp</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       exp1 ::= exp
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">exp1 ：：= exp</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       exp ::=  <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">number</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">literal</b>' | var | function | upvalue <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">exp ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">nil</b> |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">数字</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">literal</b>' |var |功能 |upvalue</font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| functioncall | tableconstructor | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">(</b>' exp `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">)</b>' | exp binop exp | unop exp 
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|函数调用 |tableconstructor |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">（</b>' exp '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">）</b>' |exp binop exp |unop exp （无法操作的经验值）</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       functioncall ::=  varorfunc args | varorfunc `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">:</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' args 
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">functioncall ：：= varorfunc args |varorfunc '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">：</b>' <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">'name</b>' args</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       args ::=  `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">(</b>' [explist1] `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">)</b>' | tableconstructor | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">literal</b>' 
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">参数 ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">（</b>' [explist1] '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">）</b>' |tableconstructor |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">字面值</b>'</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       function ::= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</b> `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">(</b>' [parlist1] `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">)</b>' block <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">end</b>
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">function ：：= <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">function</b> '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">（</b>' [parlist1] '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">）</b>' 块<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">结束</b></font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       parlist1 ::=  `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">...</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' {`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>'} [`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">...</b>'] 
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">parlist1 ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">...</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">名称</b>' {'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">'名称</b>'} ['<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">'...</b>']</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       upvalue ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>'
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">upvalue ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">%</b>' '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">名称</b>'</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       tableconstructor ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">{</b>' fieldlist `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">}</b>'
       fieldlist ::=  lfieldlist | ffieldlist | lfieldlist `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">;</b>' ffieldlist | ffieldlist `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">;</b>' lfieldlist 
       lfieldlist ::= [lfieldlist1]
       ffieldlist ::= [ffieldlist1]
       lfieldlist1 ::= exp {`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' exp} [`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>']
       ffieldlist1 ::= ffield {`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>' ffield} [`<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">,</b>']
       ffield ::=  `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[</b>' exp `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">]</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' exp | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' exp 
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">tableconstructor ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">{</b>' 字段列表 '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">}</b>' 字段列表 ：：= lfieldlist |ffieldlist |lfieldlist '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">;</b>' ffieldlist |ffieldlist '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">;</b>' lfieldlist lfieldlist ：：= [lfieldlist1] ffieldlist ：：= [ffieldlist1] lfieldlist1 ：：= exp {'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' exp} ['<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>'] ffieldlist1 ：：= ffield {'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>' ffield} ['<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">，</b>'] ffield ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">[</b>' exp '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">]</b>' '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' exp |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">name</b>' '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">=</b>' exp</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       binop ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">+</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">/</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\^{ </b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">..</b>' <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">binop ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">+</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">*</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">/</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\^{ </b>' | '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">..'</b></font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&lt;</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&lt;=</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&gt;</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&gt;=</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">==</b>' | `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\&nbsp;{ </b>'=} <font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&lt;</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&lt;=</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&gt;</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">&gt;=</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">==</b>' |'<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">\&nbsp;{ '</b>=}</font></font></font><br data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">	| <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">and</b> | <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">or</b>}
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">|<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">和</b> |<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">或</b>}</font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
       unop ::= `<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</b>' | <b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">not</b>
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-pre-whitespace immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">unop ：：= '<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">-</b>' |<b data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">不</b></font></font></font></p><p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
</p></pre>
<p data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">

</p><hr data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">
<small data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" data-immersive-translate-paragraph="1">
Last update:
Mon Nov  6 17:37:03 EDT 2000
by <a href="http://www.tecgraf.puc-rio.br/~lhf/" data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8">lhf</a>.
<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">最后更新： Mon Nov 6 17：37：03 EDT 2000 by <a data-immersive-translate-walked="186790b6-2e4c-4eee-9e52-cc3d822877b8" href="http://www.tecgraf.puc-rio.br/~lhf/">lhf</a>.</font></font></font></small>



</body></html>